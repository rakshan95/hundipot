(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hx(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var rp={exports:{}},Rl={},np={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ia=Symbol.for("react.element"),Vx=Symbol.for("react.portal"),Gx=Symbol.for("react.fragment"),Kx=Symbol.for("react.strict_mode"),Xx=Symbol.for("react.profiler"),Yx=Symbol.for("react.provider"),qx=Symbol.for("react.context"),Jx=Symbol.for("react.forward_ref"),Qx=Symbol.for("react.suspense"),Zx=Symbol.for("react.memo"),ev=Symbol.for("react.lazy"),Bf=Symbol.iterator;function tv(e){return e===null||typeof e!="object"?null:(e=Bf&&e[Bf]||e["@@iterator"],typeof e=="function"?e:null)}var ip={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sp=Object.assign,ap={};function hs(e,t,r){this.props=e,this.context=t,this.refs=ap,this.updater=r||ip}hs.prototype.isReactComponent={};hs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};hs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function op(){}op.prototype=hs.prototype;function o0(e,t,r){this.props=e,this.context=t,this.refs=ap,this.updater=r||ip}var l0=o0.prototype=new op;l0.constructor=o0;sp(l0,hs.prototype);l0.isPureReactComponent=!0;var Uf=Array.isArray,lp=Object.prototype.hasOwnProperty,c0={current:null},cp={key:!0,ref:!0,__self:!0,__source:!0};function up(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)lp.call(t,n)&&!cp.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Ia,type:e,key:s,ref:a,props:i,_owner:c0.current}}function rv(e,t){return{$$typeof:Ia,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function u0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ia}function nv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var $f=/\/+/g;function fc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nv(""+e.key):t.toString(36)}function Fo(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ia:case Vx:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+fc(a,0):n,Uf(i)?(r="",e!=null&&(r=e.replace($f,"$&/")+"/"),Fo(i,t,r,"",function(c){return c})):i!=null&&(u0(i)&&(i=rv(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace($f,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",Uf(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+fc(s,o);a+=Fo(s,t,r,l,i)}else if(l=tv(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+fc(s,o++),a+=Fo(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Za(e,t,r){if(e==null)return e;var n=[],i=0;return Fo(e,n,"","",function(s){return t.call(r,s,i++)}),n}function iv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Lt={current:null},Oo={transition:null},sv={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:Oo,ReactCurrentOwner:c0};function fp(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:Za,forEach:function(e,t,r){Za(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Za(e,function(){t++}),t},toArray:function(e){return Za(e,function(t){return t})||[]},only:function(e){if(!u0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_e.Component=hs;_e.Fragment=Gx;_e.Profiler=Xx;_e.PureComponent=o0;_e.StrictMode=Kx;_e.Suspense=Qx;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sv;_e.act=fp;_e.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=sp({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=c0.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)lp.call(t,l)&&!cp.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Ia,type:e.type,key:i,ref:s,props:n,_owner:a}};_e.createContext=function(e){return e={$$typeof:qx,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Yx,_context:e},e.Consumer=e};_e.createElement=up;_e.createFactory=function(e){var t=up.bind(null,e);return t.type=e,t};_e.createRef=function(){return{current:null}};_e.forwardRef=function(e){return{$$typeof:Jx,render:e}};_e.isValidElement=u0;_e.lazy=function(e){return{$$typeof:ev,_payload:{_status:-1,_result:e},_init:iv}};_e.memo=function(e,t){return{$$typeof:Zx,type:e,compare:t===void 0?null:t}};_e.startTransition=function(e){var t=Oo.transition;Oo.transition={};try{e()}finally{Oo.transition=t}};_e.unstable_act=fp;_e.useCallback=function(e,t){return Lt.current.useCallback(e,t)};_e.useContext=function(e){return Lt.current.useContext(e)};_e.useDebugValue=function(){};_e.useDeferredValue=function(e){return Lt.current.useDeferredValue(e)};_e.useEffect=function(e,t){return Lt.current.useEffect(e,t)};_e.useId=function(){return Lt.current.useId()};_e.useImperativeHandle=function(e,t,r){return Lt.current.useImperativeHandle(e,t,r)};_e.useInsertionEffect=function(e,t){return Lt.current.useInsertionEffect(e,t)};_e.useLayoutEffect=function(e,t){return Lt.current.useLayoutEffect(e,t)};_e.useMemo=function(e,t){return Lt.current.useMemo(e,t)};_e.useReducer=function(e,t,r){return Lt.current.useReducer(e,t,r)};_e.useRef=function(e){return Lt.current.useRef(e)};_e.useState=function(e){return Lt.current.useState(e)};_e.useSyncExternalStore=function(e,t,r){return Lt.current.useSyncExternalStore(e,t,r)};_e.useTransition=function(){return Lt.current.useTransition()};_e.version="18.3.1";np.exports=_e;var Fe=np.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av=Fe,ov=Symbol.for("react.element"),lv=Symbol.for("react.fragment"),cv=Object.prototype.hasOwnProperty,uv=av.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fv={key:!0,ref:!0,__self:!0,__source:!0};function hp(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)cv.call(t,n)&&!fv.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:ov,type:e,key:s,ref:a,props:i,_owner:uv.current}}Rl.Fragment=lv;Rl.jsx=hp;Rl.jsxs=hp;rp.exports=Rl;var h=rp.exports,dp={exports:{}},ir={},pp={exports:{}},mp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(te,se){var pe=te.length;te.push(se);e:for(;0<pe;){var ve=pe-1>>>1,F=te[ve];if(0<i(F,se))te[ve]=se,te[pe]=F,pe=ve;else break e}}function r(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var se=te[0],pe=te.pop();if(pe!==se){te[0]=pe;e:for(var ve=0,F=te.length,I=F>>>1;ve<I;){var O=2*(ve+1)-1,P=te[O],K=O+1,ue=te[K];if(0>i(P,pe))K<F&&0>i(ue,P)?(te[ve]=ue,te[K]=pe,ve=K):(te[ve]=P,te[O]=pe,ve=O);else if(K<F&&0>i(ue,pe))te[ve]=ue,te[K]=pe,ve=K;else break e}}return se}function i(te,se){var pe=te.sortIndex-se.sortIndex;return pe!==0?pe:te.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,f=3,p=!1,v=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(te){for(var se=r(c);se!==null;){if(se.callback===null)n(c);else if(se.startTime<=te)n(c),se.sortIndex=se.expirationTime,t(l,se);else break;se=r(c)}}function k(te){if(m=!1,y(te),!v)if(r(l)!==null)v=!0,we(D);else{var se=r(c);se!==null&&Ee(k,se.startTime-te)}}function D(te,se){v=!1,m&&(m=!1,g(b),b=-1),p=!0;var pe=f;try{for(y(se),d=r(l);d!==null&&(!(d.expirationTime>se)||te&&!X());){var ve=d.callback;if(typeof ve=="function"){d.callback=null,f=d.priorityLevel;var F=ve(d.expirationTime<=se);se=e.unstable_now(),typeof F=="function"?d.callback=F:d===r(l)&&n(l),y(se)}else n(l);d=r(l)}if(d!==null)var I=!0;else{var O=r(c);O!==null&&Ee(k,O.startTime-se),I=!1}return I}finally{d=null,f=pe,p=!1}}var L=!1,C=null,b=-1,j=5,z=-1;function X(){return!(e.unstable_now()-z<j)}function R(){if(C!==null){var te=e.unstable_now();z=te;var se=!0;try{se=C(!0,te)}finally{se?H():(L=!1,C=null)}}else L=!1}var H;if(typeof x=="function")H=function(){x(R)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,re=ie.port2;ie.port1.onmessage=R,H=function(){re.postMessage(null)}}else H=function(){w(R,0)};function we(te){C=te,L||(L=!0,H())}function Ee(te,se){b=w(function(){te(e.unstable_now())},se)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,we(D))},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(te){switch(f){case 1:case 2:case 3:var se=3;break;default:se=f}var pe=f;f=se;try{return te()}finally{f=pe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(te,se){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var pe=f;f=te;try{return se()}finally{f=pe}},e.unstable_scheduleCallback=function(te,se,pe){var ve=e.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?ve+pe:ve):pe=ve,te){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=pe+F,te={id:u++,callback:se,priorityLevel:te,startTime:pe,expirationTime:F,sortIndex:-1},pe>ve?(te.sortIndex=pe,t(c,te),r(l)===null&&te===r(c)&&(m?(g(b),b=-1):m=!0,Ee(k,pe-ve))):(te.sortIndex=F,t(l,te),v||p||(v=!0,we(D))),te},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(te){var se=f;return function(){var pe=f;f=se;try{return te.apply(this,arguments)}finally{f=pe}}}})(mp);pp.exports=mp;var hv=pp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dv=Fe,rr=hv;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gp=new Set,ca={};function di(e,t){ns(e,t),ns(e+"Capture",t)}function ns(e,t){for(ca[e]=t,e=0;e<t.length;e++)gp.add(t[e])}var en=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zc=Object.prototype.hasOwnProperty,pv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wf={},zf={};function mv(e){return Zc.call(zf,e)?!0:Zc.call(Wf,e)?!1:pv.test(e)?zf[e]=!0:(Wf[e]=!0,!1)}function gv(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function xv(e,t,r,n){if(t===null||typeof t>"u"||gv(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Mt(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){wt[e]=new Mt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];wt[t]=new Mt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){wt[e]=new Mt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){wt[e]=new Mt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){wt[e]=new Mt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){wt[e]=new Mt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){wt[e]=new Mt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){wt[e]=new Mt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){wt[e]=new Mt(e,5,!1,e.toLowerCase(),null,!1,!1)});var f0=/[\-:]([a-z])/g;function h0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(f0,h0);wt[t]=new Mt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(f0,h0);wt[t]=new Mt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(f0,h0);wt[t]=new Mt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){wt[e]=new Mt(e,1,!1,e.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){wt[e]=new Mt(e,1,!1,e.toLowerCase(),null,!0,!0)});function d0(e,t,r,n){var i=wt.hasOwnProperty(t)?wt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(xv(t,r,i,n)&&(r=null),n||i===null?mv(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var on=dv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,eo=Symbol.for("react.element"),bi=Symbol.for("react.portal"),Ii=Symbol.for("react.fragment"),p0=Symbol.for("react.strict_mode"),eu=Symbol.for("react.profiler"),xp=Symbol.for("react.provider"),vp=Symbol.for("react.context"),m0=Symbol.for("react.forward_ref"),tu=Symbol.for("react.suspense"),ru=Symbol.for("react.suspense_list"),g0=Symbol.for("react.memo"),dn=Symbol.for("react.lazy"),yp=Symbol.for("react.offscreen"),Hf=Symbol.iterator;function Ts(e){return e===null||typeof e!="object"?null:(e=Hf&&e[Hf]||e["@@iterator"],typeof e=="function"?e:null)}var Xe=Object.assign,hc;function js(e){if(hc===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);hc=t&&t[1]||""}return`
`+hc+e}var dc=!1;function pc(e,t){if(!e||dc)return"";dc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{dc=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?js(e):""}function vv(e){switch(e.tag){case 5:return js(e.type);case 16:return js("Lazy");case 13:return js("Suspense");case 19:return js("SuspenseList");case 0:case 2:case 15:return e=pc(e.type,!1),e;case 11:return e=pc(e.type.render,!1),e;case 1:return e=pc(e.type,!0),e;default:return""}}function nu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ii:return"Fragment";case bi:return"Portal";case eu:return"Profiler";case p0:return"StrictMode";case tu:return"Suspense";case ru:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vp:return(e.displayName||"Context")+".Consumer";case xp:return(e._context.displayName||"Context")+".Provider";case m0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case g0:return t=e.displayName||null,t!==null?t:nu(e.type)||"Memo";case dn:t=e._payload,e=e._init;try{return nu(e(t))}catch{}}return null}function yv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nu(t);case 8:return t===p0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Rn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _p(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function _v(e){var t=_p(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function to(e){e._valueTracker||(e._valueTracker=_v(e))}function wp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=_p(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function zo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function iu(e,t){var r=t.checked;return Xe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Vf(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Rn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ep(e,t){t=t.checked,t!=null&&d0(e,"checked",t,!1)}function su(e,t){Ep(e,t);var r=Rn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?au(e,t.type,r):t.hasOwnProperty("defaultValue")&&au(e,t.type,Rn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Gf(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function au(e,t,r){(t!=="number"||zo(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ls=Array.isArray;function Ki(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Rn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function ou(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return Xe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Kf(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(J(92));if(Ls(r)){if(1<r.length)throw Error(J(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Rn(r)}}function Sp(e,t){var r=Rn(t.value),n=Rn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Xf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Tp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Tp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ro,kp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ro=ro||document.createElement("div"),ro.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ro.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ua(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var zs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wv=["Webkit","ms","Moz","O"];Object.keys(zs).forEach(function(e){wv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zs[t]=zs[e]})});function Ap(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||zs.hasOwnProperty(e)&&zs[e]?(""+t).trim():t+"px"}function Np(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Ap(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Ev=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cu(e,t){if(t){if(Ev[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function uu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fu=null;function x0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hu=null,Xi=null,Yi=null;function Yf(e){if(e=Ma(e)){if(typeof hu!="function")throw Error(J(280));var t=e.stateNode;t&&(t=jl(t),hu(e.stateNode,e.type,t))}}function Cp(e){Xi?Yi?Yi.push(e):Yi=[e]:Xi=e}function Fp(){if(Xi){var e=Xi,t=Yi;if(Yi=Xi=null,Yf(e),t)for(e=0;e<t.length;e++)Yf(t[e])}}function Op(e,t){return e(t)}function Rp(){}var mc=!1;function Pp(e,t,r){if(mc)return e(t,r);mc=!0;try{return Op(e,t,r)}finally{mc=!1,(Xi!==null||Yi!==null)&&(Rp(),Fp())}}function fa(e,t){var r=e.stateNode;if(r===null)return null;var n=jl(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(J(231,t,typeof r));return r}var du=!1;if(en)try{var ks={};Object.defineProperty(ks,"passive",{get:function(){du=!0}}),window.addEventListener("test",ks,ks),window.removeEventListener("test",ks,ks)}catch{du=!1}function Sv(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Hs=!1,Ho=null,Vo=!1,pu=null,Tv={onError:function(e){Hs=!0,Ho=e}};function kv(e,t,r,n,i,s,a,o,l){Hs=!1,Ho=null,Sv.apply(Tv,arguments)}function Av(e,t,r,n,i,s,a,o,l){if(kv.apply(this,arguments),Hs){if(Hs){var c=Ho;Hs=!1,Ho=null}else throw Error(J(198));Vo||(Vo=!0,pu=c)}}function pi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Dp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qf(e){if(pi(e)!==e)throw Error(J(188))}function Nv(e){var t=e.alternate;if(!t){if(t=pi(e),t===null)throw Error(J(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return qf(i),e;if(s===n)return qf(i),t;s=s.sibling}throw Error(J(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(J(189))}}if(r.alternate!==n)throw Error(J(190))}if(r.tag!==3)throw Error(J(188));return r.stateNode.current===r?e:t}function bp(e){return e=Nv(e),e!==null?Ip(e):null}function Ip(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ip(e);if(t!==null)return t;e=e.sibling}return null}var jp=rr.unstable_scheduleCallback,Jf=rr.unstable_cancelCallback,Cv=rr.unstable_shouldYield,Fv=rr.unstable_requestPaint,Ze=rr.unstable_now,Ov=rr.unstable_getCurrentPriorityLevel,v0=rr.unstable_ImmediatePriority,Lp=rr.unstable_UserBlockingPriority,Go=rr.unstable_NormalPriority,Rv=rr.unstable_LowPriority,Mp=rr.unstable_IdlePriority,Pl=null,Mr=null;function Pv(e){if(Mr&&typeof Mr.onCommitFiberRoot=="function")try{Mr.onCommitFiberRoot(Pl,e,void 0,(e.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:Iv,Dv=Math.log,bv=Math.LN2;function Iv(e){return e>>>=0,e===0?32:31-(Dv(e)/bv|0)|0}var no=64,io=4194304;function Ms(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ko(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Ms(o):(s&=a,s!==0&&(n=Ms(s)))}else a=r&~i,a!==0?n=Ms(a):s!==0&&(n=Ms(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Nr(t),i=1<<r,n|=e[r],t&=~i;return n}function jv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lv(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Nr(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=jv(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function mu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Bp(){var e=no;return no<<=1,!(no&4194240)&&(no=64),e}function gc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ja(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Nr(t),e[t]=r}function Mv(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Nr(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function y0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Nr(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var be=0;function Up(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $p,_0,Wp,zp,Hp,gu=!1,so=[],Sn=null,Tn=null,kn=null,ha=new Map,da=new Map,mn=[],Bv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qf(e,t){switch(e){case"focusin":case"focusout":Sn=null;break;case"dragenter":case"dragleave":Tn=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":ha.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":da.delete(t.pointerId)}}function As(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Ma(t),t!==null&&_0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Uv(e,t,r,n,i){switch(t){case"focusin":return Sn=As(Sn,e,t,r,n,i),!0;case"dragenter":return Tn=As(Tn,e,t,r,n,i),!0;case"mouseover":return kn=As(kn,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return ha.set(s,As(ha.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,da.set(s,As(da.get(s)||null,e,t,r,n,i)),!0}return!1}function Vp(e){var t=Zn(e.target);if(t!==null){var r=pi(t);if(r!==null){if(t=r.tag,t===13){if(t=Dp(r),t!==null){e.blockedOn=t,Hp(e.priority,function(){Wp(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ro(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=xu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);fu=n,r.target.dispatchEvent(n),fu=null}else return t=Ma(r),t!==null&&_0(t),e.blockedOn=r,!1;t.shift()}return!0}function Zf(e,t,r){Ro(e)&&r.delete(t)}function $v(){gu=!1,Sn!==null&&Ro(Sn)&&(Sn=null),Tn!==null&&Ro(Tn)&&(Tn=null),kn!==null&&Ro(kn)&&(kn=null),ha.forEach(Zf),da.forEach(Zf)}function Ns(e,t){e.blockedOn===t&&(e.blockedOn=null,gu||(gu=!0,rr.unstable_scheduleCallback(rr.unstable_NormalPriority,$v)))}function pa(e){function t(i){return Ns(i,e)}if(0<so.length){Ns(so[0],e);for(var r=1;r<so.length;r++){var n=so[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Sn!==null&&Ns(Sn,e),Tn!==null&&Ns(Tn,e),kn!==null&&Ns(kn,e),ha.forEach(t),da.forEach(t),r=0;r<mn.length;r++)n=mn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<mn.length&&(r=mn[0],r.blockedOn===null);)Vp(r),r.blockedOn===null&&mn.shift()}var qi=on.ReactCurrentBatchConfig,Xo=!0;function Wv(e,t,r,n){var i=be,s=qi.transition;qi.transition=null;try{be=1,w0(e,t,r,n)}finally{be=i,qi.transition=s}}function zv(e,t,r,n){var i=be,s=qi.transition;qi.transition=null;try{be=4,w0(e,t,r,n)}finally{be=i,qi.transition=s}}function w0(e,t,r,n){if(Xo){var i=xu(e,t,r,n);if(i===null)Ac(e,t,n,Yo,r),Qf(e,n);else if(Uv(i,e,t,r,n))n.stopPropagation();else if(Qf(e,n),t&4&&-1<Bv.indexOf(e)){for(;i!==null;){var s=Ma(i);if(s!==null&&$p(s),s=xu(e,t,r,n),s===null&&Ac(e,t,n,Yo,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Ac(e,t,n,null,r)}}var Yo=null;function xu(e,t,r,n){if(Yo=null,e=x0(n),e=Zn(e),e!==null)if(t=pi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Dp(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yo=e,null}function Gp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ov()){case v0:return 1;case Lp:return 4;case Go:case Rv:return 16;case Mp:return 536870912;default:return 16}default:return 16}}var vn=null,E0=null,Po=null;function Kp(){if(Po)return Po;var e,t=E0,r=t.length,n,i="value"in vn?vn.value:vn.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return Po=i.slice(e,1<n?1-n:void 0)}function Do(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ao(){return!0}function eh(){return!1}function sr(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ao:eh,this.isPropagationStopped=eh,this}return Xe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ao)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ao)},persist:function(){},isPersistent:ao}),t}var ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},S0=sr(ds),La=Xe({},ds,{view:0,detail:0}),Hv=sr(La),xc,vc,Cs,Dl=Xe({},La,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:T0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Cs&&(Cs&&e.type==="mousemove"?(xc=e.screenX-Cs.screenX,vc=e.screenY-Cs.screenY):vc=xc=0,Cs=e),xc)},movementY:function(e){return"movementY"in e?e.movementY:vc}}),th=sr(Dl),Vv=Xe({},Dl,{dataTransfer:0}),Gv=sr(Vv),Kv=Xe({},La,{relatedTarget:0}),yc=sr(Kv),Xv=Xe({},ds,{animationName:0,elapsedTime:0,pseudoElement:0}),Yv=sr(Xv),qv=Xe({},ds,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jv=sr(qv),Qv=Xe({},ds,{data:0}),rh=sr(Qv),Zv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ey={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ty={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ry(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ty[e])?!!t[e]:!1}function T0(){return ry}var ny=Xe({},La,{key:function(e){if(e.key){var t=Zv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Do(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ey[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:T0,charCode:function(e){return e.type==="keypress"?Do(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Do(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),iy=sr(ny),sy=Xe({},Dl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nh=sr(sy),ay=Xe({},La,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:T0}),oy=sr(ay),ly=Xe({},ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),cy=sr(ly),uy=Xe({},Dl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fy=sr(uy),hy=[9,13,27,32],k0=en&&"CompositionEvent"in window,Vs=null;en&&"documentMode"in document&&(Vs=document.documentMode);var dy=en&&"TextEvent"in window&&!Vs,Xp=en&&(!k0||Vs&&8<Vs&&11>=Vs),ih=" ",sh=!1;function Yp(e,t){switch(e){case"keyup":return hy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ji=!1;function py(e,t){switch(e){case"compositionend":return qp(t);case"keypress":return t.which!==32?null:(sh=!0,ih);case"textInput":return e=t.data,e===ih&&sh?null:e;default:return null}}function my(e,t){if(ji)return e==="compositionend"||!k0&&Yp(e,t)?(e=Kp(),Po=E0=vn=null,ji=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xp&&t.locale!=="ko"?null:t.data;default:return null}}var gy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ah(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!gy[e.type]:t==="textarea"}function Jp(e,t,r,n){Cp(n),t=qo(t,"onChange"),0<t.length&&(r=new S0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gs=null,ma=null;function xy(e){l1(e,0)}function bl(e){var t=Bi(e);if(wp(t))return e}function vy(e,t){if(e==="change")return t}var Qp=!1;if(en){var _c;if(en){var wc="oninput"in document;if(!wc){var oh=document.createElement("div");oh.setAttribute("oninput","return;"),wc=typeof oh.oninput=="function"}_c=wc}else _c=!1;Qp=_c&&(!document.documentMode||9<document.documentMode)}function lh(){Gs&&(Gs.detachEvent("onpropertychange",Zp),ma=Gs=null)}function Zp(e){if(e.propertyName==="value"&&bl(ma)){var t=[];Jp(t,ma,e,x0(e)),Pp(xy,t)}}function yy(e,t,r){e==="focusin"?(lh(),Gs=t,ma=r,Gs.attachEvent("onpropertychange",Zp)):e==="focusout"&&lh()}function _y(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bl(ma)}function wy(e,t){if(e==="click")return bl(t)}function Ey(e,t){if(e==="input"||e==="change")return bl(t)}function Sy(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Or=typeof Object.is=="function"?Object.is:Sy;function ga(e,t){if(Or(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Zc.call(t,i)||!Or(e[i],t[i]))return!1}return!0}function ch(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function uh(e,t){var r=ch(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ch(r)}}function e1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?e1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function t1(){for(var e=window,t=zo();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=zo(e.document)}return t}function A0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ty(e){var t=t1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&e1(r.ownerDocument.documentElement,r)){if(n!==null&&A0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=uh(r,s);var a=uh(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ky=en&&"documentMode"in document&&11>=document.documentMode,Li=null,vu=null,Ks=null,yu=!1;function fh(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;yu||Li==null||Li!==zo(n)||(n=Li,"selectionStart"in n&&A0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ks&&ga(Ks,n)||(Ks=n,n=qo(vu,"onSelect"),0<n.length&&(t=new S0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Li)))}function oo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Mi={animationend:oo("Animation","AnimationEnd"),animationiteration:oo("Animation","AnimationIteration"),animationstart:oo("Animation","AnimationStart"),transitionend:oo("Transition","TransitionEnd")},Ec={},r1={};en&&(r1=document.createElement("div").style,"AnimationEvent"in window||(delete Mi.animationend.animation,delete Mi.animationiteration.animation,delete Mi.animationstart.animation),"TransitionEvent"in window||delete Mi.transitionend.transition);function Il(e){if(Ec[e])return Ec[e];if(!Mi[e])return e;var t=Mi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in r1)return Ec[e]=t[r];return e}var n1=Il("animationend"),i1=Il("animationiteration"),s1=Il("animationstart"),a1=Il("transitionend"),o1=new Map,hh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jn(e,t){o1.set(e,t),di(t,[e])}for(var Sc=0;Sc<hh.length;Sc++){var Tc=hh[Sc],Ay=Tc.toLowerCase(),Ny=Tc[0].toUpperCase()+Tc.slice(1);jn(Ay,"on"+Ny)}jn(n1,"onAnimationEnd");jn(i1,"onAnimationIteration");jn(s1,"onAnimationStart");jn("dblclick","onDoubleClick");jn("focusin","onFocus");jn("focusout","onBlur");jn(a1,"onTransitionEnd");ns("onMouseEnter",["mouseout","mouseover"]);ns("onMouseLeave",["mouseout","mouseover"]);ns("onPointerEnter",["pointerout","pointerover"]);ns("onPointerLeave",["pointerout","pointerover"]);di("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));di("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));di("onBeforeInput",["compositionend","keypress","textInput","paste"]);di("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));di("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));di("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bs));function dh(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Av(n,t,void 0,e),e.currentTarget=null}function l1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;dh(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;dh(i,o,c),s=l}}}if(Vo)throw e=pu,Vo=!1,pu=null,e}function Ue(e,t){var r=t[Tu];r===void 0&&(r=t[Tu]=new Set);var n=e+"__bubble";r.has(n)||(c1(t,e,2,!1),r.add(n))}function kc(e,t,r){var n=0;t&&(n|=4),c1(r,e,n,t)}var lo="_reactListening"+Math.random().toString(36).slice(2);function xa(e){if(!e[lo]){e[lo]=!0,gp.forEach(function(r){r!=="selectionchange"&&(Cy.has(r)||kc(r,!1,e),kc(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[lo]||(t[lo]=!0,kc("selectionchange",!1,t))}}function c1(e,t,r,n){switch(Gp(t)){case 1:var i=Wv;break;case 4:i=zv;break;default:i=w0}r=i.bind(null,t,r,e),i=void 0,!du||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Ac(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Zn(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Pp(function(){var c=s,u=x0(r),d=[];e:{var f=o1.get(e);if(f!==void 0){var p=S0,v=e;switch(e){case"keypress":if(Do(r)===0)break e;case"keydown":case"keyup":p=iy;break;case"focusin":v="focus",p=yc;break;case"focusout":v="blur",p=yc;break;case"beforeblur":case"afterblur":p=yc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=th;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Gv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=oy;break;case n1:case i1:case s1:p=Yv;break;case a1:p=cy;break;case"scroll":p=Hv;break;case"wheel":p=fy;break;case"copy":case"cut":case"paste":p=Jv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=nh}var m=(t&4)!==0,w=!m&&e==="scroll",g=m?f!==null?f+"Capture":null:f;m=[];for(var x=c,y;x!==null;){y=x;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,g!==null&&(k=fa(x,g),k!=null&&m.push(va(x,k,y)))),w)break;x=x.return}0<m.length&&(f=new p(f,v,null,r,u),d.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==fu&&(v=r.relatedTarget||r.fromElement)&&(Zn(v)||v[tn]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=r.relatedTarget||r.toElement,p=c,v=v?Zn(v):null,v!==null&&(w=pi(v),v!==w||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(m=th,k="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(m=nh,k="onPointerLeave",g="onPointerEnter",x="pointer"),w=p==null?f:Bi(p),y=v==null?f:Bi(v),f=new m(k,x+"leave",p,r,u),f.target=w,f.relatedTarget=y,k=null,Zn(u)===c&&(m=new m(g,x+"enter",v,r,u),m.target=y,m.relatedTarget=w,k=m),w=k,p&&v)t:{for(m=p,g=v,x=0,y=m;y;y=Ei(y))x++;for(y=0,k=g;k;k=Ei(k))y++;for(;0<x-y;)m=Ei(m),x--;for(;0<y-x;)g=Ei(g),y--;for(;x--;){if(m===g||g!==null&&m===g.alternate)break t;m=Ei(m),g=Ei(g)}m=null}else m=null;p!==null&&ph(d,f,p,m,!1),v!==null&&w!==null&&ph(d,w,v,m,!0)}}e:{if(f=c?Bi(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var D=vy;else if(ah(f))if(Qp)D=Ey;else{D=_y;var L=yy}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(D=wy);if(D&&(D=D(e,c))){Jp(d,D,r,u);break e}L&&L(e,f,c),e==="focusout"&&(L=f._wrapperState)&&L.controlled&&f.type==="number"&&au(f,"number",f.value)}switch(L=c?Bi(c):window,e){case"focusin":(ah(L)||L.contentEditable==="true")&&(Li=L,vu=c,Ks=null);break;case"focusout":Ks=vu=Li=null;break;case"mousedown":yu=!0;break;case"contextmenu":case"mouseup":case"dragend":yu=!1,fh(d,r,u);break;case"selectionchange":if(ky)break;case"keydown":case"keyup":fh(d,r,u)}var C;if(k0)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else ji?Yp(e,r)&&(b="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(b="onCompositionStart");b&&(Xp&&r.locale!=="ko"&&(ji||b!=="onCompositionStart"?b==="onCompositionEnd"&&ji&&(C=Kp()):(vn=u,E0="value"in vn?vn.value:vn.textContent,ji=!0)),L=qo(c,b),0<L.length&&(b=new rh(b,e,null,r,u),d.push({event:b,listeners:L}),C?b.data=C:(C=qp(r),C!==null&&(b.data=C)))),(C=dy?py(e,r):my(e,r))&&(c=qo(c,"onBeforeInput"),0<c.length&&(u=new rh("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=C))}l1(d,t)})}function va(e,t,r){return{instance:e,listener:t,currentTarget:r}}function qo(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=fa(e,r),s!=null&&n.unshift(va(e,s,i)),s=fa(e,t),s!=null&&n.push(va(e,s,i))),e=e.return}return n}function Ei(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ph(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=fa(r,s),l!=null&&a.unshift(va(r,l,o))):i||(l=fa(r,s),l!=null&&a.push(va(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var Fy=/\r\n?/g,Oy=/\u0000|\uFFFD/g;function mh(e){return(typeof e=="string"?e:""+e).replace(Fy,`
`).replace(Oy,"")}function co(e,t,r){if(t=mh(t),mh(e)!==t&&r)throw Error(J(425))}function Jo(){}var _u=null,wu=null;function Eu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Su=typeof setTimeout=="function"?setTimeout:void 0,Ry=typeof clearTimeout=="function"?clearTimeout:void 0,gh=typeof Promise=="function"?Promise:void 0,Py=typeof queueMicrotask=="function"?queueMicrotask:typeof gh<"u"?function(e){return gh.resolve(null).then(e).catch(Dy)}:Su;function Dy(e){setTimeout(function(){throw e})}function Nc(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),pa(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);pa(t)}function An(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function xh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ps=Math.random().toString(36).slice(2),Lr="__reactFiber$"+ps,ya="__reactProps$"+ps,tn="__reactContainer$"+ps,Tu="__reactEvents$"+ps,by="__reactListeners$"+ps,Iy="__reactHandles$"+ps;function Zn(e){var t=e[Lr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[tn]||r[Lr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=xh(e);e!==null;){if(r=e[Lr])return r;e=xh(e)}return t}e=r,r=e.parentNode}return null}function Ma(e){return e=e[Lr]||e[tn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Bi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function jl(e){return e[ya]||null}var ku=[],Ui=-1;function Ln(e){return{current:e}}function $e(e){0>Ui||(e.current=ku[Ui],ku[Ui]=null,Ui--)}function Be(e,t){Ui++,ku[Ui]=e.current,e.current=t}var Pn={},Ft=Ln(Pn),zt=Ln(!1),si=Pn;function is(e,t){var r=e.type.contextTypes;if(!r)return Pn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ht(e){return e=e.childContextTypes,e!=null}function Qo(){$e(zt),$e(Ft)}function vh(e,t,r){if(Ft.current!==Pn)throw Error(J(168));Be(Ft,t),Be(zt,r)}function u1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(J(108,yv(e)||"Unknown",i));return Xe({},r,n)}function Zo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pn,si=Ft.current,Be(Ft,e),Be(zt,zt.current),!0}function yh(e,t,r){var n=e.stateNode;if(!n)throw Error(J(169));r?(e=u1(e,t,si),n.__reactInternalMemoizedMergedChildContext=e,$e(zt),$e(Ft),Be(Ft,e)):$e(zt),Be(zt,r)}var Kr=null,Ll=!1,Cc=!1;function f1(e){Kr===null?Kr=[e]:Kr.push(e)}function jy(e){Ll=!0,f1(e)}function Mn(){if(!Cc&&Kr!==null){Cc=!0;var e=0,t=be;try{var r=Kr;for(be=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Kr=null,Ll=!1}catch(i){throw Kr!==null&&(Kr=Kr.slice(e+1)),jp(v0,Mn),i}finally{be=t,Cc=!1}}return null}var $i=[],Wi=0,el=null,tl=0,cr=[],ur=0,ai=null,Xr=1,Yr="";function Kn(e,t){$i[Wi++]=tl,$i[Wi++]=el,el=e,tl=t}function h1(e,t,r){cr[ur++]=Xr,cr[ur++]=Yr,cr[ur++]=ai,ai=e;var n=Xr;e=Yr;var i=32-Nr(n)-1;n&=~(1<<i),r+=1;var s=32-Nr(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Xr=1<<32-Nr(t)+i|r<<i|n,Yr=s+e}else Xr=1<<s|r<<i|n,Yr=e}function N0(e){e.return!==null&&(Kn(e,1),h1(e,1,0))}function C0(e){for(;e===el;)el=$i[--Wi],$i[Wi]=null,tl=$i[--Wi],$i[Wi]=null;for(;e===ai;)ai=cr[--ur],cr[ur]=null,Yr=cr[--ur],cr[ur]=null,Xr=cr[--ur],cr[ur]=null}var tr=null,er=null,ze=!1,Tr=null;function d1(e,t){var r=fr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function _h(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,tr=e,er=An(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,tr=e,er=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ai!==null?{id:Xr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=fr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,tr=e,er=null,!0):!1;default:return!1}}function Au(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Nu(e){if(ze){var t=er;if(t){var r=t;if(!_h(e,t)){if(Au(e))throw Error(J(418));t=An(r.nextSibling);var n=tr;t&&_h(e,t)?d1(n,r):(e.flags=e.flags&-4097|2,ze=!1,tr=e)}}else{if(Au(e))throw Error(J(418));e.flags=e.flags&-4097|2,ze=!1,tr=e}}}function wh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;tr=e}function uo(e){if(e!==tr)return!1;if(!ze)return wh(e),ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Eu(e.type,e.memoizedProps)),t&&(t=er)){if(Au(e))throw p1(),Error(J(418));for(;t;)d1(e,t),t=An(t.nextSibling)}if(wh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){er=An(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}er=null}}else er=tr?An(e.stateNode.nextSibling):null;return!0}function p1(){for(var e=er;e;)e=An(e.nextSibling)}function ss(){er=tr=null,ze=!1}function F0(e){Tr===null?Tr=[e]:Tr.push(e)}var Ly=on.ReactCurrentBatchConfig;function Fs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(J(309));var n=r.stateNode}if(!n)throw Error(J(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(J(284));if(!r._owner)throw Error(J(290,e))}return e}function fo(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Eh(e){var t=e._init;return t(e._payload)}function m1(e){function t(g,x){if(e){var y=g.deletions;y===null?(g.deletions=[x],g.flags|=16):y.push(x)}}function r(g,x){if(!e)return null;for(;x!==null;)t(g,x),x=x.sibling;return null}function n(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function i(g,x){return g=On(g,x),g.index=0,g.sibling=null,g}function s(g,x,y){return g.index=y,e?(y=g.alternate,y!==null?(y=y.index,y<x?(g.flags|=2,x):y):(g.flags|=2,x)):(g.flags|=1048576,x)}function a(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,x,y,k){return x===null||x.tag!==6?(x=Ic(y,g.mode,k),x.return=g,x):(x=i(x,y),x.return=g,x)}function l(g,x,y,k){var D=y.type;return D===Ii?u(g,x,y.props.children,k,y.key):x!==null&&(x.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===dn&&Eh(D)===x.type)?(k=i(x,y.props),k.ref=Fs(g,x,y),k.return=g,k):(k=Uo(y.type,y.key,y.props,null,g.mode,k),k.ref=Fs(g,x,y),k.return=g,k)}function c(g,x,y,k){return x===null||x.tag!==4||x.stateNode.containerInfo!==y.containerInfo||x.stateNode.implementation!==y.implementation?(x=jc(y,g.mode,k),x.return=g,x):(x=i(x,y.children||[]),x.return=g,x)}function u(g,x,y,k,D){return x===null||x.tag!==7?(x=ni(y,g.mode,k,D),x.return=g,x):(x=i(x,y),x.return=g,x)}function d(g,x,y){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ic(""+x,g.mode,y),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case eo:return y=Uo(x.type,x.key,x.props,null,g.mode,y),y.ref=Fs(g,null,x),y.return=g,y;case bi:return x=jc(x,g.mode,y),x.return=g,x;case dn:var k=x._init;return d(g,k(x._payload),y)}if(Ls(x)||Ts(x))return x=ni(x,g.mode,y,null),x.return=g,x;fo(g,x)}return null}function f(g,x,y,k){var D=x!==null?x.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return D!==null?null:o(g,x,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case eo:return y.key===D?l(g,x,y,k):null;case bi:return y.key===D?c(g,x,y,k):null;case dn:return D=y._init,f(g,x,D(y._payload),k)}if(Ls(y)||Ts(y))return D!==null?null:u(g,x,y,k,null);fo(g,y)}return null}function p(g,x,y,k,D){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(y)||null,o(x,g,""+k,D);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case eo:return g=g.get(k.key===null?y:k.key)||null,l(x,g,k,D);case bi:return g=g.get(k.key===null?y:k.key)||null,c(x,g,k,D);case dn:var L=k._init;return p(g,x,y,L(k._payload),D)}if(Ls(k)||Ts(k))return g=g.get(y)||null,u(x,g,k,D,null);fo(x,k)}return null}function v(g,x,y,k){for(var D=null,L=null,C=x,b=x=0,j=null;C!==null&&b<y.length;b++){C.index>b?(j=C,C=null):j=C.sibling;var z=f(g,C,y[b],k);if(z===null){C===null&&(C=j);break}e&&C&&z.alternate===null&&t(g,C),x=s(z,x,b),L===null?D=z:L.sibling=z,L=z,C=j}if(b===y.length)return r(g,C),ze&&Kn(g,b),D;if(C===null){for(;b<y.length;b++)C=d(g,y[b],k),C!==null&&(x=s(C,x,b),L===null?D=C:L.sibling=C,L=C);return ze&&Kn(g,b),D}for(C=n(g,C);b<y.length;b++)j=p(C,g,b,y[b],k),j!==null&&(e&&j.alternate!==null&&C.delete(j.key===null?b:j.key),x=s(j,x,b),L===null?D=j:L.sibling=j,L=j);return e&&C.forEach(function(X){return t(g,X)}),ze&&Kn(g,b),D}function m(g,x,y,k){var D=Ts(y);if(typeof D!="function")throw Error(J(150));if(y=D.call(y),y==null)throw Error(J(151));for(var L=D=null,C=x,b=x=0,j=null,z=y.next();C!==null&&!z.done;b++,z=y.next()){C.index>b?(j=C,C=null):j=C.sibling;var X=f(g,C,z.value,k);if(X===null){C===null&&(C=j);break}e&&C&&X.alternate===null&&t(g,C),x=s(X,x,b),L===null?D=X:L.sibling=X,L=X,C=j}if(z.done)return r(g,C),ze&&Kn(g,b),D;if(C===null){for(;!z.done;b++,z=y.next())z=d(g,z.value,k),z!==null&&(x=s(z,x,b),L===null?D=z:L.sibling=z,L=z);return ze&&Kn(g,b),D}for(C=n(g,C);!z.done;b++,z=y.next())z=p(C,g,b,z.value,k),z!==null&&(e&&z.alternate!==null&&C.delete(z.key===null?b:z.key),x=s(z,x,b),L===null?D=z:L.sibling=z,L=z);return e&&C.forEach(function(R){return t(g,R)}),ze&&Kn(g,b),D}function w(g,x,y,k){if(typeof y=="object"&&y!==null&&y.type===Ii&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case eo:e:{for(var D=y.key,L=x;L!==null;){if(L.key===D){if(D=y.type,D===Ii){if(L.tag===7){r(g,L.sibling),x=i(L,y.props.children),x.return=g,g=x;break e}}else if(L.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===dn&&Eh(D)===L.type){r(g,L.sibling),x=i(L,y.props),x.ref=Fs(g,L,y),x.return=g,g=x;break e}r(g,L);break}else t(g,L);L=L.sibling}y.type===Ii?(x=ni(y.props.children,g.mode,k,y.key),x.return=g,g=x):(k=Uo(y.type,y.key,y.props,null,g.mode,k),k.ref=Fs(g,x,y),k.return=g,g=k)}return a(g);case bi:e:{for(L=y.key;x!==null;){if(x.key===L)if(x.tag===4&&x.stateNode.containerInfo===y.containerInfo&&x.stateNode.implementation===y.implementation){r(g,x.sibling),x=i(x,y.children||[]),x.return=g,g=x;break e}else{r(g,x);break}else t(g,x);x=x.sibling}x=jc(y,g.mode,k),x.return=g,g=x}return a(g);case dn:return L=y._init,w(g,x,L(y._payload),k)}if(Ls(y))return v(g,x,y,k);if(Ts(y))return m(g,x,y,k);fo(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,x!==null&&x.tag===6?(r(g,x.sibling),x=i(x,y),x.return=g,g=x):(r(g,x),x=Ic(y,g.mode,k),x.return=g,g=x),a(g)):r(g,x)}return w}var as=m1(!0),g1=m1(!1),rl=Ln(null),nl=null,zi=null,O0=null;function R0(){O0=zi=nl=null}function P0(e){var t=rl.current;$e(rl),e._currentValue=t}function Cu(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ji(e,t){nl=e,O0=zi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wt=!0),e.firstContext=null)}function pr(e){var t=e._currentValue;if(O0!==e)if(e={context:e,memoizedValue:t,next:null},zi===null){if(nl===null)throw Error(J(308));zi=e,nl.dependencies={lanes:0,firstContext:e}}else zi=zi.next=e;return t}var ei=null;function D0(e){ei===null?ei=[e]:ei.push(e)}function x1(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,D0(t)):(r.next=i.next,i.next=r),t.interleaved=r,rn(e,n)}function rn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var pn=!1;function b0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function v1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Nn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Te&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,rn(e,r)}return i=n.interleaved,i===null?(t.next=t,D0(n)):(t.next=i.next,i.next=t),n.interleaved=t,rn(e,r)}function bo(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,y0(e,r)}}function Sh(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function il(e,t,r,n){var i=e.updateQueue;pn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;a=0,u=c=l=null,o=s;do{var f=o.lane,p=o.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,m=o;switch(f=t,p=r,m.tag){case 1:if(v=m.payload,typeof v=="function"){d=v.call(p,d,f);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,f=typeof v=="function"?v.call(p,d,f):v,f==null)break e;d=Xe({},d,f);break e;case 2:pn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,a|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);li|=a,e.lanes=a,e.memoizedState=d}}function Th(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(J(191,i));i.call(n)}}}var Ba={},Br=Ln(Ba),_a=Ln(Ba),wa=Ln(Ba);function ti(e){if(e===Ba)throw Error(J(174));return e}function I0(e,t){switch(Be(wa,t),Be(_a,e),Be(Br,Ba),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:lu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=lu(t,e)}$e(Br),Be(Br,t)}function os(){$e(Br),$e(_a),$e(wa)}function y1(e){ti(wa.current);var t=ti(Br.current),r=lu(t,e.type);t!==r&&(Be(_a,e),Be(Br,r))}function j0(e){_a.current===e&&($e(Br),$e(_a))}var Ge=Ln(0);function sl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fc=[];function L0(){for(var e=0;e<Fc.length;e++)Fc[e]._workInProgressVersionPrimary=null;Fc.length=0}var Io=on.ReactCurrentDispatcher,Oc=on.ReactCurrentBatchConfig,oi=0,Ke=null,ot=null,ct=null,al=!1,Xs=!1,Ea=0,My=0;function Tt(){throw Error(J(321))}function M0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Or(e[r],t[r]))return!1;return!0}function B0(e,t,r,n,i,s){if(oi=s,Ke=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Io.current=e===null||e.memoizedState===null?Wy:zy,e=r(n,i),Xs){s=0;do{if(Xs=!1,Ea=0,25<=s)throw Error(J(301));s+=1,ct=ot=null,t.updateQueue=null,Io.current=Hy,e=r(n,i)}while(Xs)}if(Io.current=ol,t=ot!==null&&ot.next!==null,oi=0,ct=ot=Ke=null,al=!1,t)throw Error(J(300));return e}function U0(){var e=Ea!==0;return Ea=0,e}function Ir(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?Ke.memoizedState=ct=e:ct=ct.next=e,ct}function mr(){if(ot===null){var e=Ke.alternate;e=e!==null?e.memoizedState:null}else e=ot.next;var t=ct===null?Ke.memoizedState:ct.next;if(t!==null)ct=t,ot=e;else{if(e===null)throw Error(J(310));ot=e,e={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},ct===null?Ke.memoizedState=ct=e:ct=ct.next=e}return ct}function Sa(e,t){return typeof t=="function"?t(e):t}function Rc(e){var t=mr(),r=t.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=e;var n=ot,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((oi&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=n):l=l.next=d,Ke.lanes|=u,li|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Or(n,t.memoizedState)||(Wt=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Ke.lanes|=s,li|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Pc(e){var t=mr(),r=t.queue;if(r===null)throw Error(J(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Or(s,t.memoizedState)||(Wt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function _1(){}function w1(e,t){var r=Ke,n=mr(),i=t(),s=!Or(n.memoizedState,i);if(s&&(n.memoizedState=i,Wt=!0),n=n.queue,$0(T1.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||ct!==null&&ct.memoizedState.tag&1){if(r.flags|=2048,Ta(9,S1.bind(null,r,n,i,t),void 0,null),dt===null)throw Error(J(349));oi&30||E1(r,t,i)}return i}function E1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function S1(e,t,r,n){t.value=r,t.getSnapshot=n,k1(t)&&A1(e)}function T1(e,t,r){return r(function(){k1(t)&&A1(e)})}function k1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Or(e,r)}catch{return!0}}function A1(e){var t=rn(e,1);t!==null&&Cr(t,e,1,-1)}function kh(e){var t=Ir();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sa,lastRenderedState:e},t.queue=e,e=e.dispatch=$y.bind(null,Ke,e),[t.memoizedState,e]}function Ta(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function N1(){return mr().memoizedState}function jo(e,t,r,n){var i=Ir();Ke.flags|=e,i.memoizedState=Ta(1|t,r,void 0,n===void 0?null:n)}function Ml(e,t,r,n){var i=mr();n=n===void 0?null:n;var s=void 0;if(ot!==null){var a=ot.memoizedState;if(s=a.destroy,n!==null&&M0(n,a.deps)){i.memoizedState=Ta(t,r,s,n);return}}Ke.flags|=e,i.memoizedState=Ta(1|t,r,s,n)}function Ah(e,t){return jo(8390656,8,e,t)}function $0(e,t){return Ml(2048,8,e,t)}function C1(e,t){return Ml(4,2,e,t)}function F1(e,t){return Ml(4,4,e,t)}function O1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function R1(e,t,r){return r=r!=null?r.concat([e]):null,Ml(4,4,O1.bind(null,t,e),r)}function W0(){}function P1(e,t){var r=mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&M0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function D1(e,t){var r=mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&M0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function b1(e,t,r){return oi&21?(Or(r,t)||(r=Bp(),Ke.lanes|=r,li|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wt=!0),e.memoizedState=r)}function By(e,t){var r=be;be=r!==0&&4>r?r:4,e(!0);var n=Oc.transition;Oc.transition={};try{e(!1),t()}finally{be=r,Oc.transition=n}}function I1(){return mr().memoizedState}function Uy(e,t,r){var n=Fn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},j1(e))L1(t,r);else if(r=x1(e,t,r,n),r!==null){var i=It();Cr(r,e,n,i),M1(r,t,n)}}function $y(e,t,r){var n=Fn(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(j1(e))L1(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Or(o,a)){var l=t.interleaved;l===null?(i.next=i,D0(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=x1(e,t,i,n),r!==null&&(i=It(),Cr(r,e,n,i),M1(r,t,n))}}function j1(e){var t=e.alternate;return e===Ke||t!==null&&t===Ke}function L1(e,t){Xs=al=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function M1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,y0(e,r)}}var ol={readContext:pr,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},Wy={readContext:pr,useCallback:function(e,t){return Ir().memoizedState=[e,t===void 0?null:t],e},useContext:pr,useEffect:Ah,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,jo(4194308,4,O1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return jo(4194308,4,e,t)},useInsertionEffect:function(e,t){return jo(4,2,e,t)},useMemo:function(e,t){var r=Ir();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ir();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Uy.bind(null,Ke,e),[n.memoizedState,e]},useRef:function(e){var t=Ir();return e={current:e},t.memoizedState=e},useState:kh,useDebugValue:W0,useDeferredValue:function(e){return Ir().memoizedState=e},useTransition:function(){var e=kh(!1),t=e[0];return e=By.bind(null,e[1]),Ir().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ke,i=Ir();if(ze){if(r===void 0)throw Error(J(407));r=r()}else{if(r=t(),dt===null)throw Error(J(349));oi&30||E1(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Ah(T1.bind(null,n,s,e),[e]),n.flags|=2048,Ta(9,S1.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Ir(),t=dt.identifierPrefix;if(ze){var r=Yr,n=Xr;r=(n&~(1<<32-Nr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ea++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=My++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},zy={readContext:pr,useCallback:P1,useContext:pr,useEffect:$0,useImperativeHandle:R1,useInsertionEffect:C1,useLayoutEffect:F1,useMemo:D1,useReducer:Rc,useRef:N1,useState:function(){return Rc(Sa)},useDebugValue:W0,useDeferredValue:function(e){var t=mr();return b1(t,ot.memoizedState,e)},useTransition:function(){var e=Rc(Sa)[0],t=mr().memoizedState;return[e,t]},useMutableSource:_1,useSyncExternalStore:w1,useId:I1,unstable_isNewReconciler:!1},Hy={readContext:pr,useCallback:P1,useContext:pr,useEffect:$0,useImperativeHandle:R1,useInsertionEffect:C1,useLayoutEffect:F1,useMemo:D1,useReducer:Pc,useRef:N1,useState:function(){return Pc(Sa)},useDebugValue:W0,useDeferredValue:function(e){var t=mr();return ot===null?t.memoizedState=e:b1(t,ot.memoizedState,e)},useTransition:function(){var e=Pc(Sa)[0],t=mr().memoizedState;return[e,t]},useMutableSource:_1,useSyncExternalStore:w1,useId:I1,unstable_isNewReconciler:!1};function wr(e,t){if(e&&e.defaultProps){t=Xe({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Fu(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Xe({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Bl={isMounted:function(e){return(e=e._reactInternals)?pi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=It(),i=Fn(e),s=qr(n,i);s.payload=t,r!=null&&(s.callback=r),t=Nn(e,s,i),t!==null&&(Cr(t,e,i,n),bo(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=It(),i=Fn(e),s=qr(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Nn(e,s,i),t!==null&&(Cr(t,e,i,n),bo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=It(),n=Fn(e),i=qr(r,n);i.tag=2,t!=null&&(i.callback=t),t=Nn(e,i,n),t!==null&&(Cr(t,e,n,r),bo(t,e,n))}};function Nh(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!ga(r,n)||!ga(i,s):!0}function B1(e,t,r){var n=!1,i=Pn,s=t.contextType;return typeof s=="object"&&s!==null?s=pr(s):(i=Ht(t)?si:Ft.current,n=t.contextTypes,s=(n=n!=null)?is(e,i):Pn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bl,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ch(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Bl.enqueueReplaceState(t,t.state,null)}function Ou(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},b0(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=pr(s):(s=Ht(t)?si:Ft.current,i.context=is(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Fu(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Bl.enqueueReplaceState(i,i.state,null),il(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ls(e,t){try{var r="",n=t;do r+=vv(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Dc(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ru(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Vy=typeof WeakMap=="function"?WeakMap:Map;function U1(e,t,r){r=qr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){cl||(cl=!0,$u=n),Ru(e,t)},r}function $1(e,t,r){r=qr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Ru(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Ru(e,t),typeof n!="function"&&(Cn===null?Cn=new Set([this]):Cn.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Fh(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Vy;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=s2.bind(null,e,t,r),t.then(e,e))}function Oh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Rh(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qr(-1,1),t.tag=2,Nn(r,t,1))),r.lanes|=1),e)}var Gy=on.ReactCurrentOwner,Wt=!1;function Pt(e,t,r,n){t.child=e===null?g1(t,null,r,n):as(t,e.child,r,n)}function Ph(e,t,r,n,i){r=r.render;var s=t.ref;return Ji(t,i),n=B0(e,t,r,n,s,i),r=U0(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,nn(e,t,i)):(ze&&r&&N0(t),t.flags|=1,Pt(e,t,n,i),t.child)}function Dh(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!q0(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,W1(e,t,s,n,i)):(e=Uo(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:ga,r(a,n)&&e.ref===t.ref)return nn(e,t,i)}return t.flags|=1,e=On(s,n),e.ref=t.ref,e.return=t,t.child=e}function W1(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(ga(s,n)&&e.ref===t.ref)if(Wt=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Wt=!0);else return t.lanes=e.lanes,nn(e,t,i)}return Pu(e,t,r,n,i)}function z1(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(Vi,qt),qt|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Be(Vi,qt),qt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Be(Vi,qt),qt|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Be(Vi,qt),qt|=n;return Pt(e,t,i,r),t.child}function H1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Pu(e,t,r,n,i){var s=Ht(r)?si:Ft.current;return s=is(t,s),Ji(t,i),r=B0(e,t,r,n,s,i),n=U0(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,nn(e,t,i)):(ze&&n&&N0(t),t.flags|=1,Pt(e,t,r,i),t.child)}function bh(e,t,r,n,i){if(Ht(r)){var s=!0;Zo(t)}else s=!1;if(Ji(t,i),t.stateNode===null)Lo(e,t),B1(t,r,n),Ou(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=pr(c):(c=Ht(r)?si:Ft.current,c=is(t,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Ch(t,a,n,c),pn=!1;var f=t.memoizedState;a.state=f,il(t,n,a,i),l=t.memoizedState,o!==n||f!==l||zt.current||pn?(typeof u=="function"&&(Fu(t,r,u,n),l=t.memoizedState),(o=pn||Nh(t,r,o,n,f,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,v1(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:wr(t.type,o),a.props=c,d=t.pendingProps,f=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=pr(l):(l=Ht(r)?si:Ft.current,l=is(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==l)&&Ch(t,a,n,l),pn=!1,f=t.memoizedState,a.state=f,il(t,n,a,i);var v=t.memoizedState;o!==d||f!==v||zt.current||pn?(typeof p=="function"&&(Fu(t,r,p,n),v=t.memoizedState),(c=pn||Nh(t,r,c,n,f,v,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),a.props=n,a.state=v,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Du(e,t,r,n,s,i)}function Du(e,t,r,n,i,s){H1(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&yh(t,r,!1),nn(e,t,s);n=t.stateNode,Gy.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=as(t,e.child,null,s),t.child=as(t,null,o,s)):Pt(e,t,o,s),t.memoizedState=n.state,i&&yh(t,r,!0),t.child}function V1(e){var t=e.stateNode;t.pendingContext?vh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&vh(e,t.context,!1),I0(e,t.containerInfo)}function Ih(e,t,r,n,i){return ss(),F0(i),t.flags|=256,Pt(e,t,r,n),t.child}var bu={dehydrated:null,treeContext:null,retryLane:0};function Iu(e){return{baseLanes:e,cachePool:null,transitions:null}}function G1(e,t,r){var n=t.pendingProps,i=Ge.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Be(Ge,i&1),e===null)return Nu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Wl(a,n,0,null),e=ni(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Iu(r),t.memoizedState=bu,e):z0(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Ky(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=On(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=On(o,s):(s=ni(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?Iu(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=bu,n}return s=e.child,e=s.sibling,n=On(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function z0(e,t){return t=Wl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ho(e,t,r,n){return n!==null&&F0(n),as(t,e.child,null,r),e=z0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ky(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Dc(Error(J(422))),ho(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Wl({mode:"visible",children:n.children},i,0,null),s=ni(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&as(t,e.child,null,a),t.child.memoizedState=Iu(a),t.memoizedState=bu,s);if(!(t.mode&1))return ho(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(J(419)),n=Dc(s,n,void 0),ho(e,t,a,n)}if(o=(a&e.childLanes)!==0,Wt||o){if(n=dt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,rn(e,i),Cr(n,e,i,-1))}return Y0(),n=Dc(Error(J(421))),ho(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=a2.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,er=An(i.nextSibling),tr=t,ze=!0,Tr=null,e!==null&&(cr[ur++]=Xr,cr[ur++]=Yr,cr[ur++]=ai,Xr=e.id,Yr=e.overflow,ai=t),t=z0(t,n.children),t.flags|=4096,t)}function jh(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Cu(e.return,t,r)}function bc(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function K1(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Pt(e,t,n.children,r),n=Ge.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&jh(e,r,t);else if(e.tag===19)jh(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Be(Ge,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&sl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),bc(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&sl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}bc(t,!0,r,null,s);break;case"together":bc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Lo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function nn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),li|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,r=On(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=On(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Xy(e,t,r){switch(t.tag){case 3:V1(t),ss();break;case 5:y1(t);break;case 1:Ht(t.type)&&Zo(t);break;case 4:I0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Be(rl,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Be(Ge,Ge.current&1),t.flags|=128,null):r&t.child.childLanes?G1(e,t,r):(Be(Ge,Ge.current&1),e=nn(e,t,r),e!==null?e.sibling:null);Be(Ge,Ge.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return K1(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Be(Ge,Ge.current),n)break;return null;case 22:case 23:return t.lanes=0,z1(e,t,r)}return nn(e,t,r)}var X1,ju,Y1,q1;X1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ju=function(){};Y1=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ti(Br.current);var s=null;switch(r){case"input":i=iu(e,i),n=iu(e,n),s=[];break;case"select":i=Xe({},i,{value:void 0}),n=Xe({},n,{value:void 0}),s=[];break;case"textarea":i=ou(e,i),n=ou(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Jo)}cu(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ca.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ca.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ue("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};q1=function(e,t,r,n){r!==n&&(t.flags|=4)};function Os(e,t){if(!ze)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function kt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Yy(e,t,r){var n=t.pendingProps;switch(C0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(t),null;case 1:return Ht(t.type)&&Qo(),kt(t),null;case 3:return n=t.stateNode,os(),$e(zt),$e(Ft),L0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(uo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Tr!==null&&(Hu(Tr),Tr=null))),ju(e,t),kt(t),null;case 5:j0(t);var i=ti(wa.current);if(r=t.type,e!==null&&t.stateNode!=null)Y1(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(J(166));return kt(t),null}if(e=ti(Br.current),uo(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Lr]=t,n[ya]=s,e=(t.mode&1)!==0,r){case"dialog":Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":case"embed":Ue("load",n);break;case"video":case"audio":for(i=0;i<Bs.length;i++)Ue(Bs[i],n);break;case"source":Ue("error",n);break;case"img":case"image":case"link":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"input":Vf(n,s),Ue("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ue("invalid",n);break;case"textarea":Kf(n,s),Ue("invalid",n)}cu(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&co(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&co(n.textContent,o,e),i=["children",""+o]):ca.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ue("scroll",n)}switch(r){case"input":to(n),Gf(n,s,!0);break;case"textarea":to(n),Xf(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Jo)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Tp(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Lr]=t,e[ya]=n,X1(e,t,!1,!1),t.stateNode=e;e:{switch(a=uu(r,n),r){case"dialog":Ue("cancel",e),Ue("close",e),i=n;break;case"iframe":case"object":case"embed":Ue("load",e),i=n;break;case"video":case"audio":for(i=0;i<Bs.length;i++)Ue(Bs[i],e);i=n;break;case"source":Ue("error",e),i=n;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),i=n;break;case"details":Ue("toggle",e),i=n;break;case"input":Vf(e,n),i=iu(e,n),Ue("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Xe({},n,{value:void 0}),Ue("invalid",e);break;case"textarea":Kf(e,n),i=ou(e,n),Ue("invalid",e);break;default:i=n}cu(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Np(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&kp(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ua(e,l):typeof l=="number"&&ua(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ca.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ue("scroll",e):l!=null&&d0(e,s,l,a))}switch(r){case"input":to(e),Gf(e,n,!1);break;case"textarea":to(e),Xf(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Rn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Ki(e,!!n.multiple,s,!1):n.defaultValue!=null&&Ki(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Jo)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return kt(t),null;case 6:if(e&&t.stateNode!=null)q1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(J(166));if(r=ti(wa.current),ti(Br.current),uo(t)){if(n=t.stateNode,r=t.memoizedProps,n[Lr]=t,(s=n.nodeValue!==r)&&(e=tr,e!==null))switch(e.tag){case 3:co(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&co(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Lr]=t,t.stateNode=n}return kt(t),null;case 13:if($e(Ge),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ze&&er!==null&&t.mode&1&&!(t.flags&128))p1(),ss(),t.flags|=98560,s=!1;else if(s=uo(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(J(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(J(317));s[Lr]=t}else ss(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;kt(t),s=!1}else Tr!==null&&(Hu(Tr),Tr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ge.current&1?lt===0&&(lt=3):Y0())),t.updateQueue!==null&&(t.flags|=4),kt(t),null);case 4:return os(),ju(e,t),e===null&&xa(t.stateNode.containerInfo),kt(t),null;case 10:return P0(t.type._context),kt(t),null;case 17:return Ht(t.type)&&Qo(),kt(t),null;case 19:if($e(Ge),s=t.memoizedState,s===null)return kt(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Os(s,!1);else{if(lt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=sl(e),a!==null){for(t.flags|=128,Os(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Be(Ge,Ge.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ze()>cs&&(t.flags|=128,n=!0,Os(s,!1),t.lanes=4194304)}else{if(!n)if(e=sl(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Os(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!ze)return kt(t),null}else 2*Ze()-s.renderingStartTime>cs&&r!==1073741824&&(t.flags|=128,n=!0,Os(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ze(),t.sibling=null,r=Ge.current,Be(Ge,n?r&1|2:r&1),t):(kt(t),null);case 22:case 23:return X0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?qt&1073741824&&(kt(t),t.subtreeFlags&6&&(t.flags|=8192)):kt(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function qy(e,t){switch(C0(t),t.tag){case 1:return Ht(t.type)&&Qo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return os(),$e(zt),$e(Ft),L0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return j0(t),null;case 13:if($e(Ge),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));ss()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $e(Ge),null;case 4:return os(),null;case 10:return P0(t.type._context),null;case 22:case 23:return X0(),null;case 24:return null;default:return null}}var po=!1,At=!1,Jy=typeof WeakSet=="function"?WeakSet:Set,he=null;function Hi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){qe(e,t,n)}else r.current=null}function Lu(e,t,r){try{r()}catch(n){qe(e,t,n)}}var Lh=!1;function Qy(e,t){if(_u=Xo,e=t1(),A0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,d=e,f=null;t:for(;;){for(var p;d!==r||i!==0&&d.nodeType!==3||(o=a+i),d!==s||n!==0&&d.nodeType!==3||(l=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===e)break t;if(f===r&&++c===i&&(o=a),f===s&&++u===n&&(l=a),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(wu={focusedElem:e,selectionRange:r},Xo=!1,he=t;he!==null;)if(t=he,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,he=e;else for(;he!==null;){t=he;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,w=v.memoizedState,g=t.stateNode,x=g.getSnapshotBeforeUpdate(t.elementType===t.type?m:wr(t.type,m),w);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(k){qe(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,he=e;break}he=t.return}return v=Lh,Lh=!1,v}function Ys(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Lu(t,r,s)}i=i.next}while(i!==n)}}function Ul(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Mu(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function J1(e){var t=e.alternate;t!==null&&(e.alternate=null,J1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Lr],delete t[ya],delete t[Tu],delete t[by],delete t[Iy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Q1(e){return e.tag===5||e.tag===3||e.tag===4}function Mh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Q1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Bu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Jo));else if(n!==4&&(e=e.child,e!==null))for(Bu(e,t,r),e=e.sibling;e!==null;)Bu(e,t,r),e=e.sibling}function Uu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Uu(e,t,r),e=e.sibling;e!==null;)Uu(e,t,r),e=e.sibling}var mt=null,Er=!1;function cn(e,t,r){for(r=r.child;r!==null;)Z1(e,t,r),r=r.sibling}function Z1(e,t,r){if(Mr&&typeof Mr.onCommitFiberUnmount=="function")try{Mr.onCommitFiberUnmount(Pl,r)}catch{}switch(r.tag){case 5:At||Hi(r,t);case 6:var n=mt,i=Er;mt=null,cn(e,t,r),mt=n,Er=i,mt!==null&&(Er?(e=mt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):mt.removeChild(r.stateNode));break;case 18:mt!==null&&(Er?(e=mt,r=r.stateNode,e.nodeType===8?Nc(e.parentNode,r):e.nodeType===1&&Nc(e,r),pa(e)):Nc(mt,r.stateNode));break;case 4:n=mt,i=Er,mt=r.stateNode.containerInfo,Er=!0,cn(e,t,r),mt=n,Er=i;break;case 0:case 11:case 14:case 15:if(!At&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Lu(r,t,a),i=i.next}while(i!==n)}cn(e,t,r);break;case 1:if(!At&&(Hi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){qe(r,t,o)}cn(e,t,r);break;case 21:cn(e,t,r);break;case 22:r.mode&1?(At=(n=At)||r.memoizedState!==null,cn(e,t,r),At=n):cn(e,t,r);break;default:cn(e,t,r)}}function Bh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Jy),t.forEach(function(n){var i=o2.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function xr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:mt=o.stateNode,Er=!1;break e;case 3:mt=o.stateNode.containerInfo,Er=!0;break e;case 4:mt=o.stateNode.containerInfo,Er=!0;break e}o=o.return}if(mt===null)throw Error(J(160));Z1(s,a,i),mt=null,Er=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){qe(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)em(t,e),t=t.sibling}function em(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xr(t,e),Pr(e),n&4){try{Ys(3,e,e.return),Ul(3,e)}catch(m){qe(e,e.return,m)}try{Ys(5,e,e.return)}catch(m){qe(e,e.return,m)}}break;case 1:xr(t,e),Pr(e),n&512&&r!==null&&Hi(r,r.return);break;case 5:if(xr(t,e),Pr(e),n&512&&r!==null&&Hi(r,r.return),e.flags&32){var i=e.stateNode;try{ua(i,"")}catch(m){qe(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Ep(i,s),uu(o,a);var c=uu(o,s);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?Np(i,d):u==="dangerouslySetInnerHTML"?kp(i,d):u==="children"?ua(i,d):d0(i,u,d,c)}switch(o){case"input":su(i,s);break;case"textarea":Sp(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Ki(i,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?Ki(i,!!s.multiple,s.defaultValue,!0):Ki(i,!!s.multiple,s.multiple?[]:"",!1))}i[ya]=s}catch(m){qe(e,e.return,m)}}break;case 6:if(xr(t,e),Pr(e),n&4){if(e.stateNode===null)throw Error(J(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){qe(e,e.return,m)}}break;case 3:if(xr(t,e),Pr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{pa(t.containerInfo)}catch(m){qe(e,e.return,m)}break;case 4:xr(t,e),Pr(e);break;case 13:xr(t,e),Pr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(G0=Ze())),n&4&&Bh(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(At=(c=At)||u,xr(t,e),At=c):xr(t,e),Pr(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(he=e,u=e.child;u!==null;){for(d=he=u;he!==null;){switch(f=he,p=f.child,f.tag){case 0:case 11:case 14:case 15:Ys(4,f,f.return);break;case 1:Hi(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){qe(n,r,m)}}break;case 5:Hi(f,f.return);break;case 22:if(f.memoizedState!==null){$h(d);continue}}p!==null?(p.return=f,he=p):$h(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Ap("display",a))}catch(m){qe(e,e.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){qe(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:xr(t,e),Pr(e),n&4&&Bh(e);break;case 21:break;default:xr(t,e),Pr(e)}}function Pr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Q1(r)){var n=r;break e}r=r.return}throw Error(J(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ua(i,""),n.flags&=-33);var s=Mh(e);Uu(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Mh(e);Bu(e,o,a);break;default:throw Error(J(161))}}catch(l){qe(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Zy(e,t,r){he=e,tm(e)}function tm(e,t,r){for(var n=(e.mode&1)!==0;he!==null;){var i=he,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||po;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||At;o=po;var c=At;if(po=a,(At=l)&&!c)for(he=i;he!==null;)a=he,l=a.child,a.tag===22&&a.memoizedState!==null?Wh(i):l!==null?(l.return=a,he=l):Wh(i);for(;s!==null;)he=s,tm(s),s=s.sibling;he=i,po=o,At=c}Uh(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,he=s):Uh(e)}}function Uh(e){for(;he!==null;){var t=he;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:At||Ul(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!At)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:wr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Th(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Th(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&pa(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}At||t.flags&512&&Mu(t)}catch(f){qe(t,t.return,f)}}if(t===e){he=null;break}if(r=t.sibling,r!==null){r.return=t.return,he=r;break}he=t.return}}function $h(e){for(;he!==null;){var t=he;if(t===e){he=null;break}var r=t.sibling;if(r!==null){r.return=t.return,he=r;break}he=t.return}}function Wh(e){for(;he!==null;){var t=he;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ul(4,t)}catch(l){qe(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){qe(t,i,l)}}var s=t.return;try{Mu(t)}catch(l){qe(t,s,l)}break;case 5:var a=t.return;try{Mu(t)}catch(l){qe(t,a,l)}}}catch(l){qe(t,t.return,l)}if(t===e){he=null;break}var o=t.sibling;if(o!==null){o.return=t.return,he=o;break}he=t.return}}var e2=Math.ceil,ll=on.ReactCurrentDispatcher,H0=on.ReactCurrentOwner,hr=on.ReactCurrentBatchConfig,Te=0,dt=null,tt=null,yt=0,qt=0,Vi=Ln(0),lt=0,ka=null,li=0,$l=0,V0=0,qs=null,Ut=null,G0=0,cs=1/0,Vr=null,cl=!1,$u=null,Cn=null,mo=!1,yn=null,ul=0,Js=0,Wu=null,Mo=-1,Bo=0;function It(){return Te&6?Ze():Mo!==-1?Mo:Mo=Ze()}function Fn(e){return e.mode&1?Te&2&&yt!==0?yt&-yt:Ly.transition!==null?(Bo===0&&(Bo=Bp()),Bo):(e=be,e!==0||(e=window.event,e=e===void 0?16:Gp(e.type)),e):1}function Cr(e,t,r,n){if(50<Js)throw Js=0,Wu=null,Error(J(185));ja(e,r,n),(!(Te&2)||e!==dt)&&(e===dt&&(!(Te&2)&&($l|=r),lt===4&&gn(e,yt)),Vt(e,n),r===1&&Te===0&&!(t.mode&1)&&(cs=Ze()+500,Ll&&Mn()))}function Vt(e,t){var r=e.callbackNode;Lv(e,t);var n=Ko(e,e===dt?yt:0);if(n===0)r!==null&&Jf(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Jf(r),t===1)e.tag===0?jy(zh.bind(null,e)):f1(zh.bind(null,e)),Py(function(){!(Te&6)&&Mn()}),r=null;else{switch(Up(n)){case 1:r=v0;break;case 4:r=Lp;break;case 16:r=Go;break;case 536870912:r=Mp;break;default:r=Go}r=cm(r,rm.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function rm(e,t){if(Mo=-1,Bo=0,Te&6)throw Error(J(327));var r=e.callbackNode;if(Qi()&&e.callbackNode!==r)return null;var n=Ko(e,e===dt?yt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=fl(e,n);else{t=n;var i=Te;Te|=2;var s=im();(dt!==e||yt!==t)&&(Vr=null,cs=Ze()+500,ri(e,t));do try{n2();break}catch(o){nm(e,o)}while(!0);R0(),ll.current=s,Te=i,tt!==null?t=0:(dt=null,yt=0,t=lt)}if(t!==0){if(t===2&&(i=mu(e),i!==0&&(n=i,t=zu(e,i))),t===1)throw r=ka,ri(e,0),gn(e,n),Vt(e,Ze()),r;if(t===6)gn(e,n);else{if(i=e.current.alternate,!(n&30)&&!t2(i)&&(t=fl(e,n),t===2&&(s=mu(e),s!==0&&(n=s,t=zu(e,s))),t===1))throw r=ka,ri(e,0),gn(e,n),Vt(e,Ze()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(J(345));case 2:Xn(e,Ut,Vr);break;case 3:if(gn(e,n),(n&130023424)===n&&(t=G0+500-Ze(),10<t)){if(Ko(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){It(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Su(Xn.bind(null,e,Ut,Vr),t);break}Xn(e,Ut,Vr);break;case 4:if(gn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Nr(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Ze()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*e2(n/1960))-n,10<n){e.timeoutHandle=Su(Xn.bind(null,e,Ut,Vr),n);break}Xn(e,Ut,Vr);break;case 5:Xn(e,Ut,Vr);break;default:throw Error(J(329))}}}return Vt(e,Ze()),e.callbackNode===r?rm.bind(null,e):null}function zu(e,t){var r=qs;return e.current.memoizedState.isDehydrated&&(ri(e,t).flags|=256),e=fl(e,t),e!==2&&(t=Ut,Ut=r,t!==null&&Hu(t)),e}function Hu(e){Ut===null?Ut=e:Ut.push.apply(Ut,e)}function t2(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Or(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function gn(e,t){for(t&=~V0,t&=~$l,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Nr(t),n=1<<r;e[r]=-1,t&=~n}}function zh(e){if(Te&6)throw Error(J(327));Qi();var t=Ko(e,0);if(!(t&1))return Vt(e,Ze()),null;var r=fl(e,t);if(e.tag!==0&&r===2){var n=mu(e);n!==0&&(t=n,r=zu(e,n))}if(r===1)throw r=ka,ri(e,0),gn(e,t),Vt(e,Ze()),r;if(r===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xn(e,Ut,Vr),Vt(e,Ze()),null}function K0(e,t){var r=Te;Te|=1;try{return e(t)}finally{Te=r,Te===0&&(cs=Ze()+500,Ll&&Mn())}}function ci(e){yn!==null&&yn.tag===0&&!(Te&6)&&Qi();var t=Te;Te|=1;var r=hr.transition,n=be;try{if(hr.transition=null,be=1,e)return e()}finally{be=n,hr.transition=r,Te=t,!(Te&6)&&Mn()}}function X0(){qt=Vi.current,$e(Vi)}function ri(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Ry(r)),tt!==null)for(r=tt.return;r!==null;){var n=r;switch(C0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Qo();break;case 3:os(),$e(zt),$e(Ft),L0();break;case 5:j0(n);break;case 4:os();break;case 13:$e(Ge);break;case 19:$e(Ge);break;case 10:P0(n.type._context);break;case 22:case 23:X0()}r=r.return}if(dt=e,tt=e=On(e.current,null),yt=qt=t,lt=0,ka=null,V0=$l=li=0,Ut=qs=null,ei!==null){for(t=0;t<ei.length;t++)if(r=ei[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ei=null}return e}function nm(e,t){do{var r=tt;try{if(R0(),Io.current=ol,al){for(var n=Ke.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}al=!1}if(oi=0,ct=ot=Ke=null,Xs=!1,Ea=0,H0.current=null,r===null||r.return===null){lt=1,ka=t,tt=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=yt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Oh(a);if(p!==null){p.flags&=-257,Rh(p,a,o,s,t),p.mode&1&&Fh(s,c,t),t=p,l=c;var v=t.updateQueue;if(v===null){var m=new Set;m.add(l),t.updateQueue=m}else v.add(l);break e}else{if(!(t&1)){Fh(s,c,t),Y0();break e}l=Error(J(426))}}else if(ze&&o.mode&1){var w=Oh(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Rh(w,a,o,s,t),F0(ls(l,o));break e}}s=l=ls(l,o),lt!==4&&(lt=2),qs===null?qs=[s]:qs.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=U1(s,l,t);Sh(s,g);break e;case 1:o=l;var x=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Cn===null||!Cn.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var k=$1(s,o,t);Sh(s,k);break e}}s=s.return}while(s!==null)}am(r)}catch(D){t=D,tt===r&&r!==null&&(tt=r=r.return);continue}break}while(!0)}function im(){var e=ll.current;return ll.current=ol,e===null?ol:e}function Y0(){(lt===0||lt===3||lt===2)&&(lt=4),dt===null||!(li&268435455)&&!($l&268435455)||gn(dt,yt)}function fl(e,t){var r=Te;Te|=2;var n=im();(dt!==e||yt!==t)&&(Vr=null,ri(e,t));do try{r2();break}catch(i){nm(e,i)}while(!0);if(R0(),Te=r,ll.current=n,tt!==null)throw Error(J(261));return dt=null,yt=0,lt}function r2(){for(;tt!==null;)sm(tt)}function n2(){for(;tt!==null&&!Cv();)sm(tt)}function sm(e){var t=lm(e.alternate,e,qt);e.memoizedProps=e.pendingProps,t===null?am(e):tt=t,H0.current=null}function am(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=qy(r,t),r!==null){r.flags&=32767,tt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{lt=6,tt=null;return}}else if(r=Yy(r,t,qt),r!==null){tt=r;return}if(t=t.sibling,t!==null){tt=t;return}tt=t=e}while(t!==null);lt===0&&(lt=5)}function Xn(e,t,r){var n=be,i=hr.transition;try{hr.transition=null,be=1,i2(e,t,r,n)}finally{hr.transition=i,be=n}return null}function i2(e,t,r,n){do Qi();while(yn!==null);if(Te&6)throw Error(J(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(Mv(e,s),e===dt&&(tt=dt=null,yt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||mo||(mo=!0,cm(Go,function(){return Qi(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=hr.transition,hr.transition=null;var a=be;be=1;var o=Te;Te|=4,H0.current=null,Qy(e,r),em(r,e),Ty(wu),Xo=!!_u,wu=_u=null,e.current=r,Zy(r),Fv(),Te=o,be=a,hr.transition=s}else e.current=r;if(mo&&(mo=!1,yn=e,ul=i),s=e.pendingLanes,s===0&&(Cn=null),Pv(r.stateNode),Vt(e,Ze()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(cl)throw cl=!1,e=$u,$u=null,e;return ul&1&&e.tag!==0&&Qi(),s=e.pendingLanes,s&1?e===Wu?Js++:(Js=0,Wu=e):Js=0,Mn(),null}function Qi(){if(yn!==null){var e=Up(ul),t=hr.transition,r=be;try{if(hr.transition=null,be=16>e?16:e,yn===null)var n=!1;else{if(e=yn,yn=null,ul=0,Te&6)throw Error(J(331));var i=Te;for(Te|=4,he=e.current;he!==null;){var s=he,a=s.child;if(he.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(he=c;he!==null;){var u=he;switch(u.tag){case 0:case 11:case 15:Ys(8,u,s)}var d=u.child;if(d!==null)d.return=u,he=d;else for(;he!==null;){u=he;var f=u.sibling,p=u.return;if(J1(u),u===c){he=null;break}if(f!==null){f.return=p,he=f;break}he=p}}}var v=s.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}he=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,he=a;else e:for(;he!==null;){if(s=he,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ys(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,he=g;break e}he=s.return}}var x=e.current;for(he=x;he!==null;){a=he;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,he=y;else e:for(a=x;he!==null;){if(o=he,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ul(9,o)}}catch(D){qe(o,o.return,D)}if(o===a){he=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,he=k;break e}he=o.return}}if(Te=i,Mn(),Mr&&typeof Mr.onPostCommitFiberRoot=="function")try{Mr.onPostCommitFiberRoot(Pl,e)}catch{}n=!0}return n}finally{be=r,hr.transition=t}}return!1}function Hh(e,t,r){t=ls(r,t),t=U1(e,t,1),e=Nn(e,t,1),t=It(),e!==null&&(ja(e,1,t),Vt(e,t))}function qe(e,t,r){if(e.tag===3)Hh(e,e,r);else for(;t!==null;){if(t.tag===3){Hh(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Cn===null||!Cn.has(n))){e=ls(r,e),e=$1(t,e,1),t=Nn(t,e,1),e=It(),t!==null&&(ja(t,1,e),Vt(t,e));break}}t=t.return}}function s2(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=It(),e.pingedLanes|=e.suspendedLanes&r,dt===e&&(yt&r)===r&&(lt===4||lt===3&&(yt&130023424)===yt&&500>Ze()-G0?ri(e,0):V0|=r),Vt(e,t)}function om(e,t){t===0&&(e.mode&1?(t=io,io<<=1,!(io&130023424)&&(io=4194304)):t=1);var r=It();e=rn(e,t),e!==null&&(ja(e,t,r),Vt(e,r))}function a2(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),om(e,r)}function o2(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(J(314))}n!==null&&n.delete(t),om(e,r)}var lm;lm=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||zt.current)Wt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Wt=!1,Xy(e,t,r);Wt=!!(e.flags&131072)}else Wt=!1,ze&&t.flags&1048576&&h1(t,tl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Lo(e,t),e=t.pendingProps;var i=is(t,Ft.current);Ji(t,r),i=B0(null,t,n,e,i,r);var s=U0();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ht(n)?(s=!0,Zo(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,b0(t),i.updater=Bl,t.stateNode=i,i._reactInternals=t,Ou(t,n,e,r),t=Du(null,t,n,!0,s,r)):(t.tag=0,ze&&s&&N0(t),Pt(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Lo(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=c2(n),e=wr(n,e),i){case 0:t=Pu(null,t,n,e,r);break e;case 1:t=bh(null,t,n,e,r);break e;case 11:t=Ph(null,t,n,e,r);break e;case 14:t=Dh(null,t,n,wr(n.type,e),r);break e}throw Error(J(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:wr(n,i),Pu(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:wr(n,i),bh(e,t,n,i,r);case 3:e:{if(V1(t),e===null)throw Error(J(387));n=t.pendingProps,s=t.memoizedState,i=s.element,v1(e,t),il(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=ls(Error(J(423)),t),t=Ih(e,t,n,r,i);break e}else if(n!==i){i=ls(Error(J(424)),t),t=Ih(e,t,n,r,i);break e}else for(er=An(t.stateNode.containerInfo.firstChild),tr=t,ze=!0,Tr=null,r=g1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ss(),n===i){t=nn(e,t,r);break e}Pt(e,t,n,r)}t=t.child}return t;case 5:return y1(t),e===null&&Nu(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Eu(n,i)?a=null:s!==null&&Eu(n,s)&&(t.flags|=32),H1(e,t),Pt(e,t,a,r),t.child;case 6:return e===null&&Nu(t),null;case 13:return G1(e,t,r);case 4:return I0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=as(t,null,n,r):Pt(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:wr(n,i),Ph(e,t,n,i,r);case 7:return Pt(e,t,t.pendingProps,r),t.child;case 8:return Pt(e,t,t.pendingProps.children,r),t.child;case 12:return Pt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Be(rl,n._currentValue),n._currentValue=a,s!==null)if(Or(s.value,a)){if(s.children===i.children&&!zt.current){t=nn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=qr(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Cu(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(J(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Cu(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Pt(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ji(t,r),i=pr(i),n=n(i),t.flags|=1,Pt(e,t,n,r),t.child;case 14:return n=t.type,i=wr(n,t.pendingProps),i=wr(n.type,i),Dh(e,t,n,i,r);case 15:return W1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:wr(n,i),Lo(e,t),t.tag=1,Ht(n)?(e=!0,Zo(t)):e=!1,Ji(t,r),B1(t,n,i),Ou(t,n,i,r),Du(null,t,n,!0,e,r);case 19:return K1(e,t,r);case 22:return z1(e,t,r)}throw Error(J(156,t.tag))};function cm(e,t){return jp(e,t)}function l2(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(e,t,r,n){return new l2(e,t,r,n)}function q0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function c2(e){if(typeof e=="function")return q0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===m0)return 11;if(e===g0)return 14}return 2}function On(e,t){var r=e.alternate;return r===null?(r=fr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Uo(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")q0(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Ii:return ni(r.children,i,s,t);case p0:a=8,i|=8;break;case eu:return e=fr(12,r,t,i|2),e.elementType=eu,e.lanes=s,e;case tu:return e=fr(13,r,t,i),e.elementType=tu,e.lanes=s,e;case ru:return e=fr(19,r,t,i),e.elementType=ru,e.lanes=s,e;case yp:return Wl(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case xp:a=10;break e;case vp:a=9;break e;case m0:a=11;break e;case g0:a=14;break e;case dn:a=16,n=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=fr(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function ni(e,t,r,n){return e=fr(7,e,n,t),e.lanes=r,e}function Wl(e,t,r,n){return e=fr(22,e,n,t),e.elementType=yp,e.lanes=r,e.stateNode={isHidden:!1},e}function Ic(e,t,r){return e=fr(6,e,null,t),e.lanes=r,e}function jc(e,t,r){return t=fr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function u2(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gc(0),this.expirationTimes=gc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gc(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function J0(e,t,r,n,i,s,a,o,l){return e=new u2(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=fr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},b0(s),e}function f2(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function um(e){if(!e)return Pn;e=e._reactInternals;e:{if(pi(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var r=e.type;if(Ht(r))return u1(e,r,t)}return t}function fm(e,t,r,n,i,s,a,o,l){return e=J0(r,n,!0,e,i,s,a,o,l),e.context=um(null),r=e.current,n=It(),i=Fn(r),s=qr(n,i),s.callback=t??null,Nn(r,s,i),e.current.lanes=i,ja(e,i,n),Vt(e,n),e}function zl(e,t,r,n){var i=t.current,s=It(),a=Fn(i);return r=um(r),t.context===null?t.context=r:t.pendingContext=r,t=qr(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Nn(i,t,a),e!==null&&(Cr(e,i,a,s),bo(e,i,a)),a}function hl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Q0(e,t){Vh(e,t),(e=e.alternate)&&Vh(e,t)}function h2(){return null}var hm=typeof reportError=="function"?reportError:function(e){console.error(e)};function Z0(e){this._internalRoot=e}Hl.prototype.render=Z0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));zl(e,t,null,null)};Hl.prototype.unmount=Z0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ci(function(){zl(null,e,null,null)}),t[tn]=null}};function Hl(e){this._internalRoot=e}Hl.prototype.unstable_scheduleHydration=function(e){if(e){var t=zp();e={blockedOn:null,target:e,priority:t};for(var r=0;r<mn.length&&t!==0&&t<mn[r].priority;r++);mn.splice(r,0,e),r===0&&Vp(e)}};function ef(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Gh(){}function d2(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=hl(a);s.call(c)}}var a=fm(t,n,e,0,null,!1,!1,"",Gh);return e._reactRootContainer=a,e[tn]=a.current,xa(e.nodeType===8?e.parentNode:e),ci(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=hl(l);o.call(c)}}var l=J0(e,0,!1,null,null,!1,!1,"",Gh);return e._reactRootContainer=l,e[tn]=l.current,xa(e.nodeType===8?e.parentNode:e),ci(function(){zl(t,l,r,n)}),l}function Gl(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=hl(a);o.call(l)}}zl(t,a,e,i)}else a=d2(r,t,e,i,n);return hl(a)}$p=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ms(t.pendingLanes);r!==0&&(y0(t,r|1),Vt(t,Ze()),!(Te&6)&&(cs=Ze()+500,Mn()))}break;case 13:ci(function(){var n=rn(e,1);if(n!==null){var i=It();Cr(n,e,1,i)}}),Q0(e,1)}};_0=function(e){if(e.tag===13){var t=rn(e,134217728);if(t!==null){var r=It();Cr(t,e,134217728,r)}Q0(e,134217728)}};Wp=function(e){if(e.tag===13){var t=Fn(e),r=rn(e,t);if(r!==null){var n=It();Cr(r,e,t,n)}Q0(e,t)}};zp=function(){return be};Hp=function(e,t){var r=be;try{return be=e,t()}finally{be=r}};hu=function(e,t,r){switch(t){case"input":if(su(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=jl(n);if(!i)throw Error(J(90));wp(n),su(n,i)}}}break;case"textarea":Sp(e,r);break;case"select":t=r.value,t!=null&&Ki(e,!!r.multiple,t,!1)}};Op=K0;Rp=ci;var p2={usingClientEntryPoint:!1,Events:[Ma,Bi,jl,Cp,Fp,K0]},Rs={findFiberByHostInstance:Zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},m2={bundleType:Rs.bundleType,version:Rs.version,rendererPackageName:Rs.rendererPackageName,rendererConfig:Rs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:on.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bp(e),e===null?null:e.stateNode},findFiberByHostInstance:Rs.findFiberByHostInstance||h2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var go=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!go.isDisabled&&go.supportsFiber)try{Pl=go.inject(m2),Mr=go}catch{}}ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p2;ir.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ef(t))throw Error(J(200));return f2(e,t,null,r)};ir.createRoot=function(e,t){if(!ef(e))throw Error(J(299));var r=!1,n="",i=hm;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=J0(e,1,!1,null,null,r,!1,n,i),e[tn]=t.current,xa(e.nodeType===8?e.parentNode:e),new Z0(t)};ir.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=bp(t),e=e===null?null:e.stateNode,e};ir.flushSync=function(e){return ci(e)};ir.hydrate=function(e,t,r){if(!Vl(t))throw Error(J(200));return Gl(null,e,t,!0,r)};ir.hydrateRoot=function(e,t,r){if(!ef(e))throw Error(J(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=hm;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=fm(t,null,e,1,r??null,i,!1,s,a),e[tn]=t.current,xa(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Hl(t)};ir.render=function(e,t,r){if(!Vl(t))throw Error(J(200));return Gl(null,e,t,!1,r)};ir.unmountComponentAtNode=function(e){if(!Vl(e))throw Error(J(40));return e._reactRootContainer?(ci(function(){Gl(null,null,e,!1,function(){e._reactRootContainer=null,e[tn]=null})}),!0):!1};ir.unstable_batchedUpdates=K0;ir.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Vl(r))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return Gl(e,t,r,!1,n)};ir.version="18.3.1-next-f1338f8080-20240426";function dm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dm)}catch(e){console.error(e)}}dm(),dp.exports=ir;var g2=dp.exports,pm,Kh=g2;pm=Kh.createRoot,Kh.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var x2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Oe=(e,t)=>{const r=Fe.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},u)=>Fe.createElement("svg",{ref:u,...x2,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${v2(e)}`,o].join(" "),...c},[...t.map(([d,f])=>Fe.createElement(d,f)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=Oe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=Oe("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=Oe("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tf=Oe("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=Oe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Oe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=Oe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=Oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=Oe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=Oe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=Oe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Oe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mm=Oe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=Oe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=Oe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=Oe("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=Oe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=Oe("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=Oe("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=Oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=Oe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ym=Oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=Oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _m=Oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=Oe("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=Oe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=Oe("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=Oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=Oe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=Oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),O2=({currentSection:e,onMenuToggle:t})=>h.jsx("header",{className:"bg-white shadow-sm border-b border-pink-100",children:h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"flex justify-between items-center h-16",children:[h.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-pink-500",children:h.jsx(S2,{className:"w-6 h-6"})}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-r from-[#FE4066] to-pink-500 rounded-lg",children:h.jsx(E2,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{className:"hidden sm:block",children:[h.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent",children:"GoGo"}),h.jsx("p",{className:"text-xs text-gray-500 -mt-1",children:"Expense Tracker"})]})]}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("div",{className:"text-right hidden sm:block",children:[h.jsx("p",{className:"text-sm font-medium text-gray-900",children:e}),h.jsx("p",{className:"text-xs text-gray-500",children:"Welcome back!"})]}),h.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-[#FE4066] to-pink-400 rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-white text-sm font-medium",children:"G"})})]})]})})}),R2=({activeSection:e,onSectionChange:t,isOpen:r,onClose:n})=>{const i=[{id:"dashboard",name:"Dashboard",icon:_2},{id:"create",name:"Add Expense",icon:vm},{id:"create-funding",name:"Add Funding",icon:k2},{id:"manage",name:"Manage Expense",icon:N2},{id:"funding",name:"Manage Funding",icon:tf},{id:"reports",name:"Reports",icon:$a},{id:"reminders",name:"Reminders",icon:Us}],s=a=>{t(a),n&&n()};return h.jsxs(h.Fragment,{children:[r&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:n}),h.jsx("nav",{className:`
        bg-white shadow-sm border-r border-pink-100 min-h-screen w-64 
        fixed lg:static inset-y-0 left-0 z-50 transform transition-transform duration-300 ease-in-out
        ${r?"translate-x-0":"-translate-x-full lg:translate-x-0"}
      `,children:h.jsxs("div",{className:"p-4",children:[h.jsx("div",{className:"flex justify-end lg:hidden mb-4",children:h.jsxs("button",{onClick:n,className:"p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:[h.jsx("span",{className:"sr-only",children:"Close menu"}),h.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})}),h.jsx("ul",{className:"space-y-2",children:i.map(a=>{const o=a.icon,l=e===a.id;return h.jsx("li",{children:h.jsxs("button",{onClick:()=>s(a.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-200 ${l?"bg-gradient-to-r from-[#FE4066] to-pink-500 text-white shadow-lg":"text-gray-700 hover:bg-pink-50 hover:text-[#FE4066]"}`,children:[h.jsx(o,{className:`w-5 h-5 ${l?"text-white":"text-gray-500"}`}),h.jsx("span",{className:"font-medium",children:a.name})]})},a.id)})})]})})]})},_n=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Ae=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),wm=e=>{const t=new Date;return new Date(e)<t},Zs=e=>{const t=new Date,n=new Date(e).getTime()-t.getTime();return Math.ceil(n/(1e3*60*60*24))},Wo=(e,t,r)=>{const n=new Date;let i,s=n;switch(e){case"weekly":i=new Date(n.getTime()-7*24*60*60*1e3);break;case"monthly":i=new Date(n.getFullYear(),n.getMonth(),1);break;case"yearly":i=new Date(n.getFullYear(),0,1);break;case"custom":i=t?new Date(t):new Date(n.getFullYear(),n.getMonth(),1),s=r?new Date(r):n;break;default:i=new Date(n.getFullYear(),n.getMonth(),1)}return{start:i,end:s}},Jh=e=>["January","February","March","April","May","June","July","August","September","October","November","December"][e]||"Invalid Month";/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ml={};ml.version="0.18.5";var Em=1252,P2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sm=function(e){P2.indexOf(e)!=-1&&(Em=e)};function D2(){Sm(1252)}var Na=function(e){Sm(e)};function b2(){Na(1200),D2()}var xo=function(t){return String.fromCharCode(t)},Qh=function(t){return String.fromCharCode(t)},qn,wn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ca(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=wn.charAt(s)+wn.charAt(a)+wn.charAt(o)+wn.charAt(l);return t}function sn(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=wn.indexOf(e.charAt(c++)),a=wn.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=wn.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=wn.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Ne=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ln=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ui(e){return Ne?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Zh(e){return Ne?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var kr=function(t){return Ne?ln(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Kl(e){if(typeof ArrayBuffer>"u")return kr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Wa(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function I2(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var xt=Ne?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ln(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function j2(e){for(var t=[],r=0,n=e.length+250,i=ui(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=ui(65535),n=65530)}return t.push(i.slice(0,r)),xt(t)}var ea=/\u0000/g,vo=/[\u0001-\u0006]/g;function Zi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ar(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}function rf(e,t){var r=""+e;return r.length>=t?r:Je(" ",t-r.length)+r}function gl(e,t){var r=""+e;return r.length>=t?r:r+Je(" ",t-r.length)}function L2(e,t){var r=""+Math.round(e);return r.length>=t?r:Je("0",t-r.length)+r}function M2(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}var ed=Math.pow(2,32);function Si(e,t){if(e>ed||e<-ed)return L2(e,t);var r=Math.round(e);return M2(r,t)}function xl(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var td=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function B2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},rd={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},U2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vl(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,d=Math.floor(i);c<t&&(d=Math.floor(i),o=d*a+s,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var f=Math.floor(n*o/u);return[f,n*o-f*u,u]}function yo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=K2(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Tm=new Date(1899,11,31,0,0,0),$2=Tm.getTime(),W2=new Date(1900,2,1,0,0,0);function km(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=W2&&(r+=24*60*60*1e3),(r-($2+(e.getTimezoneOffset()-Tm.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function nf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function z2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function H2(e){var t=e<0?12:11,r=nf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function V2(e){var t=nf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function G2(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=H2(e):t===10?r=e.toFixed(10).substr(0,12):r=V2(e),nf(z2(r.toUpperCase()))}function Gu(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):G2(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Dn(14,km(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function K2(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function X2(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Lc[r.m-1][1];case 5:return Lc[r.m-1][0];default:return Lc[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return td[r.q][0];default:return td[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ar(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Ar(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Ar(l,c):"";return u}function En(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Am=/%/g;function Y2(e,t,r){var n=t.replace(Am,""),i=t.length-n.length;return Jr(e,n,r*Math.pow(10,2*i))+Je("%",i)}function q2(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Jr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Nm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Nm(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Cm=/# (\?+)( ?)\/( ?)(\d+)/;function J2(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Je(" ",e[1].length+1+e[4].length):rf(a,e[1].length)+e[2]+"/"+e[3]+Ar(o,e[4].length))}function Q2(e,t,r){return r+(t===0?"":""+t)+Je(" ",e[1].length+2+e[4].length)}var Fm=/^#*0*\.([0#]+)/,Om=/\).*[0#]/,Rm=/\(###\) ###\\?-####/;function Dt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function nd(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function id(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Z2(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function e_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function or(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Om)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?or("n",n,r):"("+or("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return q2(e,t,r);if(t.indexOf("%")!==-1)return Y2(e,t,r);if(t.indexOf("E")!==-1)return Nm(t,r);if(t.charCodeAt(0)===36)return"$"+or(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Si(l,t.length);if(t.match(/^[#?]+$/))return i=Si(r,0),i==="0"&&(i=""),i.length>t.length?i:Dt(t.substr(0,t.length-i.length))+i;if(s=t.match(Cm))return J2(s,l,c);if(t.match(/^#+0+$/))return c+Si(l,t.length-t.indexOf("0"));if(s=t.match(Fm))return i=nd(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Dt(s[1])).replace(/\.$/,"."+Dt(s[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+Je("0",Dt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+nd(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+En(Si(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+or(e,t,-r):En(""+(Math.floor(r)+Z2(r,s[1].length)))+"."+Ar(id(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return or(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Zi(or(e,t.replace(/[\\-]/g,""),r)),a=0,Zi(Zi(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(Rm))return i=or(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=vl(l,Math.pow(10,a)-1,!1),i=""+c,u=Jr("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=gl(o[2],a),u.length<s[4].length&&(u=Dt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=vl(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?rf(o[1],a)+s[2]+"/"+s[3]+gl(o[2],a):Je(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Si(r,0),t.length<=i.length?i:Dt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,f=t.length-i.length-d;return Dt(t.substr(0,d)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=id(r,s[1].length),r<0?"-"+or(e,t,-r):En(e_(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Ar(0,3-v.length):"")+v})+"."+Ar(a,s[1].length);switch(t){case"###,##0.00":return or(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=En(Si(l,0));return p!=="0"?c+p:"";case"###,###.00":return or(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return or(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function t_(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Jr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function r_(e,t,r){var n=t.replace(Am,""),i=t.length-n.length;return Jr(e,n,r*Math.pow(10,2*i))+Je("%",i)}function Pm(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Pm(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Dr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Om)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dr("n",n,r):"("+Dr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return t_(e,t,r);if(t.indexOf("%")!==-1)return r_(e,t,r);if(t.indexOf("E")!==-1)return Pm(t,r);if(t.charCodeAt(0)===36)return"$"+Dr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ar(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Dt(t.substr(0,t.length-i.length))+i;if(s=t.match(Cm))return Q2(s,l,c);if(t.match(/^#+0+$/))return c+Ar(l,t.length-t.indexOf("0"));if(s=t.match(Fm))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Dt(s[1])).replace(/\.$/,"."+Dt(s[1])),i=i.replace(/\.(\d*)$/,function(v,m){return"."+m+Je("0",Dt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+En(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dr(e,t,-r):En(""+r)+"."+Je("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Dr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Zi(Dr(e,t.replace(/[\\-]/g,""),r)),a=0,Zi(Zi(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(Rm))return i=Dr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=vl(l,Math.pow(10,a)-1,!1),i=""+c,u=Jr("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=gl(o[2],a),u.length<s[4].length&&(u=Dt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=vl(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?rf(o[1],a)+s[2]+"/"+s[3]+gl(o[2],a):Je(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Dt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,f=t.length-i.length-d;return Dt(t.substr(0,d)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Dr(e,t,-r):En(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Ar(0,3-v.length):"")+v})+"."+Ar(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=En(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return Dr(e,t.slice(0,t.lastIndexOf(".")),r)+Dt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Jr(e,t,r){return(r|0)===r?Dr(e,t,r):or(e,t,r)}function n_(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Dm=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function bm(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":xl(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Dm))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function i_(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,d,f="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!xl(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=e.charAt(++a),v=p==="("||p===")"?p:"t";i[i.length]={t:v,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=yo(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=yo(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=yo(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",f="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",a+=5,f="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",a+=5,f="h"):(m.t="t",++a),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Dm)){if(c==null&&(c=yo(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",bm(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var w=0,g=0,x;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=f,l="h",w<1&&(w=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(g=Math.max(g,x[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",k;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=X2(i[a].t.charCodeAt(0),i[a].v,c,g),i[a].t="t";break;case"n":case"?":for(k=a+1;i[k]!=null&&((o=i[k].t)==="?"||o==="D"||(o===" "||o==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[a].v+=i[k].v,i[k]={v:"",t:";"},++k;y+=i[a].v,a=k-1;break;case"G":i[a].t="t",i[a].v=Gu(t,r);break}var D="",L,C;if(y.length>0){y.charCodeAt(0)==40?(L=t<0&&y.charCodeAt(0)===45?-t:t,C=Jr("n",y,L)):(L=t<0&&n>1?-t:t,C=Jr("n",y,L),L<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),k=C.length-1;var b=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){b=a;break}var j=i.length;if(b===i.length&&C.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(k>=i[a].v.length-1?(k-=i[a].v.length,i[a].v=C.substr(k+1,i[a].v.length)):k<0?i[a].v="":(i[a].v=C.substr(0,k+1),k=-1),i[a].t="t",j=a);k>=0&&j<i.length&&(i[j].v=C.substr(0,k+1)+i[j].v)}else if(b!==i.length&&C.indexOf("E")===-1){for(k=C.indexOf(".")-1,a=b;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===b?i[a].v.indexOf(".")-1:i[a].v.length-1,D=i[a].v.substr(u+1);u>=0;--u)k>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(D=C.charAt(k--)+D);i[a].v=D,i[a].t="t",j=a}for(k>=0&&j<i.length&&(i[j].v=C.substr(0,k+1)+i[j].v),k=C.indexOf(".")+1,a=b;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==b)){for(u=i[a].v.indexOf(".")>-1&&a===b?i[a].v.indexOf(".")+1:0,D=i[a].v.substr(0,u);u<i[a].v.length;++u)k<C.length&&(D+=C.charAt(k++));i[a].v=D,i[a].t="t",j=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(L=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Jr(i[a].t,i[a].v,L),i[a].t="t");var z="";for(a=0;a!==i.length;++a)i[a]!=null&&(z+=i[a].v);return z}var sd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ad(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function s_(e,t){var r=n_(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(sd),o=r[1].match(sd);return ad(t,a)?[n,r[0]]:ad(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Dn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Qe)[e],n==null&&(n=r.table&&r.table[rd[e]]||Qe[rd[e]]),n==null&&(n=U2[e]||"General");break}if(xl(n,0))return Gu(t,r);t instanceof Date&&(t=km(t,r.date1904));var i=s_(n,t);if(xl(i[1]))return Gu(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return i_(i[1],t,r,i[0])}function Im(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Qe[r]==null){t<0&&(t=r);continue}if(Qe[r]==e){t=r;break}}t<0&&(t=391)}return Qe[t]=e,t}function Xl(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Im(e[t],t)}function Yl(){Qe=B2()}var jm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function a_(e){var t=typeof e=="number"?Qe[e]:e;return t=t.replace(jm,"(\\d+)"),new RegExp("^"+t+"$")}function o_(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(jm)||[]).forEach(function(d,f){var p=parseInt(r[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var l_=function(){var e={};e.version="1.2.0";function t(){for(var C=0,b=new Array(256),j=0;j!=256;++j)C=j,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,b[j]=C;return typeof Int32Array<"u"?new Int32Array(b):b}var r=t();function n(C){var b=0,j=0,z=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)X[z]=C[z];for(z=0;z!=256;++z)for(j=C[z],b=256+z;b<4096;b+=256)j=X[b]=j>>>8^C[j&255];var R=[];for(z=1;z!=16;++z)R[z-1]=typeof Int32Array<"u"?X.subarray(z*256,z*256+256):X.slice(z*256,z*256+256);return R}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],d=i[6],f=i[7],p=i[8],v=i[9],m=i[10],w=i[11],g=i[12],x=i[13],y=i[14];function k(C,b){for(var j=b^-1,z=0,X=C.length;z<X;)j=j>>>8^r[(j^C.charCodeAt(z++))&255];return~j}function D(C,b){for(var j=b^-1,z=C.length-15,X=0;X<z;)j=y[C[X++]^j&255]^x[C[X++]^j>>8&255]^g[C[X++]^j>>16&255]^w[C[X++]^j>>>24]^m[C[X++]]^v[C[X++]]^p[C[X++]]^f[C[X++]]^d[C[X++]]^u[C[X++]]^c[C[X++]]^l[C[X++]]^o[C[X++]]^a[C[X++]]^s[C[X++]]^r[C[X++]];for(z+=15;X<z;)j=j>>>8^r[(j^C[X++])&255];return~j}function L(C,b){for(var j=b^-1,z=0,X=C.length,R=0,H=0;z<X;)R=C.charCodeAt(z++),R<128?j=j>>>8^r[(j^R)&255]:R<2048?(j=j>>>8^r[(j^(192|R>>6&31))&255],j=j>>>8^r[(j^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,H=C.charCodeAt(z++)&1023,j=j>>>8^r[(j^(240|R>>8&7))&255],j=j>>>8^r[(j^(128|R>>2&63))&255],j=j>>>8^r[(j^(128|H>>6&15|(R&3)<<4))&255],j=j>>>8^r[(j^(128|H&63))&255]):(j=j>>>8^r[(j^(224|R>>12&15))&255],j=j>>>8^r[(j^(128|R>>6&63))&255],j=j>>>8^r[(j^(128|R&63))&255]);return~j}return e.table=r,e.bstr=k,e.buf=D,e.str=L,e}(),je=function(){var t={};t.version="1.2.1";function r(_,T){for(var E=_.split("/"),S=T.split("/"),A=0,N=0,B=Math.min(E.length,S.length);A<B;++A){if(N=E[A].length-S[A].length)return N;if(E[A]!=S[A])return E[A]<S[A]?-1:1}return E.length-S.length}function n(_){if(_.charAt(_.length-1)=="/")return _.slice(0,-1).indexOf("/")===-1?_:n(_.slice(0,-1));var T=_.lastIndexOf("/");return T===-1?_:_.slice(0,T+1)}function i(_){if(_.charAt(_.length-1)=="/")return i(_.slice(0,-1));var T=_.lastIndexOf("/");return T===-1?_:_.slice(T+1)}function s(_,T){typeof T=="string"&&(T=new Date(T));var E=T.getHours();E=E<<6|T.getMinutes(),E=E<<5|T.getSeconds()>>>1,_.write_shift(2,E);var S=T.getFullYear()-1980;S=S<<4|T.getMonth()+1,S=S<<5|T.getDate(),_.write_shift(2,S)}function a(_){var T=_.read_shift(2)&65535,E=_.read_shift(2)&65535,S=new Date,A=E&31;E>>>=5;var N=E&15;E>>>=4,S.setMilliseconds(0),S.setFullYear(E+1980),S.setMonth(N-1),S.setDate(A);var B=T&31;T>>>=5;var G=T&63;return T>>>=6,S.setHours(T),S.setMinutes(G),S.setSeconds(B<<1),S}function o(_){Jt(_,0);for(var T={},E=0;_.l<=_.length-4;){var S=_.read_shift(2),A=_.read_shift(2),N=_.l+A,B={};switch(S){case 21589:E=_.read_shift(1),E&1&&(B.mtime=_.read_shift(4)),A>5&&(E&2&&(B.atime=_.read_shift(4)),E&4&&(B.ctime=_.read_shift(4))),B.mtime&&(B.mt=new Date(B.mtime*1e3));break}_.l=N,T[S]=B}return T}var l;function c(){return l||(l={})}function u(_,T){if(_[0]==80&&_[1]==75)return Mf(_,T);if((_[0]|32)==109&&(_[1]|32)==105)return Mx(_,T);if(_.length<512)throw new Error("CFB file size "+_.length+" < 512");var E=3,S=512,A=0,N=0,B=0,G=0,M=0,U=[],W=_.slice(0,512);Jt(W,0);var q=d(W);switch(E=q[0],E){case 3:S=512;break;case 4:S=4096;break;case 0:if(q[1]==0)return Mf(_,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+E)}S!==512&&(W=_.slice(0,S),Jt(W,28));var ne=_.slice(0,S);f(W,E);var ce=W.read_shift(4,"i");if(E===3&&ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ce);W.l+=4,B=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),G=W.read_shift(4,"i"),A=W.read_shift(4,"i"),M=W.read_shift(4,"i"),N=W.read_shift(4,"i");for(var Q=-1,le=0;le<109&&(Q=W.read_shift(4,"i"),!(Q<0));++le)U[le]=Q;var me=p(_,S);w(M,N,me,S,U);var He=x(me,B,U,S);He[B].name="!Directory",A>0&&G!==H&&(He[G].name="!MiniFAT"),He[U[0]].name="!FAT",He.fat_addrs=U,He.ssz=S;var Ve={},St=[],ws=[],Es=[];y(B,He,me,St,A,Ve,ws,G),v(ws,Es,St),St.shift();var Ss={FileIndex:ws,FullPaths:Es};return T&&T.raw&&(Ss.raw={header:ne,sectors:me}),Ss}function d(_){if(_[_.l]==80&&_[_.l+1]==75)return[0,0];_.chk(ie,"Header Signature: "),_.l+=16;var T=_.read_shift(2,"u");return[_.read_shift(2,"u"),T]}function f(_,T){var E=9;switch(_.l+=2,E=_.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+E);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+E);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+E)}_.chk("0600","Mini Sector Shift: "),_.chk("000000000000","Reserved: ")}function p(_,T){for(var E=Math.ceil(_.length/T)-1,S=[],A=1;A<E;++A)S[A-1]=_.slice(A*T,(A+1)*T);return S[E-1]=_.slice(E*T),S}function v(_,T,E){for(var S=0,A=0,N=0,B=0,G=0,M=E.length,U=[],W=[];S<M;++S)U[S]=W[S]=S,T[S]=E[S];for(;G<W.length;++G)S=W[G],A=_[S].L,N=_[S].R,B=_[S].C,U[S]===S&&(A!==-1&&U[A]!==A&&(U[S]=U[A]),N!==-1&&U[N]!==N&&(U[S]=U[N])),B!==-1&&(U[B]=S),A!==-1&&S!=U[S]&&(U[A]=U[S],W.lastIndexOf(A)<G&&W.push(A)),N!==-1&&S!=U[S]&&(U[N]=U[S],W.lastIndexOf(N)<G&&W.push(N));for(S=1;S<M;++S)U[S]===S&&(N!==-1&&U[N]!==N?U[S]=U[N]:A!==-1&&U[A]!==A&&(U[S]=U[A]));for(S=1;S<M;++S)if(_[S].type!==0){if(G=S,G!=U[G])do G=U[G],T[S]=T[G]+"/"+T[S];while(G!==0&&U[G]!==-1&&G!=U[G]);U[S]=-1}for(T[0]+="/",S=1;S<M;++S)_[S].type!==2&&(T[S]+="/")}function m(_,T,E){for(var S=_.start,A=_.size,N=[],B=S;E&&A>0&&B>=0;)N.push(T.slice(B*R,B*R+R)),A-=R,B=Jn(E,B*4);return N.length===0?V(0):xt(N).slice(0,_.size)}function w(_,T,E,S,A){var N=H;if(_===H){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(_!==-1){var B=E[_],G=(S>>>2)-1;if(!B)return;for(var M=0;M<G&&(N=Jn(B,M*4))!==H;++M)A.push(N);w(Jn(B,S-4),T-1,E,S,A)}}function g(_,T,E,S,A){var N=[],B=[];A||(A=[]);var G=S-1,M=0,U=0;for(M=T;M>=0;){A[M]=!0,N[N.length]=M,B.push(_[M]);var W=E[Math.floor(M*4/S)];if(U=M*4&G,S<4+U)throw new Error("FAT boundary crossed: "+M+" 4 "+S);if(!_[W])break;M=Jn(_[W],U)}return{nodes:N,data:pd([B])}}function x(_,T,E,S){var A=_.length,N=[],B=[],G=[],M=[],U=S-1,W=0,q=0,ne=0,ce=0;for(W=0;W<A;++W)if(G=[],ne=W+T,ne>=A&&(ne-=A),!B[ne]){M=[];var Q=[];for(q=ne;q>=0;){Q[q]=!0,B[q]=!0,G[G.length]=q,M.push(_[q]);var le=E[Math.floor(q*4/S)];if(ce=q*4&U,S<4+ce)throw new Error("FAT boundary crossed: "+q+" 4 "+S);if(!_[le]||(q=Jn(_[le],ce),Q[q]))break}N[ne]={nodes:G,data:pd([M])}}return N}function y(_,T,E,S,A,N,B,G){for(var M=0,U=S.length?2:0,W=T[_].data,q=0,ne=0,ce;q<W.length;q+=128){var Q=W.slice(q,q+128);Jt(Q,64),ne=Q.read_shift(2),ce=cf(Q,0,ne-U),S.push(ce);var le={name:ce,type:Q.read_shift(1),color:Q.read_shift(1),L:Q.read_shift(4,"i"),R:Q.read_shift(4,"i"),C:Q.read_shift(4,"i"),clsid:Q.read_shift(16),state:Q.read_shift(4,"i"),start:0,size:0},me=Q.read_shift(2)+Q.read_shift(2)+Q.read_shift(2)+Q.read_shift(2);me!==0&&(le.ct=k(Q,Q.l-8));var He=Q.read_shift(2)+Q.read_shift(2)+Q.read_shift(2)+Q.read_shift(2);He!==0&&(le.mt=k(Q,Q.l-8)),le.start=Q.read_shift(4,"i"),le.size=Q.read_shift(4,"i"),le.size<0&&le.start<0&&(le.size=le.type=0,le.start=H,le.name=""),le.type===5?(M=le.start,A>0&&M!==H&&(T[M].name="!StreamData")):le.size>=4096?(le.storage="fat",T[le.start]===void 0&&(T[le.start]=g(E,le.start,T.fat_addrs,T.ssz)),T[le.start].name=le.name,le.content=T[le.start].data.slice(0,le.size)):(le.storage="minifat",le.size<0?le.size=0:M!==H&&le.start!==H&&T[M]&&(le.content=m(le,T[M].data,(T[G]||{}).data))),le.content&&Jt(le.content,0),N[ce]=le,B.push(le)}}function k(_,T){return new Date((Zt(_,T+4)/1e7*Math.pow(2,32)+Zt(_,T)/1e7-11644473600)*1e3)}function D(_,T){return c(),u(l.readFileSync(_),T)}function L(_,T){var E=T&&T.type;switch(E||Ne&&Buffer.isBuffer(_)&&(E="buffer"),E||"base64"){case"file":return D(_,T);case"base64":return u(kr(sn(_)),T);case"binary":return u(kr(_),T)}return u(_,T)}function C(_,T){var E=T||{},S=E.root||"Root Entry";if(_.FullPaths||(_.FullPaths=[]),_.FileIndex||(_.FileIndex=[]),_.FullPaths.length!==_.FileIndex.length)throw new Error("inconsistent CFB structure");_.FullPaths.length===0&&(_.FullPaths[0]=S+"/",_.FileIndex[0]={name:S,type:5}),E.CLSID&&(_.FileIndex[0].clsid=E.CLSID),b(_)}function b(_){var T="Sh33tJ5";if(!je.find(_,"/"+T)){var E=V(4);E[0]=55,E[1]=E[3]=50,E[2]=54,_.FileIndex.push({name:T,type:2,content:E,size:4,L:69,R:69,C:69}),_.FullPaths.push(_.FullPaths[0]+T),j(_)}}function j(_,T){C(_);for(var E=!1,S=!1,A=_.FullPaths.length-1;A>=0;--A){var N=_.FileIndex[A];switch(N.type){case 0:S?E=!0:(_.FileIndex.pop(),_.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(N.R*N.L*N.C)&&(E=!0),N.R>-1&&N.L>-1&&N.R==N.L&&(E=!0);break;default:E=!0;break}}if(!(!E&&!T)){var B=new Date(1987,1,19),G=0,M=Object.create?Object.create(null):{},U=[];for(A=0;A<_.FullPaths.length;++A)M[_.FullPaths[A]]=!0,_.FileIndex[A].type!==0&&U.push([_.FullPaths[A],_.FileIndex[A]]);for(A=0;A<U.length;++A){var W=n(U[A][0]);S=M[W],S||(U.push([W,{name:i(W).replace("/",""),type:1,clsid:we,ct:B,mt:B,content:null}]),M[W]=!0)}for(U.sort(function(ce,Q){return r(ce[0],Q[0])}),_.FullPaths=[],_.FileIndex=[],A=0;A<U.length;++A)_.FullPaths[A]=U[A][0],_.FileIndex[A]=U[A][1];for(A=0;A<U.length;++A){var q=_.FileIndex[A],ne=_.FullPaths[A];if(q.name=i(ne).replace("/",""),q.L=q.R=q.C=-(q.color=1),q.size=q.content?q.content.length:0,q.start=0,q.clsid=q.clsid||we,A===0)q.C=U.length>1?1:-1,q.size=0,q.type=5;else if(ne.slice(-1)=="/"){for(G=A+1;G<U.length&&n(_.FullPaths[G])!=ne;++G);for(q.C=G>=U.length?-1:G,G=A+1;G<U.length&&n(_.FullPaths[G])!=n(ne);++G);q.R=G>=U.length?-1:G,q.type=1}else n(_.FullPaths[A+1]||"")==n(ne)&&(q.R=A+1),q.type=2}}}function z(_,T){var E=T||{};if(E.fileType=="mad")return Bx(_,E);switch(j(_),E.fileType){case"zip":return Px(_,E)}var S=function(ce){for(var Q=0,le=0,me=0;me<ce.FileIndex.length;++me){var He=ce.FileIndex[me];if(He.content){var Ve=He.content.length;Ve>0&&(Ve<4096?Q+=Ve+63>>6:le+=Ve+511>>9)}}for(var St=ce.FullPaths.length+3>>2,ws=Q+7>>3,Es=Q+127>>7,Ss=ws+le+St+Es,zn=Ss+127>>7,uc=zn<=109?0:Math.ceil((zn-109)/127);Ss+zn+uc+127>>7>zn;)uc=++zn<=109?0:Math.ceil((zn-109)/127);var zr=[1,uc,zn,Es,St,le,Q,0];return ce.FileIndex[0].size=Q<<6,zr[7]=(ce.FileIndex[0].start=zr[0]+zr[1]+zr[2]+zr[3]+zr[4]+zr[5])+(zr[6]+7>>3),zr}(_),A=V(S[7]<<9),N=0,B=0;{for(N=0;N<8;++N)A.write_shift(1,re[N]);for(N=0;N<8;++N)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),N=0;N<3;++N)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,S[2]),A.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:H),A.write_shift(4,S[3]),A.write_shift(-4,S[1]?S[0]-1:H),A.write_shift(4,S[1]),N=0;N<109;++N)A.write_shift(-4,N<S[2]?S[1]+N:-1)}if(S[1])for(B=0;B<S[1];++B){for(;N<236+B*127;++N)A.write_shift(-4,N<S[2]?S[1]+N:-1);A.write_shift(-4,B===S[1]-1?H:B+1)}var G=function(ce){for(B+=ce;N<B-1;++N)A.write_shift(-4,N+1);ce&&(++N,A.write_shift(-4,H))};for(B=N=0,B+=S[1];N<B;++N)A.write_shift(-4,Ee.DIFSECT);for(B+=S[2];N<B;++N)A.write_shift(-4,Ee.FATSECT);G(S[3]),G(S[4]);for(var M=0,U=0,W=_.FileIndex[0];M<_.FileIndex.length;++M)W=_.FileIndex[M],W.content&&(U=W.content.length,!(U<4096)&&(W.start=B,G(U+511>>9)));for(G(S[6]+7>>3);A.l&511;)A.write_shift(-4,Ee.ENDOFCHAIN);for(B=N=0,M=0;M<_.FileIndex.length;++M)W=_.FileIndex[M],W.content&&(U=W.content.length,!(!U||U>=4096)&&(W.start=B,G(U+63>>6)));for(;A.l&511;)A.write_shift(-4,Ee.ENDOFCHAIN);for(N=0;N<S[4]<<2;++N){var q=_.FullPaths[N];if(!q||q.length===0){for(M=0;M<17;++M)A.write_shift(4,0);for(M=0;M<3;++M)A.write_shift(4,-1);for(M=0;M<12;++M)A.write_shift(4,0);continue}W=_.FileIndex[N],N===0&&(W.start=W.size?W.start-1:H);var ne=N===0&&E.root||W.name;if(U=2*(ne.length+1),A.write_shift(64,ne,"utf16le"),A.write_shift(2,U),A.write_shift(1,W.type),A.write_shift(1,W.color),A.write_shift(-4,W.L),A.write_shift(-4,W.R),A.write_shift(-4,W.C),W.clsid)A.write_shift(16,W.clsid,"hex");else for(M=0;M<4;++M)A.write_shift(4,0);A.write_shift(4,W.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,W.start),A.write_shift(4,W.size),A.write_shift(4,0)}for(N=1;N<_.FileIndex.length;++N)if(W=_.FileIndex[N],W.size>=4096)if(A.l=W.start+1<<9,Ne&&Buffer.isBuffer(W.content))W.content.copy(A,A.l,0,W.size),A.l+=W.size+511&-512;else{for(M=0;M<W.size;++M)A.write_shift(1,W.content[M]);for(;M&511;++M)A.write_shift(1,0)}for(N=1;N<_.FileIndex.length;++N)if(W=_.FileIndex[N],W.size>0&&W.size<4096)if(Ne&&Buffer.isBuffer(W.content))W.content.copy(A,A.l,0,W.size),A.l+=W.size+63&-64;else{for(M=0;M<W.size;++M)A.write_shift(1,W.content[M]);for(;M&63;++M)A.write_shift(1,0)}if(Ne)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function X(_,T){var E=_.FullPaths.map(function(M){return M.toUpperCase()}),S=E.map(function(M){var U=M.split("/");return U[U.length-(M.slice(-1)=="/"?2:1)]}),A=!1;T.charCodeAt(0)===47?(A=!0,T=E[0].slice(0,-1)+T):A=T.indexOf("/")!==-1;var N=T.toUpperCase(),B=A===!0?E.indexOf(N):S.indexOf(N);if(B!==-1)return _.FileIndex[B];var G=!N.match(vo);for(N=N.replace(ea,""),G&&(N=N.replace(vo,"!")),B=0;B<E.length;++B)if((G?E[B].replace(vo,"!"):E[B]).replace(ea,"")==N||(G?S[B].replace(vo,"!"):S[B]).replace(ea,"")==N)return _.FileIndex[B];return null}var R=64,H=-2,ie="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",Ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(_,T,E){c();var S=z(_,E);l.writeFileSync(T,S)}function se(_){for(var T=new Array(_.length),E=0;E<_.length;++E)T[E]=String.fromCharCode(_[E]);return T.join("")}function pe(_,T){var E=z(_,T);switch(T&&T.type||"buffer"){case"file":return c(),l.writeFileSync(T.filename,E),E;case"binary":return typeof E=="string"?E:se(E);case"base64":return Ca(typeof E=="string"?E:se(E));case"buffer":if(Ne)return Buffer.isBuffer(E)?E:ln(E);case"array":return typeof E=="string"?kr(E):E}return E}var ve;function F(_){try{var T=_.InflateRaw,E=new T;if(E._processChunk(new Uint8Array([3,0]),E._finishFlushFlag),E.bytesRead)ve=_;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function I(_,T){if(!ve)return jf(_,T);var E=ve.InflateRaw,S=new E,A=S._processChunk(_.slice(_.l),S._finishFlushFlag);return _.l+=S.bytesRead,A}function O(_){return ve?ve.deflateRawSync(_):Of(_)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(_){var T=(_<<1|_<<11)&139536|(_<<5|_<<15)&558144;return(T>>16|T>>8|T)&255}for(var oe=typeof Uint8Array<"u",ae=oe?new Uint8Array(256):[],Le=0;Le<256;++Le)ae[Le]=fe(Le);function Se(_,T){var E=ae[_&255];return T<=8?E>>>8-T:(E=E<<8|ae[_>>8&255],T<=16?E>>>16-T:(E=E<<8|ae[_>>16&255],E>>>24-T))}function Ot(_,T){var E=T&7,S=T>>>3;return(_[S]|(E<=6?0:_[S+1]<<8))>>>E&3}function Ce(_,T){var E=T&7,S=T>>>3;return(_[S]|(E<=5?0:_[S+1]<<8))>>>E&7}function $r(_,T){var E=T&7,S=T>>>3;return(_[S]|(E<=4?0:_[S+1]<<8))>>>E&15}function Ye(_,T){var E=T&7,S=T>>>3;return(_[S]|(E<=3?0:_[S+1]<<8))>>>E&31}function de(_,T){var E=T&7,S=T>>>3;return(_[S]|(E<=1?0:_[S+1]<<8))>>>E&127}function ar(_,T,E){var S=T&7,A=T>>>3,N=(1<<E)-1,B=_[A]>>>S;return E<8-S||(B|=_[A+1]<<8-S,E<16-S)||(B|=_[A+2]<<16-S,E<24-S)||(B|=_[A+3]<<24-S),B&N}function Wr(_,T,E){var S=T&7,A=T>>>3;return S<=5?_[A]|=(E&7)<<S:(_[A]|=E<<S&255,_[A+1]=(E&7)>>8-S),T+3}function $n(_,T,E){var S=T&7,A=T>>>3;return E=(E&1)<<S,_[A]|=E,T+1}function wi(_,T,E){var S=T&7,A=T>>>3;return E<<=S,_[A]|=E&255,E>>>=8,_[A+1]=E,T+8}function Ff(_,T,E){var S=T&7,A=T>>>3;return E<<=S,_[A]|=E&255,E>>>=8,_[A+1]=E&255,_[A+2]=E>>>8,T+16}function ac(_,T){var E=_.length,S=2*E>T?2*E:T+5,A=0;if(E>=T)return _;if(Ne){var N=Zh(S);if(_.copy)_.copy(N);else for(;A<_.length;++A)N[A]=_[A];return N}else if(oe){var B=new Uint8Array(S);if(B.set)B.set(_);else for(;A<E;++A)B[A]=_[A];return B}return _.length=S,_}function Rr(_){for(var T=new Array(_),E=0;E<_;++E)T[E]=0;return T}function Ja(_,T,E){var S=1,A=0,N=0,B=0,G=0,M=_.length,U=oe?new Uint16Array(32):Rr(32);for(N=0;N<32;++N)U[N]=0;for(N=M;N<E;++N)_[N]=0;M=_.length;var W=oe?new Uint16Array(M):Rr(M);for(N=0;N<M;++N)U[A=_[N]]++,S<A&&(S=A),W[N]=0;for(U[0]=0,N=1;N<=S;++N)U[N+16]=G=G+U[N-1]<<1;for(N=0;N<M;++N)G=_[N],G!=0&&(W[N]=U[G+16]++);var q=0;for(N=0;N<M;++N)if(q=_[N],q!=0)for(G=Se(W[N],S)>>S-q,B=(1<<S+4-q)-1;B>=0;--B)T[G|B<<q]=q&15|N<<4;return S}var oc=oe?new Uint16Array(512):Rr(512),lc=oe?new Uint16Array(32):Rr(32);if(!oe){for(var Wn=0;Wn<512;++Wn)oc[Wn]=0;for(Wn=0;Wn<32;++Wn)lc[Wn]=0}(function(){for(var _=[],T=0;T<32;T++)_.push(5);Ja(_,lc,32);var E=[];for(T=0;T<=143;T++)E.push(8);for(;T<=255;T++)E.push(9);for(;T<=279;T++)E.push(7);for(;T<=287;T++)E.push(8);Ja(E,oc,288)})();var Cx=function(){for(var T=oe?new Uint8Array(32768):[],E=0,S=0;E<ue.length-1;++E)for(;S<ue[E+1];++S)T[S]=E;for(;S<32768;++S)T[S]=29;var A=oe?new Uint8Array(259):[];for(E=0,S=0;E<K.length-1;++E)for(;S<K[E+1];++S)A[S]=E;function N(G,M){for(var U=0;U<G.length;){var W=Math.min(65535,G.length-U),q=U+W==G.length;for(M.write_shift(1,+q),M.write_shift(2,W),M.write_shift(2,~W&65535);W-- >0;)M[M.l++]=G[U++]}return M.l}function B(G,M){for(var U=0,W=0,q=oe?new Uint16Array(32768):[];W<G.length;){var ne=Math.min(65535,G.length-W);if(ne<10){for(U=Wr(M,U,+(W+ne==G.length)),U&7&&(U+=8-(U&7)),M.l=U/8|0,M.write_shift(2,ne),M.write_shift(2,~ne&65535);ne-- >0;)M[M.l++]=G[W++];U=M.l*8;continue}U=Wr(M,U,+(W+ne==G.length)+2);for(var ce=0;ne-- >0;){var Q=G[W];ce=(ce<<5^Q)&32767;var le=-1,me=0;if((le=q[ce])&&(le|=W&-32768,le>W&&(le-=32768),le<W))for(;G[le+me]==G[W+me]&&me<250;)++me;if(me>2){Q=A[me],Q<=22?U=wi(M,U,ae[Q+1]>>1)-1:(wi(M,U,3),U+=5,wi(M,U,ae[Q-23]>>5),U+=3);var He=Q<8?0:Q-4>>2;He>0&&(Ff(M,U,me-K[Q]),U+=He),Q=T[W-le],U=wi(M,U,ae[Q]>>3),U-=3;var Ve=Q<4?0:Q-2>>1;Ve>0&&(Ff(M,U,W-le-ue[Q]),U+=Ve);for(var St=0;St<me;++St)q[ce]=W&32767,ce=(ce<<5^G[W])&32767,++W;ne-=me-1}else Q<=143?Q=Q+48:U=$n(M,U,1),U=wi(M,U,ae[Q]),q[ce]=W&32767,++W}U=wi(M,U,0)-1}return M.l=(U+7)/8|0,M.l}return function(M,U){return M.length<8?N(M,U):B(M,U)}}();function Of(_){var T=V(50+Math.floor(_.length*1.1)),E=Cx(_,T);return T.slice(0,E)}var Rf=oe?new Uint16Array(32768):Rr(32768),Pf=oe?new Uint16Array(32768):Rr(32768),Df=oe?new Uint16Array(128):Rr(128),bf=1,If=1;function Fx(_,T){var E=Ye(_,T)+257;T+=5;var S=Ye(_,T)+1;T+=5;var A=$r(_,T)+4;T+=4;for(var N=0,B=oe?new Uint8Array(19):Rr(19),G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=1,U=oe?new Uint8Array(8):Rr(8),W=oe?new Uint8Array(8):Rr(8),q=B.length,ne=0;ne<A;++ne)B[P[ne]]=N=Ce(_,T),M<N&&(M=N),U[N]++,T+=3;var ce=0;for(U[0]=0,ne=1;ne<=M;++ne)W[ne]=ce=ce+U[ne-1]<<1;for(ne=0;ne<q;++ne)(ce=B[ne])!=0&&(G[ne]=W[ce]++);var Q=0;for(ne=0;ne<q;++ne)if(Q=B[ne],Q!=0){ce=ae[G[ne]]>>8-Q;for(var le=(1<<7-Q)-1;le>=0;--le)Df[ce|le<<Q]=Q&7|ne<<3}var me=[];for(M=1;me.length<E+S;)switch(ce=Df[de(_,T)],T+=ce&7,ce>>>=3){case 16:for(N=3+Ot(_,T),T+=2,ce=me[me.length-1];N-- >0;)me.push(ce);break;case 17:for(N=3+Ce(_,T),T+=3;N-- >0;)me.push(0);break;case 18:for(N=11+de(_,T),T+=7;N-- >0;)me.push(0);break;default:me.push(ce),M<ce&&(M=ce);break}var He=me.slice(0,E),Ve=me.slice(E);for(ne=E;ne<286;++ne)He[ne]=0;for(ne=S;ne<30;++ne)Ve[ne]=0;return bf=Ja(He,Rf,286),If=Ja(Ve,Pf,30),T}function Ox(_,T){if(_[0]==3&&!(_[1]&3))return[ui(T),2];for(var E=0,S=0,A=Zh(T||1<<18),N=0,B=A.length>>>0,G=0,M=0;!(S&1);){if(S=Ce(_,E),E+=3,S>>>1)S>>1==1?(G=9,M=5):(E=Fx(_,E),G=bf,M=If);else{E&7&&(E+=8-(E&7));var U=_[E>>>3]|_[(E>>>3)+1]<<8;if(E+=32,U>0)for(!T&&B<N+U&&(A=ac(A,N+U),B=A.length);U-- >0;)A[N++]=_[E>>>3],E+=8;continue}for(;;){!T&&B<N+32767&&(A=ac(A,N+32767),B=A.length);var W=ar(_,E,G),q=S>>>1==1?oc[W]:Rf[W];if(E+=q&15,q>>>=4,!(q>>>8&255))A[N++]=q;else{if(q==256)break;q-=257;var ne=q<8?0:q-4>>2;ne>5&&(ne=0);var ce=N+K[q];ne>0&&(ce+=ar(_,E,ne),E+=ne),W=ar(_,E,M),q=S>>>1==1?lc[W]:Pf[W],E+=q&15,q>>>=4;var Q=q<4?0:q-2>>1,le=ue[q];for(Q>0&&(le+=ar(_,E,Q),E+=Q),!T&&B<ce&&(A=ac(A,ce+100),B=A.length);N<ce;)A[N]=A[N-le],++N}}}return T?[A,E+7>>>3]:[A.slice(0,N),E+7>>>3]}function jf(_,T){var E=_.slice(_.l||0),S=Ox(E,T);return _.l+=S[1],S[0]}function Lf(_,T){if(_)typeof console<"u"&&console.error(T);else throw new Error(T)}function Mf(_,T){var E=_;Jt(E,0);var S=[],A=[],N={FileIndex:S,FullPaths:A};C(N,{root:T.root});for(var B=E.length-4;(E[B]!=80||E[B+1]!=75||E[B+2]!=5||E[B+3]!=6)&&B>=0;)--B;E.l=B+4,E.l+=4;var G=E.read_shift(2);E.l+=6;var M=E.read_shift(4);for(E.l=M,B=0;B<G;++B){E.l+=20;var U=E.read_shift(4),W=E.read_shift(4),q=E.read_shift(2),ne=E.read_shift(2),ce=E.read_shift(2);E.l+=8;var Q=E.read_shift(4),le=o(E.slice(E.l+q,E.l+q+ne));E.l+=q+ne+ce;var me=E.l;E.l=Q+4,Rx(E,U,W,N,le),E.l=me}return N}function Rx(_,T,E,S,A){_.l+=2;var N=_.read_shift(2),B=_.read_shift(2),G=a(_);if(N&8257)throw new Error("Unsupported ZIP encryption");for(var M=_.read_shift(4),U=_.read_shift(4),W=_.read_shift(4),q=_.read_shift(2),ne=_.read_shift(2),ce="",Q=0;Q<q;++Q)ce+=String.fromCharCode(_[_.l++]);if(ne){var le=o(_.slice(_.l,_.l+ne));(le[21589]||{}).mt&&(G=le[21589].mt),((A||{})[21589]||{}).mt&&(G=A[21589].mt)}_.l+=ne;var me=_.slice(_.l,_.l+U);switch(B){case 8:me=I(_,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+B)}var He=!1;N&8&&(M=_.read_shift(4),M==134695760&&(M=_.read_shift(4),He=!0),U=_.read_shift(4),W=_.read_shift(4)),U!=T&&Lf(He,"Bad compressed size: "+T+" != "+U),W!=E&&Lf(He,"Bad uncompressed size: "+E+" != "+W),cc(S,ce,me,{unsafe:!0,mt:G})}function Px(_,T){var E=T||{},S=[],A=[],N=V(1),B=E.compression?8:0,G=0,M=0,U=0,W=0,q=0,ne=_.FullPaths[0],ce=ne,Q=_.FileIndex[0],le=[],me=0;for(M=1;M<_.FullPaths.length;++M)if(ce=_.FullPaths[M].slice(ne.length),Q=_.FileIndex[M],!(!Q.size||!Q.content||ce=="Sh33tJ5")){var He=W,Ve=V(ce.length);for(U=0;U<ce.length;++U)Ve.write_shift(1,ce.charCodeAt(U)&127);Ve=Ve.slice(0,Ve.l),le[q]=l_.buf(Q.content,0);var St=Q.content;B==8&&(St=O(St)),N=V(30),N.write_shift(4,67324752),N.write_shift(2,20),N.write_shift(2,G),N.write_shift(2,B),Q.mt?s(N,Q.mt):N.write_shift(4,0),N.write_shift(-4,le[q]),N.write_shift(4,St.length),N.write_shift(4,Q.content.length),N.write_shift(2,Ve.length),N.write_shift(2,0),W+=N.length,S.push(N),W+=Ve.length,S.push(Ve),W+=St.length,S.push(St),N=V(46),N.write_shift(4,33639248),N.write_shift(2,0),N.write_shift(2,20),N.write_shift(2,G),N.write_shift(2,B),N.write_shift(4,0),N.write_shift(-4,le[q]),N.write_shift(4,St.length),N.write_shift(4,Q.content.length),N.write_shift(2,Ve.length),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(4,0),N.write_shift(4,He),me+=N.l,A.push(N),me+=Ve.length,A.push(Ve),++q}return N=V(22),N.write_shift(4,101010256),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,q),N.write_shift(2,q),N.write_shift(4,me),N.write_shift(4,W),N.write_shift(2,0),xt([xt(S),xt(A),N])}var Qa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Dx(_,T){if(_.ctype)return _.ctype;var E=_.name||"",S=E.match(/\.([^\.]+)$/);return S&&Qa[S[1]]||T&&(S=(E=T).match(/[\.\\]([^\.\\])+$/),S&&Qa[S[1]])?Qa[S[1]]:"application/octet-stream"}function bx(_){for(var T=Ca(_),E=[],S=0;S<T.length;S+=76)E.push(T.slice(S,S+76));return E.join(`\r
`)+`\r
`}function Ix(_){var T=_.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(U){var W=U.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var E=[],S=T.split(`\r
`),A=0;A<S.length;++A){var N=S[A];if(N.length==0){E.push("");continue}for(var B=0;B<N.length;){var G=76,M=N.slice(B,B+G);M.charAt(G-1)=="="?G--:M.charAt(G-2)=="="?G-=2:M.charAt(G-3)=="="&&(G-=3),M=N.slice(B,B+G),B+=G,B<N.length&&(M+="="),E.push(M)}}return E.join(`\r
`)}function jx(_){for(var T=[],E=0;E<_.length;++E){for(var S=_[E];E<=_.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+_[++E];T.push(S)}for(var A=0;A<T.length;++A)T[A]=T[A].replace(/[=][0-9A-Fa-f]{2}/g,function(N){return String.fromCharCode(parseInt(N.slice(1),16))});return kr(T.join(`\r
`))}function Lx(_,T,E){for(var S="",A="",N="",B,G=0;G<10;++G){var M=T[G];if(!M||M.match(/^\s*$/))break;var U=M.match(/^(.*?):\s*([^\s].*)$/);if(U)switch(U[1].toLowerCase()){case"content-location":S=U[2].trim();break;case"content-type":N=U[2].trim();break;case"content-transfer-encoding":A=U[2].trim();break}}switch(++G,A.toLowerCase()){case"base64":B=kr(sn(T.slice(G).join("")));break;case"quoted-printable":B=jx(T.slice(G));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var W=cc(_,S.slice(E.length),B,{unsafe:!0});N&&(W.ctype=N)}function Mx(_,T){if(se(_.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var E=T&&T.root||"",S=(Ne&&Buffer.isBuffer(_)?_.toString("binary"):se(_)).split(`\r
`),A=0,N="";for(A=0;A<S.length;++A)if(N=S[A],!!/^Content-Location:/i.test(N)&&(N=N.slice(N.indexOf("file")),E||(E=N.slice(0,N.lastIndexOf("/")+1)),N.slice(0,E.length)!=E))for(;E.length>0&&(E=E.slice(0,E.length-1),E=E.slice(0,E.lastIndexOf("/")+1),N.slice(0,E.length)!=E););var B=(S[1]||"").match(/boundary="(.*?)"/);if(!B)throw new Error("MAD cannot find boundary");var G="--"+(B[1]||""),M=[],U=[],W={FileIndex:M,FullPaths:U};C(W);var q,ne=0;for(A=0;A<S.length;++A){var ce=S[A];ce!==G&&ce!==G+"--"||(ne++&&Lx(W,S.slice(q,A),E),q=A)}return W}function Bx(_,T){var E=T||{},S=E.boundary||"SheetJS";S="------="+S;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],N=_.FullPaths[0],B=N,G=_.FileIndex[0],M=1;M<_.FullPaths.length;++M)if(B=_.FullPaths[M].slice(N.length),G=_.FileIndex[M],!(!G.size||!G.content||B=="Sh33tJ5")){B=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(me){return"_x"+me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(me){return"_u"+me.charCodeAt(0).toString(16)+"_"});for(var U=G.content,W=Ne&&Buffer.isBuffer(U)?U.toString("binary"):se(U),q=0,ne=Math.min(1024,W.length),ce=0,Q=0;Q<=ne;++Q)(ce=W.charCodeAt(Q))>=32&&ce<128&&++q;var le=q>=ne*4/5;A.push(S),A.push("Content-Location: "+(E.root||"file:///C:/SheetJS/")+B),A.push("Content-Transfer-Encoding: "+(le?"quoted-printable":"base64")),A.push("Content-Type: "+Dx(G,B)),A.push(""),A.push(le?Ix(W):bx(W))}return A.push(S+`--\r
`),A.join(`\r
`)}function Ux(_){var T={};return C(T,_),T}function cc(_,T,E,S){var A=S&&S.unsafe;A||C(_);var N=!A&&je.find(_,T);if(!N){var B=_.FullPaths[0];T.slice(0,B.length)==B?B=T:(B.slice(-1)!="/"&&(B+="/"),B=(B+T).replace("//","/")),N={name:i(T),type:2},_.FileIndex.push(N),_.FullPaths.push(B),A||je.utils.cfb_gc(_)}return N.content=E,N.size=E?E.length:0,S&&(S.CLSID&&(N.clsid=S.CLSID),S.mt&&(N.mt=S.mt),S.ct&&(N.ct=S.ct)),N}function $x(_,T){C(_);var E=je.find(_,T);if(E){for(var S=0;S<_.FileIndex.length;++S)if(_.FileIndex[S]==E)return _.FileIndex.splice(S,1),_.FullPaths.splice(S,1),!0}return!1}function Wx(_,T,E){C(_);var S=je.find(_,T);if(S){for(var A=0;A<_.FileIndex.length;++A)if(_.FileIndex[A]==S)return _.FileIndex[A].name=i(E),_.FullPaths[A]=E,!0}return!1}function zx(_){j(_,!0)}return t.find=X,t.read=L,t.parse=u,t.write=pe,t.writeFile=te,t.utils={cfb_new:Ux,cfb_add:cc,cfb_del:$x,cfb_mov:Wx,cfb_gc:zx,ReadShift:ra,CheckField:eg,prep_blob:Jt,bconcat:xt,use_zlib:F,_deflateRaw:Of,_inflateRaw:jf,consts:Ee},t}();function c_(e){return typeof e=="string"?Kl(e):Array.isArray(e)?I2(e):e}function za(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Kl(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Oa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([c_(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Wa(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Et(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function od(e,t){for(var r=[],n=Et(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function sf(e){for(var t=[],r=Et(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ql(e){for(var t=[],r=Et(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function u_(e){for(var t=[],r=Et(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var yl=new Date(1899,11,30,0,0,0);function Kt(e,t){var r=e.getTime(),n=yl.getTime()+(e.getTimezoneOffset()-yl.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Lm=new Date,f_=yl.getTime()+(Lm.getTimezoneOffset()-yl.getTimezoneOffset())*6e4,ld=Lm.getTimezoneOffset();function Mm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+f_),t.getTimezoneOffset()!==ld&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ld)*6e4),t}var cd=new Date("2017-02-19T19:06:09.000Z"),Bm=isNaN(cd.getFullYear())?new Date("2/19/17"):cd,h_=Bm.getFullYear()==2017;function jt(e,t){var r=new Date(e);if(h_)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Bm.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Jl(e,t){if(Ne&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Xt(e[r]));return t}function Je(e,t){for(var r="";r.length<t;)r+=e;return r}function Qr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var d_=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fa(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&d_.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function xe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ne?n=ln(r):n=j2(r),je.utils.cfb_add(e,t,n)}je.utils.cfb_add(e,t,r)}else e.file(t,r)}function af(){return je.utils.cfb_new()}var nt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,p_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},of=sf(p_),lf=/[&<>'"]/g,m_=/[\u0000-\u0008\u000b-\u001f]/g;function De(e){var t=e+"";return t.replace(lf,function(r){return of[r]}).replace(m_,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ud(e){return De(e).replace(/ /g,"_x0020_")}var Um=/[\u0000-\u001f]/g;function g_(e){var t=e+"";return t.replace(lf,function(r){return of[r]}).replace(/\n/g,"<br/>").replace(Um,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function x_(e){var t=e+"";return t.replace(lf,function(r){return of[r]}).replace(Um,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function v_(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function y_(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Mc(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function fd(e){var t=ui(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function hd(e){return ln(e,"binary").toString("utf8")}var _o="foo bar baz",ta=Ne&&(hd(_o)==Mc(_o)&&hd||fd(_o)==Mc(_o)&&fd)||Mc,Oa=Ne?function(e){return ln(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},__=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),$m=/(^\s|\s$|\n)/;function vt(e,t){return"<"+e+(t.match($m)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ra(e){return Et(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Z(e,t,r){return"<"+e+(r!=null?Ra(r):"")+(t!=null?(t.match($m)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ku(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function w_(e,t){switch(typeof e){case"string":var r=Z("vt:lpwstr",De(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Z((e|0)==e?"vt:i4":"vt:r8",De(String(e)));case"boolean":return Z("vt:bool",e?"true":"false")}if(e instanceof Date)return Z("vt:filetime",Ku(e));throw new Error("Unable to serialize "+e)}var ut={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ms=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function E_(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function S_(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var dd=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},pd=Ne?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ln(t)})):dd(e)}:dd,md=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode($s(e,i)));return n.join("").replace(ea,"")},cf=Ne?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ea,""):md(e,t,r)}:md,gd=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},Wm=Ne?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):gd(e,t,r)}:gd,xd=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Ri(e,i)));return n.join("")},Ha=Ne?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):xd(t,r,n)}:xd,zm=function(e,t){var r=Zt(e,t);return r>0?Ha(e,t+4,t+4+r-1):""},Hm=zm,Vm=function(e,t){var r=Zt(e,t);return r>0?Ha(e,t+4,t+4+r-1):""},Gm=Vm,Km=function(e,t){var r=2*Zt(e,t);return r>0?Ha(e,t+4,t+4+r-1):""},Xm=Km,Ym=function(t,r){var n=Zt(t,r);return n>0?cf(t,r+4,r+4+n):""},qm=Ym,Jm=function(e,t){var r=Zt(e,t);return r>0?Ha(e,t+4,t+4+r):""},Qm=Jm,Zm=function(e,t){return E_(e,t)},_l=Zm,uf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ne&&(Hm=function(t,r){if(!Buffer.isBuffer(t))return zm(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Gm=function(t,r){if(!Buffer.isBuffer(t))return Vm(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Xm=function(t,r){if(!Buffer.isBuffer(t))return Km(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},qm=function(t,r){if(!Buffer.isBuffer(t))return Ym(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Qm=function(t,r){if(!Buffer.isBuffer(t))return Jm(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},_l=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Zm(t,r)},uf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ri=function(e,t){return e[t]},$s=function(e,t){return e[t+1]*256+e[t]},T_=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Zt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Jn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},k_=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ra(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Ne&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode($s(this,c)),c+=2;e*=2;break;case"utf8":r=Ha(this,this.l,this.l+e);break;case"utf16le":e*=2,r=cf(this,this.l,this.l+e);break;case"wstr":return ra.call(this,e,"dbcs");case"lpstr-ansi":r=Hm(this,this.l),e=4+Zt(this,this.l);break;case"lpstr-cp":r=Gm(this,this.l),e=4+Zt(this,this.l);break;case"lpwstr":r=Xm(this,this.l),e=4+2*Zt(this,this.l);break;case"lpp4":e=4+Zt(this,this.l),r=qm(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Zt(this,this.l),r=Qm(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Ri(this,this.l+e++))!==0;)s.push(xo(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=$s(this,this.l+e))!==0;)s.push(xo(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Ri(this,c),this.l=c+1,o=ra.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(xo($s(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Ri(this,c),this.l=c+1,o=ra.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(xo(Ri(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Ri(this,this.l),this.l++,n;case 2:return n=(t==="i"?T_:$s)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Jn:k_)(this,this.l),this.l+=4,n):(i=Zt(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=_l(this,this.l):i=_l([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=Wm(this,this.l,e);break}}return this.l+=e,r}var A_=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},N_=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},C_=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function F_(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)C_(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,A_(this,t,this.l);break;case 8:if(n=8,r==="f"){S_(this,t,this.l);break}case 16:break;case-4:n=4,N_(this,t,this.l);break}return this.l+=n,this}function eg(e,t){var r=Wm(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Jt(e,t){e.l=t,e.read_shift=ra,e.chk=eg,e.write_shift=F_}function Ur(e,t){e.l+=t}function V(e){var t=ui(e);return Jt(t,0),t}function Gt(){var e=[],t=Ne?256:2048,r=function(c){var u=V(c);return Jt(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),xt(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function Y(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Ek[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&uf(r)&&e.push(r)}}function na(e,t,r){var n=Xt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vd(e,t,r){var n=Xt(e);return n.s=na(n.s,t.s,r),n.e=na(n.e,t.s,r),n}function ia(e,t){if(e.cRel&&e.c<0)for(e=Xt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ie(e);return!e.cRel&&e.cRel!=null&&(r=P_(r)),!e.rRel&&e.rRel!=null&&(r=O_(r)),r}function Bc(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Nt(e.s.c)+":"+(e.e.cRel?"":"$")+Nt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+_t(e.s.r)+":"+(e.e.rRel?"":"$")+_t(e.e.r):ia(e.s,t.biff)+":"+ia(e.e,t.biff)}function ff(e){return parseInt(R_(e),10)-1}function _t(e){return""+(e+1)}function O_(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function R_(e){return e.replace(/\$(\d+)$/,"$1")}function hf(e){for(var t=D_(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Nt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function P_(e){return e.replace(/^([A-Z])/,"$$$1")}function D_(e){return e.replace(/^\$([A-Z])/,"$1")}function b_(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ft(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ie(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function nr(e){var t=e.indexOf(":");return t==-1?{s:ft(e),e:ft(e)}:{s:ft(e.slice(0,t)),e:ft(e.slice(t+1))}}function rt(e,t){return typeof t>"u"||typeof t=="number"?rt(e.s,e.e):(typeof e!="string"&&(e=Ie(e)),typeof t!="string"&&(t=Ie(t)),e==t?e:e+":"+t)}function We(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function yd(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Dn(e.z,r?Kt(t):t)}catch{}try{return e.w=Dn((e.XF||{}).numFmtId||(r?14:0),r?Kt(t):t)}catch{return""+t}}function an(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Va[e.v]||e.v:t==null?yd(e,e.v):yd(e,t))}function mi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function tg(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ft(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=We(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[d].length;++f)if(!(typeof t[d][f]>"u")){var p={v:t[d][f]},v=a+d,m=o+f;if(c.s.r>v&&(c.s.r=v),c.s.c>m&&(c.s.c=m),c.e.r<v&&(c.e.r=v),c.e.c<m&&(c.e.c=m),t[d][f]&&typeof t[d][f]=="object"&&!Array.isArray(t[d][f])&&!(t[d][f]instanceof Date))p=t[d][f];else if(Array.isArray(p.v)&&(p.f=t[d][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Qe[14],n.cellDates?(p.t="d",p.w=Dn(p.z,Kt(p.v))):(p.t="n",p.v=Kt(p.v),p.w=Dn(p.z,p.v))):p.t="s";if(i)s[v]||(s[v]=[]),s[v][m]&&s[v][m].z&&(p.z=s[v][m].z),s[v][m]=p;else{var w=Ie({c:m,r:v});s[w]&&s[w].z&&(p.z=s[w].z),s[w]=p}}}return c.s.c<1e7&&(s["!ref"]=rt(c)),s}function gs(e,t){return tg(null,e,t)}function I_(e){return e.read_shift(4,"i")}function Fr(e,t){return t||(t=V(4)),t.write_shift(4,e),t}function Ct(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ht(e,t){var r=!1;return t==null&&(r=!0,t=V(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function j_(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function L_(e,t){return t||(t=V(4)),t.write_shift(2,0),t.write_shift(2,0),t}function df(e,t){var r=e.l,n=e.read_shift(1),i=Ct(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(j_(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function M_(e,t){var r=!1;return t==null&&(r=!0,t=V(15+4*e.t.length)),t.write_shift(1,0),ht(e.t,t),r?t.slice(0,t.l):t}var B_=df;function U_(e,t){var r=!1;return t==null&&(r=!0,t=V(23+4*e.t.length)),t.write_shift(1,1),ht(e.t,t),t.write_shift(4,1),L_({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function gr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function gi(e,t){return t==null&&(t=V(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function xi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function vi(e,t){return t==null&&(t=V(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var $_=Ct,rg=ht;function pf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function wl(e,t){var r=!1;return t==null&&(r=!0,t=V(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var W_=Ct,Xu=pf,mf=wl;function ng(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?_l([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Jn(t,0)>>2;return r?i/100:i}function ig(e,t){t==null&&(t=V(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function sg(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function z_(e,t){return t||(t=V(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var yi=sg,xs=z_;function vs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fi(e,t){return(t||V(8)).write_shift(8,e,"f")}function H_(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=Z_[i];c&&(t.rgb=Od(c));break;case 2:t.rgb=Od([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function El(e,t){if(t||(t=V(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function V_(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function G_(e,t){t||(t=V(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var ag=2,Yt=3,wo=11,Sl=19,Eo=64,K_=65,X_=71,Y_=4108,q_=4126,gt=80,_d={1:{n:"CodePage",t:ag},2:{n:"Category",t:gt},3:{n:"PresentationFormat",t:gt},4:{n:"ByteCount",t:Yt},5:{n:"LineCount",t:Yt},6:{n:"ParagraphCount",t:Yt},7:{n:"SlideCount",t:Yt},8:{n:"NoteCount",t:Yt},9:{n:"HiddenCount",t:Yt},10:{n:"MultimediaClipCount",t:Yt},11:{n:"ScaleCrop",t:wo},12:{n:"HeadingPairs",t:Y_},13:{n:"TitlesOfParts",t:q_},14:{n:"Manager",t:gt},15:{n:"Company",t:gt},16:{n:"LinksUpToDate",t:wo},17:{n:"CharacterCount",t:Yt},19:{n:"SharedDoc",t:wo},22:{n:"HyperlinksChanged",t:wo},23:{n:"AppVersion",t:Yt,p:"version"},24:{n:"DigSig",t:K_},26:{n:"ContentType",t:gt},27:{n:"ContentStatus",t:gt},28:{n:"Language",t:gt},29:{n:"Version",t:gt},255:{},2147483648:{n:"Locale",t:Sl},2147483651:{n:"Behavior",t:Sl},1919054434:{}},wd={1:{n:"CodePage",t:ag},2:{n:"Title",t:gt},3:{n:"Subject",t:gt},4:{n:"Author",t:gt},5:{n:"Keywords",t:gt},6:{n:"Comments",t:gt},7:{n:"Template",t:gt},8:{n:"LastAuthor",t:gt},9:{n:"RevNumber",t:gt},10:{n:"EditTime",t:Eo},11:{n:"LastPrinted",t:Eo},12:{n:"CreatedDate",t:Eo},13:{n:"ModifiedDate",t:Eo},14:{n:"PageCount",t:Yt},15:{n:"WordCount",t:Yt},16:{n:"CharCount",t:Yt},17:{n:"Thumbnail",t:X_},18:{n:"Application",t:gt},19:{n:"DocSecurity",t:Yt},255:{},2147483648:{n:"Locale",t:Sl},2147483651:{n:"Behavior",t:Sl},1919054434:{}};function J_(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Q_=J_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Z_=Xt(Q_),Va={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ew={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},So={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function og(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lg(e,t){var r=u_(ew),n=[],i;n[n.length]=nt,n[n.length]=Z("Types",null,{xmlns:ut.CT,"xmlns:xsd":ut.xsd,"xmlns:xsi":ut.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Z("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=Z("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:So[l][t.bookType]||So[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Z("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:So[l][t.bookType]||So[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Z("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ke={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function cg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function es(e){var t=[nt,Z("Relationships",null,{xmlns:ut.RELS})];return Et(e["!id"]).forEach(function(r){t[t.length]=Z("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Pe(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[ke.HLINK,ke.XPATH,ke.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function tw(e){var t=[nt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Ed(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function rw(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function nw(e){var t=[nt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Ed(e[r][0],e[r][1])),t.push(rw("",e[r][0]));return t.push(Ed("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function ug(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ml.version+"</meta:generator></office:meta></office:document-meta>"}var ii=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Uc(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=De(t),n[n.length]=r?Z(e,t,r):vt(e,t))}function fg(e,t){var r=t||{},n=[nt,Z("cp:coreProperties",null,{"xmlns:cp":ut.CORE_PROPS,"xmlns:dc":ut.dc,"xmlns:dcterms":ut.dcterms,"xmlns:dcmitype":ut.dcmitype,"xmlns:xsi":ut.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Uc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ku(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Uc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ku(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=ii.length;++s){var a=ii[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Uc(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ts=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],hg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function dg(e){var t=[],r=Z;return e||(e={}),e.Application="SheetJS",t[t.length]=nt,t[t.length]=Z("Properties",null,{xmlns:ut.EXT_PROPS,"xmlns:vt":ut.vt}),ts.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=De(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+De(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function pg(e){var t=[nt,Z("Properties",null,{xmlns:ut.CUST_PROPS,"xmlns:vt":ut.vt})];if(!e)return t.join("");var r=1;return Et(e).forEach(function(i){++r,t[t.length]=Z("property",w_(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:De(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Sd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function iw(e,t){var r=[];return Et(Sd).map(function(n){for(var i=0;i<ii.length;++i)if(ii[i][1]==n)return ii[i];for(i=0;i<ts.length;++i)if(ts[i][1]==n)return ts[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(vt(Sd[n[1]]||n[1],i))}}),Z("DocumentProperties",r.join(""),{xmlns:Qt.o})}function sw(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Et(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<ii.length;++a)if(s==ii[a][1])return;for(a=0;a<ts.length;++a)if(s==ts[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Z(ud(s),o,{"dt:dt":l}))}}),t&&Et(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Z(ud(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Qt.o+'">'+i.join("")+"</"+n+">"}function aw(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=V(8);return a.write_shift(4,n),a.write_shift(4,i),a}function Td(e,t){var r=V(4),n=V(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=V(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=aw(t);break;case 31:case 80:for(n=V(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return xt([r,n])}var mg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ow(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function kd(e,t,r){var n=V(8),i=[],s=[],a=8,o=0,l=V(8),c=V(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!t){c=V(8),c.write_shift(4,0),i.unshift(c);var u=[V(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=V(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=xt(u),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(mg.indexOf(e[o][0])>-1||hg.indexOf(e[o][0])>-1)&&e[o][1]!=null){var f=e[o][1],p=0;if(t){p=+t[e[o][0]];var v=r[p];if(v.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=Td(v.t,f)}else{var w=ow(f);w==-1&&(w=31,f=String(f)),l=Td(w,f)}s.push(l),c=V(8),c.write_shift(4,t?p:2+o),i.push(c),a+=8+l.length}var g=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,g),g+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),xt([n].concat(i).concat(s))}function Ad(e,t,r,n,i,s){var a=V(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,je.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=kd(e,r,n);if(o.push(l),i){var c=kd(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return xt(o)}function lw(e,t){t||(t=V(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function cw(e,t){return e.read_shift(t)===1}function bt(e,t){return t||(t=V(2)),t.write_shift(2,+!!e),t}function gg(e){return e.read_shift(2,"u")}function lr(e,t){return t||(t=V(2)),t.write_shift(2,e),t}function xg(e,t,r){return r||(r=V(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function vg(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function uw(e){var t=e.t||"",r=V(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=V(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return xt(i)}function fw(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function hw(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):fw(e,n,r)}function dw(e,t,r){if(r.biff>5)return hw(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function yg(e,t,r){return r||(r=V(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Nd(e,t){t||(t=V(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function pw(e){var t=V(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),Nd(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Nd(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function hi(e,t,r,n){return n||(n=V(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function mw(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function gw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function _g(e,t){return t||(t=V(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function gf(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=V(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function xw(e,t){var r=!t||t.biff==8,n=V(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function vw(e,t){var r=!t||t.biff>=8?2:1,n=V(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function yw(e,t){var r=V(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=uw(e[i]);var s=xt([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function _w(){var e=V(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function ww(e){var t=V(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Ew(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=V(i);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function Sw(e,t,r,n){var i=V(10);return hi(e,t,n,i),i.write_shift(4,r),i}function Tw(e,t,r,n,i){var s=!i||i.biff==8,a=V(8+ +s+(1+s)*r.length);return hi(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function kw(e,t,r,n){var i=r&&r.biff==5;n||(n=V(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function Aw(e,t){var r=t.biff==8||!t.biff?4:2,n=V(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Cd(e,t,r,n){var i=r&&r.biff==5;n||(n=V(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function Nw(e){var t=V(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Cw(e,t,r,n,i,s){var a=V(8);return hi(e,t,n,a),xg(r,s,a),a}function Fw(e,t,r,n){var i=V(14);return hi(e,t,n,i),fi(r,i),i}function Ow(e,t,r){if(r.biff<8)return Rw(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(mw(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Rw(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=vg(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Pw(e){var t=V(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)_g(e[r],t);return t}function Dw(e){var t=V(24),r=ft(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return xt([t,pw(e[1])])}function bw(e){var t=e[1].Tooltip,r=V(10+2*(t.length+1));r.write_shift(2,2048);var n=ft(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Iw(e){return e||(e=V(4)),e.write_shift(2,1),e.write_shift(2,1),e}function jw(e,t,r){if(!r.cellStyles)return Ur(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Lw(e,t){var r=V(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Mw(e){for(var t=V(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Bw(e,t,r){var n=V(15);return Ka(n,e,t),n.write_shift(8,r,"f"),n}function Uw(e,t,r){var n=V(9);return Ka(n,e,t),n.write_shift(2,r),n}var $w=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=sf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=ui(1);switch(l.type){case"base64":u=kr(sn(o));break;case"binary":u=kr(o);break;case"buffer":case"array":u=o;break}Jt(u,0);var d=u.read_shift(1),f=!!(d&136),p=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,w=521;d==2&&(m=u.read_shift(2)),u.l+=3,d!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(w=u.read_shift(2));var g=u.read_shift(2),x=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(x=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var y=[],k={},D=Math.min(u.length,d==2?521:w-10-(p?264:0)),L=v?32:11;u.l<D&&u[u.l]!=13;)switch(k={},k.name=qn.utils.decode(x,u.slice(u.l,u.l+L)).replace(/[\u0000\r\n].*$/g,""),u.l+=L,k.type=String.fromCharCode(u.read_shift(1)),d!=2&&!v&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),d==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&y.push(k),d!=2&&(u.l+=v?13:14),k.type){case"B":(!p||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var C=0,b=0;for(c[0]=[],b=0;b!=y.length;++b)c[0][b]=y[b].name;for(;m-- >0;){if(u[u.l]===42){u.l+=g;continue}for(++u.l,c[++C]=[],b=0,b=0;b!=y.length;++b){var j=u.slice(u.l,u.l+y[b].len);u.l+=y[b].len,Jt(j,0);var z=qn.utils.decode(x,j);switch(y[b].type){case"C":z.trim().length&&(c[C][b]=z.replace(/\s+$/,""));break;case"D":z.length===8?c[C][b]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):c[C][b]=z;break;case"F":c[C][b]=parseFloat(z.trim());break;case"+":case"I":c[C][b]=v?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":c[C][b]=!0;break;case"N":case"F":c[C][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[C][b]="##MEMO##"+(v?parseInt(z.trim(),10):j.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(c[C][b]=+z||0);break;case"@":c[C][b]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":c[C][b]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":c[C][b]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][b]=-j.read_shift(-8,"f");break;case"B":if(p&&y[b].len==8){c[C][b]=j.read_shift(8,"f");break}case"G":case"P":j.l+=y[b].len;break;case"0":if(y[b].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[b].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=gs(r(o,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function i(o,l){try{return mi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Na(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Gt(),d=Cl(o,{header:1,raw:!0,cellDates:!0}),f=d[0],p=d.slice(1),v=o["!cols"]||[],m=0,w=0,g=0,x=1;for(m=0;m<f.length;++m){if(((v[m]||{}).DBF||{}).name){f[m]=v[m].DBF.name,++g;continue}if(f[m]!=null){if(++g,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(w=0;w<1024;++w)if(f.indexOf(f[m]+"_"+w)==-1){f[m]+="_"+w;break}}}}var y=We(o["!ref"]),k=[],D=[],L=[];for(m=0;m<=y.e.c-y.s.c;++m){var C="",b="",j=0,z=[];for(w=0;w<p.length;++w)p[w][m]!=null&&z.push(p[w][m]);if(z.length==0||f[m]==null){k[m]="?";continue}for(w=0;w<z.length;++w){switch(typeof z[w]){case"number":b="B";break;case"string":b="C";break;case"boolean":b="L";break;case"object":b=z[w]instanceof Date?"D":"C";break;default:b="C"}j=Math.max(j,String(z[w]).length),C=C&&C!=b?"C":b}j>250&&(j=250),b=((v[m]||{}).DBF||{}).type,b=="C"&&v[m].DBF.len>j&&(j=v[m].DBF.len),C=="B"&&b=="N"&&(C="N",L[m]=v[m].DBF.dec,j=v[m].DBF.len),D[m]=C=="C"||b=="N"?j:s[C]||0,x+=D[m],k[m]=C}var X=u.next(32);for(X.write_shift(4,318902576),X.write_shift(4,p.length),X.write_shift(2,296+32*g),X.write_shift(2,x),m=0;m<4;++m)X.write_shift(4,0);for(X.write_shift(4,0|(+t[Em]||3)<<8),m=0,w=0;m<f.length;++m)if(f[m]!=null){var R=u.next(32),H=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,H,"sbcs"),R.write_shift(1,k[m]=="?"?"C":k[m],"sbcs"),R.write_shift(4,w),R.write_shift(1,D[m]||s[k[m]]||0),R.write_shift(1,L[m]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),w+=D[m]||s[k[m]]||0}var ie=u.next(264);for(ie.write_shift(4,13),m=0;m<65;++m)ie.write_shift(4,0);for(m=0;m<p.length;++m){var re=u.next(x);for(re.write_shift(1,0),w=0;w<f.length;++w)if(f[w]!=null)switch(k[w]){case"L":re.write_shift(1,p[m][w]==null?63:p[m][w]?84:70);break;case"B":re.write_shift(8,p[m][w]||0,"f");break;case"N":var we="0";for(typeof p[m][w]=="number"&&(we=p[m][w].toFixed(L[w]||0)),g=0;g<D[w]-we.length;++g)re.write_shift(1,32);re.write_shift(1,we,"sbcs");break;case"D":p[m][w]?(re.write_shift(4,("0000"+p[m][w].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(p[m][w].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+p[m][w].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var Ee=String(p[m][w]!=null?p[m][w]:"").slice(0,D[w]);for(re.write_shift(1,Ee,"sbcs"),g=0;g<D[w]-Ee.length;++g)re.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),Ww=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Et(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,p){var v=e[p];return typeof v=="number"?Qh(v):v},n=function(f,p,v){var m=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?f:Qh(m)};e["|"]=254;function i(f,p){switch(p.type){case"base64":return s(sn(f),p);case"binary":return s(f,p);case"buffer":return s(Ne&&Buffer.isBuffer(f)?f.toString("binary"):Wa(f),p);case"array":return s(Jl(f),p)}throw new Error("Unrecognized type "+p.type)}function s(f,p){var v=f.split(/[\n\r]+/),m=-1,w=-1,g=0,x=0,y=[],k=[],D=null,L={},C=[],b=[],j=[],z=0,X;for(+p.codepage>=0&&Na(+p.codepage);g!==v.length;++g){z=0;var R=v[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),H=R.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),ie=H[0],re;if(R.length>0)switch(ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&k.push(R.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,Ee=!1,te=!1,se=!1,pe=-1,ve=-1;for(x=1;x<H.length;++x)switch(H[x].charAt(0)){case"A":break;case"X":w=parseInt(H[x].slice(1))-1,Ee=!0;break;case"Y":for(m=parseInt(H[x].slice(1))-1,Ee||(w=0),X=y.length;X<=m;++X)y[X]=[];break;case"K":re=H[x].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Qr(re))?isNaN(Fa(re).getDate())||(re=jt(re)):(re=Qr(re),D!==null&&bm(D)&&(re=Mm(re))),we=!0;break;case"E":se=!0;var F=UE(H[x].slice(1),{r:m,c:w});y[m][w]=[y[m][w],F];break;case"S":te=!0,y[m][w]=[y[m][w],"S5S"];break;case"G":break;case"R":pe=parseInt(H[x].slice(1))-1;break;case"C":ve=parseInt(H[x].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}if(we&&(y[m][w]&&y[m][w].length==2?y[m][w][0]=re:y[m][w]=re,D=null),te){if(se)throw new Error("SYLK shared formula cannot have own formula");var I=pe>-1&&y[pe][ve];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");y[m][w][1]=$E(I[1],{r:m-pe,c:w-ve})}break;case"F":var O=0;for(x=1;x<H.length;++x)switch(H[x].charAt(0)){case"X":w=parseInt(H[x].slice(1))-1,++O;break;case"Y":for(m=parseInt(H[x].slice(1))-1,X=y.length;X<=m;++X)y[X]=[];break;case"M":z=parseInt(H[x].slice(1))/20;break;case"F":break;case"G":break;case"P":D=k[parseInt(H[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=H[x].slice(1).split(" "),X=parseInt(j[0],10);X<=parseInt(j[1],10);++X)z=parseInt(j[2],10),b[X-1]=z===0?{hidden:!0}:{wch:z},xf(b[X-1]);break;case"C":w=parseInt(H[x].slice(1))-1,b[w]||(b[w]={});break;case"R":m=parseInt(H[x].slice(1))-1,C[m]||(C[m]={}),z>0?(C[m].hpt=z,C[m].hpx=kg(z)):z===0&&(C[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}O<1&&(D=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}}return C.length>0&&(L["!rows"]=C),b.length>0&&(L["!cols"]=b),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,L]}function a(f,p){var v=i(f,p),m=v[0],w=v[1],g=gs(m,p);return Et(w).forEach(function(x){g[x]=w[x]}),g}function o(f,p){return mi(a(f,p),p)}function l(f,p,v,m){var w="C;Y"+(v+1)+";X"+(m+1)+";K";switch(f.t){case"n":w+=f.v||0,f.f&&!f.F&&(w+=";E"+yf(f.f,{r:v,c:m}));break;case"b":w+=f.v?"TRUE":"FALSE";break;case"e":w+=f.w||f.v;break;case"d":w+='"'+(f.w||f.v)+'"';break;case"s":w+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(f,p){p.forEach(function(v,m){var w="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Tl(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=kl(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&f.push(w)})}function u(f,p){p.forEach(function(v,m){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*Al(v.hpx)+";"),w.length>2&&f.push(w+"R"+(m+1))})}function d(f,p){var v=["ID;PWXL;N;E"],m=[],w=We(f["!ref"]),g,x=Array.isArray(f),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&c(v,f["!cols"]),f["!rows"]&&u(v,f["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var k=w.s.r;k<=w.e.r;++k)for(var D=w.s.c;D<=w.e.c;++D){var L=Ie({r:k,c:D});g=x?(f[k]||[])[D]:f[L],!(!g||g.v==null&&(!g.f||g.F))&&m.push(l(g,f,k,D))}return v.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),zw=function(){function e(s,a){switch(a.type){case"base64":return t(sn(s),a);case"binary":return t(s,a);case"buffer":return t(Ne&&Buffer.isBuffer(s)?s.toString("binary"):Wa(s),a);case"array":return t(Jl(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,d=[];u!==o.length;++u){if(o[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var f=o[u].trim().split(","),p=f[0],v=f[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){d[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][c]=!0:m==="FALSE"?d[l][c]=!1:isNaN(Qr(v))?isNaN(Fa(v).getDate())?d[l][c]=v:d[l][c]=jt(v):d[l][c]=Qr(v),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function r(s,a){return gs(e(s,a),a)}function n(s,a){return mi(r(s,a),a)}var i=function(){var s=function(l,c,u,d,f){l.push(c),l.push(u+","+d),l.push('"'+f.replace(/"/g,'""')+'"')},a=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=We(l["!ref"]),d,f=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var m=Ie({r:p,c:v});if(d=f?(l[p]||[])[v]:l[m],!d){a(c,1,0,"");continue}switch(d.t){case"n":var w=d.w;!w&&d.v!=null&&(w=d.v),w==null?d.f&&!d.F?a(c,1,0,"="+d.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Dn(d.z||Qe[14],Kt(jt(d.v)))),a(c,0,d.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var g=`\r
`,x=c.join(g);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),wg=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,f){for(var p=d.split(`
`),v=-1,m=-1,w=0,g=[];w!==p.length;++w){var x=p[w].trim().split(":");if(x[0]==="cell"){var y=ft(x[1]);if(g.length<=y.r)for(v=g.length;v<=y.r;++v)g[v]||(g[v]=[]);switch(v=y.r,m=y.c,x[2]){case"t":g[v][m]=e(x[3]);break;case"v":g[v][m]=+x[3];break;case"vtf":var k=x[x.length-1];case"vtc":switch(x[3]){case"nl":g[v][m]=!!+x[4];break;default:g[v][m]=+x[4];break}x[2]=="vtf"&&(g[v][m]=[g[v][m],k])}}}return f&&f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}function n(d,f){return gs(r(d,f),f)}function i(d,f){return mi(n(d,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var f=[],p=[],v,m="",w=nr(d["!ref"]),g=Array.isArray(d),x=w.s.r;x<=w.e.r;++x)for(var y=w.s.c;y<=w.e.c;++y)if(m=Ie({r:x,c:y}),v=g?(d[x]||[])[y]:d[m],!(!v||v.v==null||v.t==="z")){switch(p=["cell",m,"t"],v.t){case"s":case"str":p.push(t(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=t(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var k=Kt(jt(v.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=v.w||Dn(v.z||Qe[14],k);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(d){return[s,a,o,a,c(d),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),Hw=function(){function e(u,d,f,p,v){v.raw?d[f][p]=u:u===""||(u==="TRUE"?d[f][p]=!0:u==="FALSE"?d[f][p]=!1:isNaN(Qr(u))?isNaN(Fa(u).getDate())?d[f][p]=u:d[f][p]=jt(u):d[f][p]=Qr(u))}function t(u,d){var f=d||{},p=[];if(!u||u.length===0)return p;for(var v=u.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var w=10,g=0,x=0;x<=m;++x)g=v[x].indexOf(" "),g==-1?g=v[x].length:g++,w=Math.max(w,g);for(x=0;x<=m;++x){p[x]=[];var y=0;for(e(v[x].slice(0,w).trim(),p,x,y,f),y=1;y<=(v[x].length-w)/10+1;++y)e(v[x].slice(w+(y-1)*10,w+y*10).trim(),p,x,y,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var d={},f=!1,p=0,v=0;p<u.length;++p)(v=u.charCodeAt(p))==34?f=!f:!f&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&v.push([d[p],p]);if(!v.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&v.push([d[p],p])}return v.sort(function(m,w){return m[0]-w[0]||n[m[1]]-n[w[1]]}),r[v.pop()[1]]||44}function s(u,d){var f=d||{},p="",v=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):f&&f.FS?p=f.FS:p=i(u.slice(0,1024));var w=0,g=0,x=0,y=0,k=0,D=p.charCodeAt(0),L=!1,C=0,b=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var j=f.dateNF!=null?a_(f.dateNF):null;function z(){var X=u.slice(y,k),R={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)R.t="z";else if(f.raw)R.t="s",R.v=X;else if(X.trim().length===0)R.t="s",R.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(R.t="s",R.v=X.slice(2,-1).replace(/""/g,'"')):WE(X)?(R.t="n",R.f=X.slice(1)):(R.t="s",R.v=X);else if(X=="TRUE")R.t="b",R.v=!0;else if(X=="FALSE")R.t="b",R.v=!1;else if(!isNaN(x=Qr(X)))R.t="n",f.cellText!==!1&&(R.w=X),R.v=x;else if(!isNaN(Fa(X).getDate())||j&&X.match(j)){R.z=f.dateNF||Qe[14];var H=0;j&&X.match(j)&&(X=o_(X,f.dateNF,X.match(j)||[]),H=1),f.cellDates?(R.t="d",R.v=jt(X,H)):(R.t="n",R.v=Kt(jt(X,H))),f.cellText!==!1&&(R.w=Dn(R.z,R.v instanceof Date?Kt(R.v):R.v)),f.cellNF||delete R.z}else R.t="s",R.v=X;if(R.t=="z"||(f.dense?(v[w]||(v[w]=[]),v[w][g]=R):v[Ie({c:g,r:w})]=R),y=k+1,b=u.charCodeAt(y),m.e.c<g&&(m.e.c=g),m.e.r<w&&(m.e.r=w),C==D)++g;else if(g=0,++w,f.sheetRows&&f.sheetRows<=w)return!0}e:for(;k<u.length;++k)switch(C=u.charCodeAt(k)){case 34:b===34&&(L=!L);break;case D:case 10:case 13:if(!L&&z())break e;break}return k-y>0&&z(),v["!ref"]=rt(m),v}function a(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):gs(t(u,d),d)}function o(u,d){var f="",p=d.type=="string"?[0,0,0,0]:r3(u,d);switch(d.type){case"base64":f=sn(u);break;case"binary":f=u;break;case"buffer":d.codepage==65001?f=u.toString("utf8"):d.codepage&&typeof qn<"u"?f=qn.utils.decode(d.codepage,u):f=Ne&&Buffer.isBuffer(u)?u.toString("binary"):Wa(u);break;case"array":f=Jl(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=ta(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=ta(f):d.type=="binary"&&typeof qn<"u"&&d.codepage&&(f=qn.utils.decode(d.codepage,qn.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?wg.to_sheet(d.type=="string"?f:ta(f),d):a(f,d)}function l(u,d){return mi(o(u,d),d)}function c(u){for(var d=[],f=We(u["!ref"]),p,v=Array.isArray(u),m=f.s.r;m<=f.e.r;++m){for(var w=[],g=f.s.c;g<=f.e.c;++g){var x=Ie({r:m,c:g});if(p=v?(u[m]||[])[g]:u[x],!p||p.v==null){w.push("          ");continue}for(var y=(p.w||(an(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(g===0?" ":""))}d.push(w.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),Fd=function(){function e(F,I,O){if(F){Jt(F,F.l||0);for(var P=O.Enum||pe;F.l<F.length;){var K=F.read_shift(2),ue=P[K]||P[65535],fe=F.read_shift(2),oe=F.l+fe,ae=ue.f&&ue.f(F,fe,O);if(F.l=oe,I(ae,ue,K))return}}}function t(F,I){switch(I.type){case"base64":return r(kr(sn(F)),I);case"binary":return r(kr(F),I);case"buffer":case"array":return r(F,I)}throw"Unsupported type "+I.type}function r(F,I){if(!F)return F;var O=I||{},P=O.dense?[]:{},K="Sheet1",ue="",fe=0,oe={},ae=[],Le=[],Se={s:{r:0,c:0},e:{r:0,c:0}},Ot=O.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)O.Enum=pe,e(F,function(de,ar,Wr){switch(Wr){case 0:O.vers=de,de>=4096&&(O.qpro=!0);break;case 6:Se=de;break;case 204:de&&(ue=de);break;case 222:ue=de;break;case 15:case 51:O.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Wr==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=O.dateNF||Qe[14],O.cellDates&&(de[1].t="d",de[1].v=Mm(de[1].v))),O.qpro&&de[3]>fe&&(P["!ref"]=rt(Se),oe[K]=P,ae.push(K),P=O.dense?[]:{},Se={s:{r:0,c:0},e:{r:0,c:0}},fe=de[3],K=ue||"Sheet"+(fe+1),ue="");var $n=O.dense?(P[de[0].r]||[])[de[0].c]:P[Ie(de[0])];if($n){$n.t=de[1].t,$n.v=de[1].v,de[1].z!=null&&($n.z=de[1].z),de[1].f!=null&&($n.f=de[1].f);break}O.dense?(P[de[0].r]||(P[de[0].r]=[]),P[de[0].r][de[0].c]=de[1]):P[Ie(de[0])]=de[1];break}},O);else if(F[2]==26||F[2]==14)O.Enum=ve,F[2]==14&&(O.qpro=!0,F.l=0),e(F,function(de,ar,Wr){switch(Wr){case 204:K=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>fe&&(P["!ref"]=rt(Se),oe[K]=P,ae.push(K),P=O.dense?[]:{},Se={s:{r:0,c:0},e:{r:0,c:0}},fe=de[3],K="Sheet"+(fe+1)),Ot>0&&de[0].r>=Ot)break;O.dense?(P[de[0].r]||(P[de[0].r]=[]),P[de[0].r][de[0].c]=de[1]):P[Ie(de[0])]=de[1],Se.e.c<de[0].c&&(Se.e.c=de[0].c),Se.e.r<de[0].r&&(Se.e.r=de[0].r);break;case 27:de[14e3]&&(Le[de[14e3][0]]=de[14e3][1]);break;case 1537:Le[de[0]]=de[1],de[0]==fe&&(K=de[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(P["!ref"]=rt(Se),oe[ue||K]=P,ae.push(ue||K),!Le.length)return{SheetNames:ae,Sheets:oe};for(var Ce={},$r=[],Ye=0;Ye<Le.length;++Ye)oe[ae[Ye]]?($r.push(Le[Ye]||ae[Ye]),Ce[Le[Ye]]=oe[Le[Ye]]||oe[ae[Ye]]):($r.push(Le[Ye]),Ce[Le[Ye]]={"!ref":"A1"});return{SheetNames:$r,Sheets:Ce}}function n(F,I){var O=I||{};if(+O.codepage>=0&&Na(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Gt(),K=We(F["!ref"]),ue=Array.isArray(F),fe=[];ee(P,0,s(1030)),ee(P,6,l(K));for(var oe=Math.min(K.e.r,8191),ae=K.s.r;ae<=oe;++ae)for(var Le=_t(ae),Se=K.s.c;Se<=K.e.c;++Se){ae===K.s.r&&(fe[Se]=Nt(Se));var Ot=fe[Se]+Le,Ce=ue?(F[ae]||[])[Se]:F[Ot];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?ee(P,13,p(ae,Se,Ce.v)):ee(P,14,m(ae,Se,Ce.v));else{var $r=an(Ce);ee(P,15,d(ae,Se,$r.slice(0,239)))}}return ee(P,1),P.end()}function i(F,I){var O=I||{};if(+O.codepage>=0&&Na(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Gt();ee(P,0,a(F));for(var K=0,ue=0;K<F.SheetNames.length;++K)(F.Sheets[F.SheetNames[K]]||{})["!ref"]&&ee(P,27,se(F.SheetNames[K],ue++));var fe=0;for(K=0;K<F.SheetNames.length;++K){var oe=F.Sheets[F.SheetNames[K]];if(!(!oe||!oe["!ref"])){for(var ae=We(oe["!ref"]),Le=Array.isArray(oe),Se=[],Ot=Math.min(ae.e.r,8191),Ce=ae.s.r;Ce<=Ot;++Ce)for(var $r=_t(Ce),Ye=ae.s.c;Ye<=ae.e.c;++Ye){Ce===ae.s.r&&(Se[Ye]=Nt(Ye));var de=Se[Ye]+$r,ar=Le?(oe[Ce]||[])[Ye]:oe[de];if(!(!ar||ar.t=="z"))if(ar.t=="n")ee(P,23,z(Ce,Ye,fe,ar.v));else{var Wr=an(ar);ee(P,22,C(Ce,Ye,fe,Wr.slice(0,239)))}}++fe}}return ee(P,1),P.end()}function s(F){var I=V(2);return I.write_shift(2,F),I}function a(F){var I=V(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var O=0,P=0,K=0,ue=0;ue<F.SheetNames.length;++ue){var fe=F.SheetNames[ue],oe=F.Sheets[fe];if(!(!oe||!oe["!ref"])){++K;var ae=nr(oe["!ref"]);O<ae.e.r&&(O=ae.e.r),P<ae.e.c&&(P=ae.e.c)}}return O>8191&&(O=8191),I.write_shift(2,O),I.write_shift(1,K),I.write_shift(1,P),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(F,I,O){var P={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&O.qpro?(P.s.c=F.read_shift(1),F.l++,P.s.r=F.read_shift(2),P.e.c=F.read_shift(1),F.l++,P.e.r=F.read_shift(2),P):(P.s.c=F.read_shift(2),P.s.r=F.read_shift(2),I==12&&O.qpro&&(F.l+=2),P.e.c=F.read_shift(2),P.e.r=F.read_shift(2),I==12&&O.qpro&&(F.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(F){var I=V(8);return I.write_shift(2,F.s.c),I.write_shift(2,F.s.r),I.write_shift(2,F.e.c),I.write_shift(2,F.e.r),I}function c(F,I,O){var P=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(P[0].c=F.read_shift(1),P[3]=F.read_shift(1),P[0].r=F.read_shift(2),F.l+=2):(P[2]=F.read_shift(1),P[0].c=F.read_shift(2),P[0].r=F.read_shift(2)),P}function u(F,I,O){var P=F.l+I,K=c(F,I,O);if(K[1].t="s",O.vers==20768){F.l++;var ue=F.read_shift(1);return K[1].v=F.read_shift(ue,"utf8"),K}return O.qpro&&F.l++,K[1].v=F.read_shift(P-F.l,"cstr"),K}function d(F,I,O){var P=V(7+O.length);P.write_shift(1,255),P.write_shift(2,I),P.write_shift(2,F),P.write_shift(1,39);for(var K=0;K<P.length;++K){var ue=O.charCodeAt(K);P.write_shift(1,ue>=128?95:ue)}return P.write_shift(1,0),P}function f(F,I,O){var P=c(F,I,O);return P[1].v=F.read_shift(2,"i"),P}function p(F,I,O){var P=V(7);return P.write_shift(1,255),P.write_shift(2,I),P.write_shift(2,F),P.write_shift(2,O,"i"),P}function v(F,I,O){var P=c(F,I,O);return P[1].v=F.read_shift(8,"f"),P}function m(F,I,O){var P=V(13);return P.write_shift(1,255),P.write_shift(2,I),P.write_shift(2,F),P.write_shift(8,O,"f"),P}function w(F,I,O){var P=F.l+I,K=c(F,I,O);if(K[1].v=F.read_shift(8,"f"),O.qpro)F.l=P;else{var ue=F.read_shift(2);k(F.slice(F.l,F.l+ue),K),F.l+=ue}return K}function g(F,I,O){var P=I&32768;return I&=-32769,I=(P?F:0)+(I>=8192?I-16384:I),(P?"":"$")+(O?Nt(I):_t(I))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(F,I){Jt(F,0);for(var O=[],P=0,K="",ue="",fe="",oe="";F.l<F.length;){var ae=F[F.l++];switch(ae){case 0:O.push(F.read_shift(8,"f"));break;case 1:ue=g(I[0].c,F.read_shift(2),!0),K=g(I[0].r,F.read_shift(2),!1),O.push(ue+K);break;case 2:{var Le=g(I[0].c,F.read_shift(2),!0),Se=g(I[0].r,F.read_shift(2),!1);ue=g(I[0].c,F.read_shift(2),!0),K=g(I[0].r,F.read_shift(2),!1),O.push(Le+Se+":"+ue+K)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(F.read_shift(2));break;case 6:{for(var Ot="";ae=F[F.l++];)Ot+=String.fromCharCode(ae);O.push('"'+Ot.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:oe=O.pop(),fe=O.pop(),O.push(["AND","OR"][ae-20]+"("+fe+","+oe+")");break;default:if(ae<32&&y[ae])oe=O.pop(),fe=O.pop(),O.push(fe+y[ae]+oe);else if(x[ae]){if(P=x[ae][1],P==69&&(P=F[F.l++]),P>O.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+O.join("|")+"|");return}var Ce=O.slice(-P);O.length-=P,O.push(x[ae][0]+"("+Ce.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}O.length==1?I[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function D(F){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=F.read_shift(2),I[3]=F[F.l++],I[0].c=F[F.l++],I}function L(F,I){var O=D(F);return O[1].t="s",O[1].v=F.read_shift(I-4,"cstr"),O}function C(F,I,O,P){var K=V(6+P.length);K.write_shift(2,F),K.write_shift(1,O),K.write_shift(1,I),K.write_shift(1,39);for(var ue=0;ue<P.length;++ue){var fe=P.charCodeAt(ue);K.write_shift(1,fe>=128?95:fe)}return K.write_shift(1,0),K}function b(F,I){var O=D(F);O[1].v=F.read_shift(2);var P=O[1].v>>1;if(O[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return O[1].v=P,O}function j(F,I){var O=D(F),P=F.read_shift(4),K=F.read_shift(4),ue=F.read_shift(2);if(ue==65535)return P===0&&K===3221225472?(O[1].t="e",O[1].v=15):P===0&&K===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var fe=ue&32768;return ue=(ue&32767)-16446,O[1].v=(1-fe*2)*(K*Math.pow(2,ue+32)+P*Math.pow(2,ue)),O}function z(F,I,O,P){var K=V(14);if(K.write_shift(2,F),K.write_shift(1,O),K.write_shift(1,I),P==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ue=0,fe=0,oe=0,ae=0;return P<0&&(ue=1,P=-P),fe=Math.log2(P)|0,P/=Math.pow(2,fe-31),ae=P>>>0,ae&2147483648||(P/=2,++fe,ae=P>>>0),P-=ae,ae|=2147483648,ae>>>=0,P*=Math.pow(2,32),oe=P>>>0,K.write_shift(4,oe),K.write_shift(4,ae),fe+=16383+(ue?32768:0),K.write_shift(2,fe),K}function X(F,I){var O=j(F);return F.l+=I-14,O}function R(F,I){var O=D(F),P=F.read_shift(4);return O[1].v=P>>6,O}function H(F,I){var O=D(F),P=F.read_shift(8,"f");return O[1].v=P,O}function ie(F,I){var O=H(F);return F.l+=I-10,O}function re(F,I){return F[F.l+I-1]==0?F.read_shift(I,"cstr"):""}function we(F,I){var O=F[F.l++];O>I-1&&(O=I-1);for(var P="";P.length<O;)P+=String.fromCharCode(F[F.l++]);return P}function Ee(F,I,O){if(!(!O.qpro||I<21)){var P=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var K=F.read_shift(I-21,"cstr");return[P,K]}}function te(F,I){for(var O={},P=F.l+I;F.l<P;){var K=F.read_shift(2);if(K==14e3){for(O[K]=[0,""],O[K][0]=F.read_shift(2);F[F.l];)O[K][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return O}function se(F,I){var O=V(5+F.length);O.write_shift(2,14e3),O.write_shift(2,I);for(var P=0;P<F.length;++P){var K=F.charCodeAt(P);O[O.l++]=K>127?95:K}return O[O.l++]=0,O}var pe={0:{n:"BOF",f:gg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:b},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),Vw=/^\s|\s$|[\t\n\r]/;function Eg(e,t){if(!t.bookSST)return"";var r=[nt];r[r.length]=Z("sst",null,{xmlns:ms[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Vw)&&(s+=' xml:space="preserve"'),s+=">"+De(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Gw(e){return[e.read_shift(4),e.read_shift(4)]}function Kw(e,t){return t||(t=V(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Xw=M_;function Yw(e){var t=Gt();Y(t,159,Kw(e));for(var r=0;r<e.length;++r)Y(t,19,Xw(e[r]));return Y(t,160),t.end()}function qw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Sg(e){var t=0,r,n=qw(e),i=n.length+1,s,a,o,l,c;for(r=ui(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var Jw=function(){function e(i,s){switch(s.type){case"base64":return t(sn(i),s);case"binary":return t(i,s);case"buffer":return t(Ne&&Buffer.isBuffer(i)?i.toString("binary"):Wa(i),s);case"array":return t(Jl(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(o)&&(o[d]=[]);for(var f=/\\\w+\b/g,p=0,v,m=-1;v=f.exec(u);){switch(v[0]){case"\\cell":var w=u.slice(p,f.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var g={v:w,t:"s"};Array.isArray(o)?o[d][m]=g:o[Ie({r:d,c:m})]=g}break}p=f.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=rt(c),o}function r(i,s){return mi(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=We(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var d=Ie({r:c,c:u});o=l?(i[c]||[])[u]:i[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(an(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Od(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Qw=6,Zr=Qw;function Tl(e){return Math.floor((e+Math.round(128/Zr)/256)*Zr)}function kl(e){return Math.floor((e-5)/Zr*100+.5)/100}function Yu(e){return Math.round((e*Zr+5)/Zr*256)/256}function xf(e){e.width?(e.wpx=Tl(e.width),e.wch=kl(e.wpx),e.MDW=Zr):e.wpx?(e.wch=kl(e.wpx),e.width=Yu(e.wch),e.MDW=Zr):typeof e.wch=="number"&&(e.width=Yu(e.wch),e.wpx=Tl(e.width),e.MDW=Zr),e.customWidth&&delete e.customWidth}var Zw=96,Tg=Zw;function Al(e){return e*96/Tg}function kg(e){return e*Tg/96}function eE(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Z("numFmt",null,{numFmtId:n,formatCode:De(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Z("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function tE(e){var t=[];return t[t.length]=Z("cellXfs",null),e.forEach(function(r){t[t.length]=Z("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Z("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Ag(e,t){var r=[nt,Z("styleSheet",null,{xmlns:ms[0],"xmlns:vt":ut.vt})],n;return e.SSF&&(n=eE(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=tE(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function rE(e,t){var r=e.read_shift(2),n=Ct(e);return[r,n]}function nE(e,t,r){r||(r=V(6+4*t.length)),r.write_shift(2,e),ht(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function iE(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=V_(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=H_(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ct(e),n}function sE(e,t){t||(t=V(25+4*32)),t.write_shift(2,e.sz*20),G_(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),El(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),ht(e.name,t),t.length>t.l?t.slice(0,t.l):t}var aE=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$c,oE=Ur;function Rd(e,t){t||(t=V(4*3+8*7+16*1)),$c||($c=sf(aE));var r=$c[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(El({auto:1},t),El({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function lE(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function Ng(e,t,r){r||(r=V(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ps(e,t){return t||(t=V(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var cE=Ur;function uE(e,t){return t||(t=V(51)),t.write_shift(1,0),Ps(null,t),Ps(null,t),Ps(null,t),Ps(null,t),Ps(null,t),t.length>t.l?t.slice(0,t.l):t}function fE(e,t){return t||(t=V(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),wl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function hE(e,t,r){var n=V(2052);return n.write_shift(4,e),wl(t,n),wl(r,n),n.length>n.l?n.slice(0,n.l):n}function dE(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Y(e,615,Fr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Y(e,44,nE(i,t[i]))}),Y(e,616))}}function pE(e){var t=1;Y(e,611,Fr(t)),Y(e,43,sE({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Y(e,612)}function mE(e){var t=2;Y(e,603,Fr(t)),Y(e,45,Rd({patternType:"none"})),Y(e,45,Rd({patternType:"gray125"})),Y(e,604)}function gE(e){var t=1;Y(e,613,Fr(t)),Y(e,46,uE()),Y(e,614)}function xE(e){var t=1;Y(e,626,Fr(t)),Y(e,47,Ng({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Y(e,627)}function vE(e,t){Y(e,617,Fr(t.length)),t.forEach(function(r){Y(e,47,Ng(r,0))}),Y(e,618)}function yE(e){var t=1;Y(e,619,Fr(t)),Y(e,48,fE({xfId:0,builtinId:0,name:"Normal"})),Y(e,620)}function _E(e){var t=0;Y(e,505,Fr(t)),Y(e,506)}function wE(e){var t=0;Y(e,508,hE(t,"TableStyleMedium9","PivotStyleMedium4")),Y(e,509)}function EE(e,t){var r=Gt();return Y(r,278),dE(r,e.SSF),pE(r),mE(r),gE(r),xE(r),vE(r,t.cellXfs),yE(r),_E(r),wE(r),Y(r,279),r.end()}function Cg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[nt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function SE(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ct(e)}}function TE(e){var t=V(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ht(e.name,t),t.slice(0,t.l)}function kE(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function AE(e){var t=V(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function NE(e,t){var r=V(8+2*t.length);return r.write_shift(4,e),ht(t,r),r.slice(0,r.l)}function CE(e){return e.l+=4,e.read_shift(4)!=0}function FE(e,t){var r=V(8);return r.write_shift(4,e),r.write_shift(4,1),r}function OE(){var e=Gt();return Y(e,332),Y(e,334,Fr(1)),Y(e,335,TE({name:"XLDAPR",version:12e4,flags:3496657072})),Y(e,336),Y(e,339,NE(1,"XLDAPR")),Y(e,52),Y(e,35,Fr(514)),Y(e,4096,Fr(0)),Y(e,4097,lr(1)),Y(e,36),Y(e,53),Y(e,340),Y(e,337,FE(1)),Y(e,51,AE([[1,0]])),Y(e,338),Y(e,333),e.end()}function Fg(){var e=[nt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function RE(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ie(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Gi=1024;function Og(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Z("xml",null,{"xmlns:v":Qt.v,"xmlns:o":Qt.o,"xmlns:x":Qt.x,"xmlns:mv":Qt.mv}).replace(/\/>/,">"),Z("o:shapelayout",Z("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Z("v:shapetype",[Z("v:stroke",null,{joinstyle:"miter"}),Z("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gi<e*1e3;)Gi+=1e3;return t.forEach(function(s){var a=ft(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Z("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Z("v:fill",l,o),u={on:"t",obscured:"t"};++Gi,i=i.concat(["<v:shape"+Ra({id:"_x0000_s"+Gi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Z("v:shadow",null,u),Z("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",vt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),vt("x:AutoFill","False"),vt("x:Row",String(a.r)),vt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Rg(e){var t=[nt,Z("comments",null,{xmlns:ms[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=De(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(De(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(vt("t",De(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(vt("t",De(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function PE(e,t,r){var n=[nt,Z("ThreadedComments",null,{xmlns:ut.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(Z("threadedComment",vt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function DE(e){var t=[nt,Z("personList",null,{xmlns:ut.TCMNT,"xmlns:x":ms[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Z("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function bE(e){var t={};t.iauthor=e.read_shift(4);var r=yi(e);return t.rfx=r.s,t.ref=Ie(r.s),e.l+=16,t}function IE(e,t){return t==null&&(t=V(36)),t.write_shift(4,e[1].iauthor),xs(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var jE=Ct;function LE(e){return ht(e.slice(0,54))}function ME(e){var t=Gt(),r=[];return Y(t,628),Y(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Y(t,632,LE(i.a)))})}),Y(t,631),Y(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:ft(n[0]),e:ft(n[0])};Y(t,635,IE([s,i])),i.t&&i.t.length>0&&Y(t,637,U_(i)),Y(t,636),delete i.iauthor})}),Y(t,634),Y(t,629),t.end()}function BE(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&je.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var Pg=["xlsb","xlsm","xlam","biff8","xla"],UE=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+Nt(u)+(l?"":"$")+_t(c)}return function(i,s){return t=s,i.replace(e,r)}}(),vf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yf=function(){return function(t,r){return t.replace(vf,function(n,i,s,a,o,l){var c=hf(a)-(s?0:r.c),u=ff(l)-(o?0:r.r),d=u==0?"":o?u+1:"["+u+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+d+"C"+f})}}();function $E(e,t){return e.replace(vf,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Nt(hf(s)+t.c))+(a=="$"?a+o:_t(ff(o)+t.r))})}function WE(e){return e.length!=1}function et(e){e.l+=1}function bn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Dg(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return bg(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=bn(e),o=bn(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function bg(e){var t=bn(e),r=bn(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function zE(e,t,r){if(r.biff<8)return bg(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=bn(e),a=bn(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Ig(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return HE(e);var n=e.read_shift(r&&r.biff==12?4:2),i=bn(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function HE(e){var t=bn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function VE(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function GE(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return KE(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function KE(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function XE(e,t,r){var n=(e[e.l++]&96)>>5,i=Dg(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function YE(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=Dg(e,s,r);return[n,i,a]}function qE(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function JE(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function QE(e,t,r){var n=(e[e.l++]&96)>>5,i=zE(e,t-1,r);return[n,i]}function ZE(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Pd(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function eS(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function tS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function rS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function nS(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function iS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function jg(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function sS(e){return e.read_shift(2),jg(e)}function aS(e){return e.read_shift(2),jg(e)}function oS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Ig(e,0,r);return[n,i]}function lS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=GE(e,0,r);return[n,i]}function cS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Ig(e,0,r);return[n,i,s]}function uS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[uT[i],Bg[i],n]}function fS(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:hS(e);return[i,(s[0]===0?Bg:cT)[s[1]]]}function hS(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function dS(e,t,r){e.l+=r&&r.biff==2?3:4}function pS(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function mS(e){return e.l++,Va[e.read_shift(1)]}function gS(e){return e.l++,e.read_shift(2)}function xS(e){return e.l++,e.read_shift(1)!==0}function vS(e){return e.l++,vs(e)}function yS(e,t,r){return e.l++,vg(e,t-1,r)}function _S(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=cw(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Va[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=vs(e);break;case 2:r[1]=dw(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function wS(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?yi:gw)(e));return i}function ES(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=_S(e,r.biff);return a}function SS(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function TS(e,t,r){if(r.biff==5)return kS(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function kS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function AS(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function NS(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function CS(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function FS(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var OS=Ur,RS=Ur,PS=Ur;function Ga(e,t,r){return e.l+=2,[VE(e)]}function _f(e){return e.l+=6,[]}var DS=Ga,bS=_f,IS=_f,jS=Ga;function Lg(e){return e.l+=2,[gg(e),e.read_shift(2)&1]}var LS=Ga,MS=Lg,BS=_f,US=Ga,$S=Ga,WS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zS(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=WS[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function HS(e){return e.l+=2,[e.read_shift(4)]}function VS(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function GS(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function KS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function XS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function YS(e){return e.l+=4,[0,0]}var Dd={1:{n:"PtgExp",f:pS},2:{n:"PtgTbl",f:PS},3:{n:"PtgAdd",f:et},4:{n:"PtgSub",f:et},5:{n:"PtgMul",f:et},6:{n:"PtgDiv",f:et},7:{n:"PtgPower",f:et},8:{n:"PtgConcat",f:et},9:{n:"PtgLt",f:et},10:{n:"PtgLe",f:et},11:{n:"PtgEq",f:et},12:{n:"PtgGe",f:et},13:{n:"PtgGt",f:et},14:{n:"PtgNe",f:et},15:{n:"PtgIsect",f:et},16:{n:"PtgUnion",f:et},17:{n:"PtgRange",f:et},18:{n:"PtgUplus",f:et},19:{n:"PtgUminus",f:et},20:{n:"PtgPercent",f:et},21:{n:"PtgParen",f:et},22:{n:"PtgMissArg",f:et},23:{n:"PtgStr",f:yS},26:{n:"PtgSheet",f:VS},27:{n:"PtgEndSheet",f:GS},28:{n:"PtgErr",f:mS},29:{n:"PtgBool",f:xS},30:{n:"PtgInt",f:gS},31:{n:"PtgNum",f:vS},32:{n:"PtgArray",f:ZE},33:{n:"PtgFunc",f:uS},34:{n:"PtgFuncVar",f:fS},35:{n:"PtgName",f:SS},36:{n:"PtgRef",f:oS},37:{n:"PtgArea",f:XE},38:{n:"PtgMemArea",f:AS},39:{n:"PtgMemErr",f:OS},40:{n:"PtgMemNoMem",f:RS},41:{n:"PtgMemFunc",f:NS},42:{n:"PtgRefErr",f:CS},43:{n:"PtgAreaErr",f:qE},44:{n:"PtgRefN",f:lS},45:{n:"PtgAreaN",f:QE},46:{n:"PtgMemAreaN",f:KS},47:{n:"PtgMemNoMemN",f:XS},57:{n:"PtgNameX",f:TS},58:{n:"PtgRef3d",f:cS},59:{n:"PtgArea3d",f:YE},60:{n:"PtgRefErr3d",f:FS},61:{n:"PtgAreaErr3d",f:JE},255:{}},qS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JS={1:{n:"PtgElfLel",f:Lg},2:{n:"PtgElfRw",f:US},3:{n:"PtgElfCol",f:DS},6:{n:"PtgElfRwV",f:$S},7:{n:"PtgElfColV",f:jS},10:{n:"PtgElfRadical",f:LS},11:{n:"PtgElfRadicalS",f:BS},13:{n:"PtgElfColS",f:bS},15:{n:"PtgElfColSV",f:IS},16:{n:"PtgElfRadicalLel",f:MS},25:{n:"PtgList",f:zS},29:{n:"PtgSxName",f:HS},255:{}},QS={0:{n:"PtgAttrNoop",f:YS},1:{n:"PtgAttrSemi",f:iS},2:{n:"PtgAttrIf",f:rS},4:{n:"PtgAttrChoose",f:eS},8:{n:"PtgAttrGoto",f:tS},16:{n:"PtgAttrSum",f:dS},32:{n:"PtgAttrBaxcel",f:Pd},33:{n:"PtgAttrBaxcel",f:Pd},64:{n:"PtgAttrSpace",f:sS},65:{n:"PtgAttrSpaceSemi",f:aS},128:{n:"PtgAttrIfError",f:nS},255:{}};function ZS(e,t,r,n){if(n.biff<8)return Ur(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=ES(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=wS(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Ur(e,t)),s}function eT(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Dd[s]||Dd[qS[s]],(s===24||s===25)&&(i=(s===24?JS:QS)[e[e.l+1]]),!i||!i.f?Ur(e,t):a.push([i.n,i.f(e,t,r)]);return a}function tT(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var rT={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nT(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Mg(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function bd(e,t,r){var n=Mg(e,t,r);return n=="#REF"?n:nT(n,r)}function us(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,d=0,f=0,p,v="";if(!e[0]||!e[0][0])return"";for(var m=-1,w="",g=0,x=e[0].length;g<x;++g){var y=e[0][g];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:w=Je(" ",e[0][m][1][1]);break;case 1:w=Je("\r",e[0][m][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+w,m=-1}o.push(c+rT[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=na(y[1][1],a,i),o.push(ia(u,s));break;case"PtgRefN":u=r?na(y[1][1],r,i):y[1][1],o.push(ia(u,s));break;case"PtgRef3d":d=y[1][1],u=na(y[1][2],a,i),v=bd(n,d,i),o.push(v+"!"+ia(u,s));break;case"PtgFunc":case"PtgFuncVar":var k=y[1][0],D=y[1][1];k||(k=0),k&=127;var L=k==0?[]:o.slice(-k);o.length-=k,D==="User"&&(D=L.shift()),o.push(D+"("+L.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=vd(y[1][1],r?{s:r}:a,i),o.push(Bc(p,i));break;case"PtgArea":p=vd(y[1][1],a,i),o.push(Bc(p,i));break;case"PtgArea3d":d=y[1][1],p=y[1][2],v=bd(n,d,i),o.push(v+"!"+Bc(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var C=(n.names||[])[f-1]||(n[0]||[])[f],b=C?C.Name:"SH33TJSNAME"+String(f);b&&b.slice(0,6)=="_xlfn."&&!i.xlfn&&(b=b.slice(6)),o.push(b);break;case"PtgNameX":var j=y[1][1];f=y[1][2];var z;if(i.biff<=5)j<0&&(j=-j),n[j]&&(z=n[j][f]);else{var X="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][f]&&n[j][f].itab>0&&(X=n.SheetNames[n[j][f].itab-1]+"!"):X=n.SheetNames[f-1]+"!"),n[j]&&n[j][f])X+=n[j][f].Name;else if(n[0]&&n[0][f])X+=n[0][f].Name;else{var R=(Mg(n,j,i)||"").split(";;");R[f-1]?X=R[f-1]:X+="SH33TJSERRX"}o.push(X);break}z||(z={Name:"SH33TJSERRY"}),o.push(z.Name);break;case"PtgParen":var H="(",ie=")";if(m>=0){switch(w="",e[0][m][1][0]){case 2:H=Je(" ",e[0][m][1][1])+H;break;case 3:H=Je("\r",e[0][m][1][1])+H;break;case 4:ie=Je(" ",e[0][m][1][1])+ie;break;case 5:ie=Je("\r",e[0][m][1][1])+ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(H+o.pop()+ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[Ie(u)]){var we=n.sharedf[Ie(u)];o.push(us(we,a,re,n,i))}else{var Ee=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(us(c[1],a,re,n,i)),Ee=!0;break}Ee||o.push(y[1])}break;case"PtgArray":o.push("{"+tT(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&te.indexOf(e[0][g][0])==-1){y=e[0][m];var se=!0;switch(y[1][0]){case 4:se=!1;case 0:w=Je(" ",y[1][1]);break;case 5:se=!1;case 1:w=Je("\r",y[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((se?w:"")+o.pop()+(se?"":w)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function iT(e){if(e==null){var t=V(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return fi(e);return fi(0)}function sT(e,t,r,n,i){var s=hi(t,r,i),a=iT(e.v),o=V(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=V(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var d=xt([s,a,o,c]);return d}function Ql(e,t,r){var n=e.read_shift(4),i=eT(e,n,r),s=e.read_shift(4),a=s>0?ZS(e,s,i,r):null;return[i,a]}var aT=Ql,Zl=Ql,oT=Ql,lT=Ql,cT={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Bg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},uT={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function fT(e){var t="of:="+e.replace(vf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function hT(e){return e.replace(/\./,"!")}var sa=typeof Map<"u";function wf(e,t,r){var n=0,i=e.length;if(r){if(sa?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=sa?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(sa?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function ec(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Zr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=kl(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Yu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ug(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Bn(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Im(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function dT(e,t,r){if(e&&e["!ref"]){var n=We(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function pT(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+rt(e[r])+'"/>';return t+"</mergeCells>"}function mT(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Oa(De(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Z("outlinePr",null,c)}!s&&!o||(i[i.length]=Z("sheetPr",o,a))}var gT=["objects","scenarios","selectLockedCells","selectUnlockedCells"],xT=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function vT(e){var t={sheet:1};return gT.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),xT.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Sg(e.password).toString(16).toUpperCase()),Z("sheetProtection",null,t)}function yT(e){return Ug(e),Z("pageMargins",null,e)}function _T(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Z("col",null,ec(i,n)));return r[r.length]="</cols>",r.join("")}function wT(e,t,r,n){var i=typeof e.ref=="string"?e.ref:rt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=nr(i);a.s.r==a.e.r&&(a.e.r=nr(t["!ref"]).e.r,i=rt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Z("autoFilter",null,{ref:i})}function ET(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Z("sheetViews",Z("sheetView",null,i),{})}function ST(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Va[e.v];break;case"d":n&&n.cellDates?i=jt(e.v,-1).toISOString():(e=Xt(e),e.t="n",i=""+(e.v=Kt(jt(e.v)))),typeof e.z>"u"&&(e.z=Qe[14]);break;default:i=e.v;break}var o=vt("v",De(i)),l={r:t},c=Bn(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=vt("v",""+wf(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Z("f",De(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Z("c",o,l)}function TT(e,t,r,n){var i=[],s=[],a=We(e["!ref"]),o="",l,c="",u=[],d=0,f=0,p=e["!rows"],v=Array.isArray(e),m={r:c},w,g=-1;for(f=a.s.c;f<=a.e.c;++f)u[f]=Nt(f);for(d=a.s.r;d<=a.e.r;++d){for(s=[],c=_t(d),f=a.s.c;f<=a.e.c;++f){l=u[f]+c;var x=v?(e[d]||[])[f]:e[l];x!==void 0&&(o=ST(x,l,e,t))!=null&&s.push(o)}(s.length>0||p&&p[d])&&(m={r:c},p&&p[d]&&(w=p[d],w.hidden&&(m.hidden=1),g=-1,w.hpx?g=Al(w.hpx):w.hpt&&(g=w.hpt),g>-1&&(m.ht=g,m.customHeight=1),w.level&&(m.outlineLevel=w.level)),i[i.length]=Z("row",s.join(""),m))}if(p)for(;d<p.length;++d)p&&p[d]&&(m={r:d+1},w=p[d],w.hidden&&(m.hidden=1),g=-1,w.hpx?g=Al(w.hpx):w.hpt&&(g=w.hpt),g>-1&&(m.ht=g,m.customHeight=1),w.level&&(m.outlineLevel=w.level),i[i.length]=Z("row","",m));return i.join("")}function $g(e,t,r,n){var i=[nt,Z("worksheet",null,{xmlns:ms[0],"xmlns:r":ut.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=We(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=rt(u)}n||(n={}),l["!comments"]=[];var d=[];mT(l,r,e,t,i),i[i.length]=Z("dimension",null,{ref:c}),i[i.length]=ET(l,t,e,r),t.sheetFormat&&(i[i.length]=Z("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=_T(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=TT(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=vT(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=wT(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=pT(l["!merges"]));var f=-1,p,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(v=Pe(n,-1,De(m[1].Target).replace(/#.*$/,""),ke.HLINK),p["r:id"]="rId"+v),(f=m[1].Target.indexOf("#"))>-1&&(p.location=De(m[1].Target.slice(f+1))),m[1].Tooltip&&(p.tooltip=De(m[1].Tooltip)),i[i.length]=Z("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=yT(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=vt("ignoredErrors",Z("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(v=Pe(n,-1,"../drawings/drawing"+(e+1)+".xml",ke.DRAW),i[i.length]=Z("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=d),l["!comments"].length>0&&(v=Pe(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ke.VML),i[i.length]=Z("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function kT(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function AT(e,t,r){var n=V(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Al(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,f=-1,p=u<<10;p<u+1<<10;++p){c.c=p;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ie(c)];v&&(d<0&&(d=p),f=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,f))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function NT(e,t,r,n){var i=AT(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Y(e,0,i)}var CT=yi,FT=xs;function OT(){}function RT(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=$_(e),r}function PT(e,t,r){r==null&&(r=V(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return El({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),rg(e,r),r.slice(0,r.l)}function DT(e){var t=gr(e);return[t]}function bT(e,t,r){return r==null&&(r=V(8)),gi(t,r)}function IT(e){var t=xi(e);return[t]}function jT(e,t,r){return r==null&&(r=V(4)),vi(t,r)}function LT(e){var t=gr(e),r=e.read_shift(1);return[t,r,"b"]}function MT(e,t,r){return r==null&&(r=V(9)),gi(t,r),r.write_shift(1,e.v?1:0),r}function BT(e){var t=xi(e),r=e.read_shift(1);return[t,r,"b"]}function UT(e,t,r){return r==null&&(r=V(5)),vi(t,r),r.write_shift(1,e.v?1:0),r}function $T(e){var t=gr(e),r=e.read_shift(1);return[t,r,"e"]}function WT(e,t,r){return r==null&&(r=V(9)),gi(t,r),r.write_shift(1,e.v),r}function zT(e){var t=xi(e),r=e.read_shift(1);return[t,r,"e"]}function HT(e,t,r){return r==null&&(r=V(8)),vi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function VT(e){var t=gr(e),r=e.read_shift(4);return[t,r,"s"]}function GT(e,t,r){return r==null&&(r=V(12)),gi(t,r),r.write_shift(4,t.v),r}function KT(e){var t=xi(e),r=e.read_shift(4);return[t,r,"s"]}function XT(e,t,r){return r==null&&(r=V(8)),vi(t,r),r.write_shift(4,t.v),r}function YT(e){var t=gr(e),r=vs(e);return[t,r,"n"]}function qT(e,t,r){return r==null&&(r=V(16)),gi(t,r),fi(e.v,r),r}function JT(e){var t=xi(e),r=vs(e);return[t,r,"n"]}function QT(e,t,r){return r==null&&(r=V(12)),vi(t,r),fi(e.v,r),r}function ZT(e){var t=gr(e),r=ng(e);return[t,r,"n"]}function e4(e,t,r){return r==null&&(r=V(12)),gi(t,r),ig(e.v,r),r}function t4(e){var t=xi(e),r=ng(e);return[t,r,"n"]}function r4(e,t,r){return r==null&&(r=V(8)),vi(t,r),ig(e.v,r),r}function n4(e){var t=gr(e),r=df(e);return[t,r,"is"]}function i4(e){var t=gr(e),r=Ct(e);return[t,r,"str"]}function s4(e,t,r){return r==null&&(r=V(12+4*e.v.length)),gi(t,r),ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function a4(e){var t=xi(e),r=Ct(e);return[t,r,"str"]}function o4(e,t,r){return r==null&&(r=V(8+4*e.v.length)),vi(t,r),ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function l4(e,t,r){var n=e.l+t,i=gr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Zl(e,n-e.l,r);a[3]=us(o,null,i,r.supbooks,r)}else e.l=n;return a}function c4(e,t,r){var n=e.l+t,i=gr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Zl(e,n-e.l,r);a[3]=us(o,null,i,r.supbooks,r)}else e.l=n;return a}function u4(e,t,r){var n=e.l+t,i=gr(e);i.r=r["!row"];var s=vs(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Zl(e,n-e.l,r);a[3]=us(o,null,i,r.supbooks,r)}else e.l=n;return a}function f4(e,t,r){var n=e.l+t,i=gr(e);i.r=r["!row"];var s=Ct(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Zl(e,n-e.l,r);a[3]=us(o,null,i,r.supbooks,r)}else e.l=n;return a}var h4=yi,d4=xs;function p4(e,t){return t==null&&(t=V(4)),t.write_shift(4,e),t}function m4(e,t){var r=e.l+t,n=yi(e),i=pf(e),s=Ct(e),a=Ct(e),o=Ct(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function g4(e,t){var r=V(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));xs({s:ft(e[0]),e:ft(e[0])},r),mf("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return ht(i||"",r),ht(e[1].Tooltip||"",r),ht("",r),r.slice(0,r.l)}function x4(){}function v4(e,t,r){var n=e.l+t,i=sg(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=aT(e,n-e.l,r);a[1]=o}else e.l=n;return a}function y4(e,t,r){var n=e.l+t,i=yi(e),s=[i];if(r.cellFormula){var a=lT(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function _4(e,t,r){r==null&&(r=V(18));var n=ec(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var Wg=["left","right","top","bottom","header","footer"];function w4(e){var t={};return Wg.forEach(function(r){t[r]=vs(e)}),t}function E4(e,t){return t==null&&(t=V(6*8)),Ug(e),Wg.forEach(function(r){fi(e[r],t)}),t}function S4(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function T4(e,t,r){r==null&&(r=V(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function k4(e){var t=V(24);return t.write_shift(4,4),t.write_shift(4,1),xs(e,t),t}function A4(e,t){return t==null&&(t=V(16*4+2)),t.write_shift(2,e.password?Sg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function N4(){}function C4(){}function F4(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Xt(t),t.z=t.z||Qe[14],t.v=Kt(jt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Bn(i.cellXfs,t,i),t.l&&s["!links"].push([Ie(l),t.l]),t.c&&s["!comments"].push([Ie(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=wf(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?Y(e,18,XT(t,l)):Y(e,7,GT(t,l))):(l.t="str",a?Y(e,17,o4(t,l)):Y(e,6,s4(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Y(e,13,r4(t,l)):Y(e,2,e4(t,l)):a?Y(e,16,QT(t,l)):Y(e,5,qT(t,l)),!0;case"b":return l.t="b",a?Y(e,15,UT(t,l)):Y(e,4,MT(t,l)),!0;case"e":return l.t="e",a?Y(e,14,HT(t,l)):Y(e,3,WT(t,l)),!0}return a?Y(e,12,jT(t,l)):Y(e,1,bT(t,l)),!0}function O4(e,t,r,n){var i=We(t["!ref"]||"A1"),s,a="",o=[];Y(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){a=_t(u),NT(e,t,i,u);var d=!1;if(u<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(o[f]=Nt(f)),s=o[f]+a;var p=l?(t[u]||[])[f]:t[s];if(!p){d=!1;continue}d=F4(e,p,u,f,n,t,d)}}Y(e,146)}function R4(e,t){!t||!t["!merges"]||(Y(e,177,p4(t["!merges"].length)),t["!merges"].forEach(function(r){Y(e,176,d4(r))}),Y(e,178))}function P4(e,t){!t||!t["!cols"]||(Y(e,390),t["!cols"].forEach(function(r,n){r&&Y(e,60,_4(n,r))}),Y(e,391))}function D4(e,t){!t||!t["!ref"]||(Y(e,648),Y(e,649,k4(We(t["!ref"]))),Y(e,650))}function b4(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Pe(r,-1,n[1].Target.replace(/#.*$/,""),ke.HLINK);Y(e,494,g4(n,i))}}),delete t["!links"]}function I4(e,t,r,n){if(t["!comments"].length>0){var i=Pe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ke.VML);Y(e,551,mf("rId"+i)),t["!legacy"]=i}}function j4(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:rt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=nr(s);o.s.r==o.e.r&&(o.e.r=nr(t["!ref"]).e.r,s=rt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Y(e,161,xs(We(s))),Y(e,162)}}function L4(e,t,r){Y(e,133),Y(e,137,T4(t,r)),Y(e,138),Y(e,134)}function M4(e,t){t["!protect"]&&Y(e,535,A4(t["!protect"]))}function B4(e,t,r,n){var i=Gt(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=We(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Y(i,129),(r.vbaraw||a["!outline"])&&Y(i,147,PT(o,a["!outline"])),Y(i,148,FT(l)),L4(i,a,r.Workbook),P4(i,a),O4(i,a,e,t),M4(i,a),j4(i,a,r,e),R4(i,a),b4(i,a,n),a["!margins"]&&Y(i,476,E4(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&D4(i,a),I4(i,a,e,n),Y(i,130),i.end()}function U4(e,t){e.l+=10;var r=Ct(e);return{name:r}}var $4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function W4(e){return!e.Workbook||!e.Workbook.WBProps?"false":y_(e.Workbook.WBProps.date1904)?"true":"false"}var z4="][*?/\\".split("");function zg(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return z4.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function H4(e,t,r){e.forEach(function(n,i){zg(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function V4(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];H4(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)dT(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Hg(e){var t=[nt];t[t.length]=Z("workbook",null,{xmlns:ms[0],"xmlns:r":ut.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&($4.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Z("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:De(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=Z("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Z("definedName",De(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function G4(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Xu(e),r.name=Ct(e),r}function K4(e,t){return t||(t=V(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),mf(e.strRelID,t),ht(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function X4(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Ct(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Y4(e,t){t||(t=V(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),rg(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function q4(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=W_(e),a=oT(e,0,r),o=pf(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function J4(e,t){Y(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Y(e,156,K4(i))}Y(e,144)}function Q4(e,t){t||(t=V(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ht("SheetJS",t),ht(ml.version,t),ht(ml.version,t),ht("7262",t),t.length>t.l?t.slice(0,t.l):t}function Z4(e,t){t||(t=V(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ek(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Y(e,135),Y(e,158,Z4(i)),Y(e,136))}}function tk(e,t){var r=Gt();return Y(r,131),Y(r,128,Q4()),Y(r,153,Y4(e.Workbook&&e.Workbook.WBProps||null)),ek(r,e),J4(r,e),Y(r,132),r.end()}function rk(e,t,r){return(t.slice(-4)===".bin"?tk:Hg)(e)}function nk(e,t,r,n,i){return(t.slice(-4)===".bin"?B4:$g)(e,r,n,i)}function ik(e,t,r){return(t.slice(-4)===".bin"?EE:Ag)(e,r)}function sk(e,t,r){return(t.slice(-4)===".bin"?Yw:Eg)(e,r)}function ak(e,t,r){return(t.slice(-4)===".bin"?ME:Rg)(e)}function ok(e){return(e.slice(-4)===".bin"?OE:Fg)()}function lk(e,t){var r=[];return e.Props&&r.push(iw(e.Props,t)),e.Custprops&&r.push(sw(e.Props,e.Custprops)),r.join("")}function ck(){return""}function uk(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(Z("NumberFormat",null,{"ss:Format":De(Qe[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(Z("Style",s.join(""),a))}),Z("Styles",r.join(""))}function Vg(e){return Z("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+yf(e.Ref,{r:0,c:0})})}function fk(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Vg(i)))}return Z("Names",r.join(""))}function hk(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Vg(o)))}return s.join("")}function dk(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Z("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Z("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Z("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Z("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(vt("ProtectContents","True")),e["!protect"].objects&&i.push(vt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(vt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(vt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(vt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Z("WorksheetOptions",i.join(""),{xmlns:Qt.x})}function pk(e){return e.map(function(t){var r=v_(t.t||""),n=Z("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Z("Comment",n,{"ss:Author":t.a})}).join("")}function mk(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+De(yf(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=ft(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=De(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=De(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",f=String(e.v);break;case"b":d="Boolean",f=e.v?"1":"0";break;case"e":d="Error",f=Va[e.v];break;case"d":d="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Qe[14]);break;case"s":d="String",f=x_(e.v||"");break}var p=Bn(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var v=e.v!=null?f:"",m=e.t=="z"?"":'<Data ss:Type="'+d+'">'+v+"</Data>";return(e.c||[]).length>0&&(m+=pk(e.c)),Z("Cell",m,o)}function gk(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=kg(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function xk(e,t,r,n){if(!e["!ref"])return"";var i=We(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,g){xf(w);var x=!!w.width,y=ec(g,w),k={"ss:Index":g+1};x&&(k["ss:Width"]=Tl(y.width)),w.hidden&&(k["ss:Hidden"]="1"),o.push(Z("Column",null,k))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[gk(c,(e["!rows"]||[])[c])],d=i.s.c;d<=i.e.c;++d){var f=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>d)&&!(s[a].s.r>c)&&!(s[a].e.c<d)&&!(s[a].e.r<c)){(s[a].s.c!=d||s[a].s.r!=c)&&(f=!0);break}if(!f){var p={r:c,c:d},v=Ie(p),m=l?(e[c]||[])[d]:e[v];u.push(mk(m,v,e,t,r,n,p))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function vk(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?hk(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?xk(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(dk(s,t,e,r)),n.join("")}function yk(e,t){t||(t={}),e.SSF||(e.SSF=Xt(Qe)),e.SSF&&(Yl(),Xl(e.SSF),t.revssf=ql(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Bn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(lk(e,t)),r.push(ck()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Z("Worksheet",vk(n,t,e),{"ss:Name":De(e.SheetNames[n])}));return r[2]=uk(e,t),r[3]=fk(e),nt+Z("Workbook",r.join(""),{xmlns:Qt.ss,"xmlns:o":Qt.o,"xmlns:x":Qt.x,"xmlns:ss":Qt.ss,"xmlns:dt":Qt.dt,"xmlns:html":Qt.html})}var Wc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _k(e,t){var r=[],n=[],i=[],s=0,a,o=od(_d,"n"),l=od(wd,"n");if(e.Props)for(a=Et(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=Et(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)mg.indexOf(i[s][0])>-1||hg.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&je.utils.cfb_add(t,"/SummaryInformation",Ad(n,Wc.SI,l,wd)),(r.length||c.length)&&je.utils.cfb_add(t,"/DocumentSummaryInformation",Ad(r,Wc.DSI,o,_d,c.length?c:null,Wc.UDI))}function wk(e,t){var r=t||{},n=je.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return je.utils.cfb_add(n,i,Gg(e,r)),r.biff==8&&(e.Props||e.Custprops)&&_k(e,n),r.biff==8&&e.vbaraw&&BE(n,je.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Ek={0:{f:kT},1:{f:DT},2:{f:ZT},3:{f:$T},4:{f:LT},5:{f:YT},6:{f:i4},7:{f:VT},8:{f:f4},9:{f:u4},10:{f:l4},11:{f:c4},12:{f:IT},13:{f:t4},14:{f:zT},15:{f:BT},16:{f:JT},17:{f:a4},18:{f:KT},19:{f:df},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:q4},40:{},42:{},43:{f:iE},44:{f:rE},45:{f:oE},46:{f:cE},47:{f:lE},48:{},49:{f:I_},50:{},51:{f:kE},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jw},62:{f:n4},63:{f:RE},64:{f:N4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ur,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:S4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:RT},148:{f:CT,p:16},151:{f:x4},152:{},153:{f:X4},154:{},155:{},156:{f:G4},157:{},158:{},159:{T:1,f:Gw},160:{T:-1},161:{T:1,f:yi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:h4},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SE},336:{T:-1},337:{f:CE,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Xu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ow},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:v4},427:{f:y4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:w4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:OT},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:m4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Xu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jE},633:{T:1},634:{T:-1},635:{T:1,f:bE},636:{T:-1},637:{f:B_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:U4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:C4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ee(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&uf(r)&&e.push(r)}}function Sk(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return ee(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Ka(e,t,r){return e||(e=V(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Tk(e,t,r,n){var i=V(9);return Ka(i,e,t),xg(r,n||"b",i),i}function kk(e,t,r){var n=V(8+2*r.length);return Ka(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Ak(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Kt(jt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ee(e,2,Uw(r,n,i)):ee(e,3,Bw(r,n,i));return;case"b":case"e":ee(e,5,Tk(r,n,t.v,t.t));return;case"s":case"str":ee(e,4,kk(r,n,(t.v||"").slice(0,255)));return}ee(e,1,Ka(null,r,n))}function Nk(e,t,r,n){var i=Array.isArray(t),s=We(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=rt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=_t(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=Nt(u)),a=l[u]+o;var d=i?(t[c]||[])[u]:t[a];d&&Ak(e,d,c,u)}}}function Ck(e,t){for(var r=t||{},n=Gt(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ee(n,r.biff==4?1033:r.biff==3?521:9,gf(e,16,r)),Nk(n,e.Sheets[e.SheetNames[i]],i,r),ee(n,10),n.end()}function Fk(e,t,r){ee(e,49,Ew({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function Ok(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&ee(e,1054,kw(i,t[i],r))})}function Rk(e,t){var r=V(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ee(e,2151,r),r=V(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_g(We(t["!ref"]||"A1"),r),r.write_shift(4,4),ee(e,2152,r)}function Pk(e,t){for(var r=0;r<16;++r)ee(e,224,Cd({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ee(e,224,Cd(n,0,t))})}function Dk(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ee(e,440,Dw(n)),n[1].Tooltip&&ee(e,2048,bw(n))}delete t["!links"]}function bk(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&ee(e,125,Lw(ec(i,n),i))})}}function Ik(e,t,r,n,i){var s=16+Bn(i.cellXfs,t,i);if(t.v==null&&!t.bf){ee(e,513,hi(r,n,s));return}if(t.bf)ee(e,6,sT(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?Kt(jt(t.v)):t.v;ee(e,515,Fw(r,n,a,s));break;case"b":case"e":ee(e,517,Cw(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=wf(i.Strings,t.v,i.revStrings);ee(e,253,Sw(r,n,o,s))}else ee(e,516,Tw(r,n,(t.v||"").slice(0,255),s,i));break;default:ee(e,513,hi(r,n,s))}}function jk(e,t,r){var n=Gt(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,d="",f=[],p=We(s["!ref"]||"A1"),v=c?65536:16384;if(p.e.c>255||p.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,v-1)}ee(n,2057,gf(r,16,t)),ee(n,13,lr(1)),ee(n,12,lr(100)),ee(n,15,bt(!0)),ee(n,17,bt(!1)),ee(n,16,fi(.001)),ee(n,95,bt(!0)),ee(n,42,bt(!1)),ee(n,43,bt(!1)),ee(n,130,lr(1)),ee(n,128,Nw()),ee(n,131,bt(!1)),ee(n,132,bt(!1)),c&&bk(n,s["!cols"]),ee(n,512,Aw(p,t)),c&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){d=_t(m);for(var w=p.s.c;w<=p.e.c;++w){m===p.s.r&&(f[w]=Nt(w)),u=f[w]+d;var g=l?(s[m]||[])[w]:s[u];g&&(Ik(n,g,m,w,t),c&&g.l&&s["!links"].push([u,g.l]))}}var x=o.CodeName||o.name||i;return c&&ee(n,574,ww((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&ee(n,229,Pw(s["!merges"])),c&&Dk(n,s),ee(n,442,yg(x)),c&&Rk(n,s),ee(n,10),n.end()}function Lk(e,t,r){var n=Gt(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(ee(n,2057,gf(e,5,r)),r.bookType=="xla"&&ee(n,135),ee(n,225,o?lr(1200):null),ee(n,193,lw(2)),l&&ee(n,191),l&&ee(n,192),ee(n,226),ee(n,92,xw("SheetJS",r)),ee(n,66,lr(o?1200:1252)),o&&ee(n,353,lr(0)),o&&ee(n,448),ee(n,317,Mw(e.SheetNames.length)),o&&e.vbaraw&&ee(n,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";ee(n,442,yg(c))}ee(n,156,lr(17)),ee(n,25,bt(!1)),ee(n,18,bt(!1)),ee(n,19,lr(0)),o&&ee(n,431,bt(!1)),o&&ee(n,444,lr(0)),ee(n,61,_w()),ee(n,64,bt(!1)),ee(n,141,lr(0)),ee(n,34,bt(W4(e)=="true")),ee(n,14,bt(!0)),o&&ee(n,439,bt(!1)),ee(n,218,lr(0)),Fk(n,e,r),Ok(n,e.SSF,r),Pk(n,r),o&&ee(n,352,bt(!1));var u=n.end(),d=Gt();o&&ee(d,140,Iw()),o&&r.Strings&&Sk(d,252,yw(r.Strings)),ee(d,10);var f=d.end(),p=Gt(),v=0,m=0;for(m=0;m<e.SheetNames.length;++m)v+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var w=u.length+v+f.length;for(m=0;m<e.SheetNames.length;++m){var g=s[m]||{};ee(p,133,vw({pos:w,hs:g.Hidden||0,dt:0,name:e.SheetNames[m]},r)),w+=t[m].length}var x=p.end();if(v!=x.length)throw new Error("BS8 "+v+" != "+x.length);var y=[];return u.length&&y.push(u),x.length&&y.push(x),f.length&&y.push(f),xt(y)}function Mk(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Xt(Qe)),e&&e.SSF&&(Yl(),Xl(e.SSF),r.revssf=ql(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ef(r),r.cellXfs=[],Bn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=jk(i,r,e);return n.unshift(Lk(e,n,r)),xt(n)}function Gg(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=nr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return Mk(e,t);case 4:case 3:case 2:return Ck(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Bk(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=Ie({r,c:a}),d=n.dense?(e[r]||[])[a]:e[u],f=d&&d.v!=null&&(d.h||g_(d.w||(an(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(Z("td",f,p))}}var v="<tr>";return v+s.join("")+"</tr>"}var Uk='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$k="</body></html>";function Wk(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Kg(e,t){var r=t||{},n=r.header!=null?r.header:Uk,i=r.footer!=null?r.footer:$k,s=[n],a=nr(e["!ref"]);r.dense=Array.isArray(e),s.push(Wk(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Bk(e,a,o,r));return s.push("</table>"+i),s.join("")}function Xg(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?ft(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=nr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var d=[],f=0,p=e["!rows"]||(e["!rows"]=[]),v=0,m=0,w=0,g=0,x=0,y=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&m<l;++v){var k=o[v];if(Id(k)){if(n.display)continue;p[m]={hidden:!0}}var D=k.children;for(w=g=0;w<D.length;++w){var L=D[w];if(!(n.display&&Id(L))){var C=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):__(L.innerHTML),b=L.getAttribute("data-z")||L.getAttribute("z");for(f=0;f<d.length;++f){var j=d[f];j.s.c==g+s&&j.s.r<m+i&&m+i<=j.e.r&&(g=j.e.c+1-s,f=-1)}y=+L.getAttribute("colspan")||1,((x=+L.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:m+i,c:g+s},e:{r:m+i+(x||1)-1,c:g+s+(y||1)-1}});var z={t:"s",v:C},X=L.getAttribute("data-t")||L.getAttribute("t")||"";C!=null&&(C.length==0?z.t=X||"z":n.raw||C.trim().length==0||X=="s"||(C==="TRUE"?z={t:"b",v:!0}:C==="FALSE"?z={t:"b",v:!1}:isNaN(Qr(C))?isNaN(Fa(C).getDate())||(z={t:"d",v:jt(C)},n.cellDates||(z={t:"n",v:Kt(z.v)}),z.z=n.dateNF||Qe[14]):z={t:"n",v:Qr(C)})),z.z===void 0&&b!=null&&(z.z=b);var R="",H=L.getElementsByTagName("A");if(H&&H.length)for(var ie=0;ie<H.length&&!(H[ie].hasAttribute("href")&&(R=H[ie].getAttribute("href"),R.charAt(0)!="#"));++ie);R&&R.charAt(0)!="#"&&(z.l={Target:R}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][g+s]=z):e[Ie({c:g+s,r:m+i})]=z,c.e.c<g+s&&(c.e.c=g+s),g+=y}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=rt(c),m>=l&&(e["!fullref"]=rt((c.e.r=o.length-v+m-1+i,c))),e}function Yg(e,t){var r=t||{},n=r.dense?[]:{};return Xg(n,e,t)}function zk(e,t){return mi(Yg(e,t),t)}function Id(e){var t="",r=Hk(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Hk(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Vk=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ra({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return nt+t}}(),jd=function(){var e=function(s){return De(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+De(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,d=nr(s["!ref"]||"A1"),f=s["!merges"]||[],p=0,v=Array.isArray(s);if(s["!cols"])for(u=0;u<=d.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",w=s["!rows"]||[];for(c=0;c<d.s.r;++c)m=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=d.e.r;++c){for(m=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),u=0;u<d.s.c;++u)l.push(t);for(;u<=d.e.c;++u){var g=!1,x={},y="";for(p=0;p!=f.length;++p)if(!(f[p].s.c>u)&&!(f[p].s.r>c)&&!(f[p].e.c<u)&&!(f[p].e.r<c)){(f[p].s.c!=u||f[p].s.r!=c)&&(g=!0),x["table:number-columns-spanned"]=f[p].e.c-f[p].s.c+1,x["table:number-rows-spanned"]=f[p].e.r-f[p].s.r+1;break}if(g){l.push(r);continue}var k=Ie({r:c,c:u}),D=v?(s[c]||[])[u]:s[k];if(D&&D.f&&(x["table:formula"]=De(fT(D.f)),D.F&&D.F.slice(0,k.length)==k)){var L=nr(D.F);x["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,x["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!D){l.push(t);continue}switch(D.t){case"b":y=D.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=D.v?"true":"false";break;case"n":y=D.w||String(D.v||0),x["office:value-type"]="float",x["office:value"]=D.v||0;break;case"s":case"str":y=D.v==null?"":D.v,x["office:value-type"]="string";break;case"d":y=D.w||jt(D.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=jt(D.v).toISOString(),x["table:style-name"]="ce1";break;default:l.push(t);continue}var C=e(y);if(D.l&&D.l.Target){var b=D.l.Target;b=b.charAt(0)=="#"?"#"+hT(b.slice(1)):b,b.charAt(0)!="#"&&!b.match(/^\w+:/)&&(b="../"+b),C=Z("text:a",C,{"xlink:href":b.replace(/&/g,"&amp;")})}l.push("          "+Z("table:table-cell",Z("text:p",C,{}),x)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var d=c["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;xf(d),d.ods=o;var f=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var d=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[nt],c=Ra({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ra({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(ug().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)l.push(n(a.Sheets[a.SheetNames[d]],a,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function qg(e,t){if(t.bookType=="fods")return jd(e,t);var r=af(),n="",i=[],s=[];return n="mimetype",xe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",xe(r,n,jd(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",xe(r,n,Vk(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",xe(r,n,nt+ug()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",xe(r,n,nw(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",xe(r,n,tw(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Nl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Gk(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):kr(Oa(e))}function Kk(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function In(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Xk(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function Pa(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Re(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function rs(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function st(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Pa(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Pa(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function pt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Re(n*8+i.type)),i.type==2&&t.push(Re(i.data.length)),t.push(i.data))})}),In(t)}function vr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Pa(e,n),s=st(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:rs(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=st(o.data),c=rs(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=rs(s[3][0].data)>>>0>0),r.push(a)}return r}function Ti(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Re(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Re(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Re(a.data.length)}],n[2].push({data:pt(a.meta),type:2})});var s=pt(n);t.push(Re(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),In(t)}function Yk(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Pa(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[In(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=In(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function yr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Yk(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return In(t)}function ki(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Re(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return In(t)}function zc(e,t){var r=new Uint8Array(32),n=Nl(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Xk(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Hc(e,t){var r=new Uint8Array(32),n=Nl(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function un(e){var t=st(e);return Pa(t[1][0].data)}function qk(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&rs(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Nl(e[7][0].data),u=0,d=[],f=Nl(e[4][0].data),p=0,v=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}c.setUint16(m*2,u,!0),f.setUint16(m*2,p,!0);var w,g;switch(typeof t[m]){case"string":w=zc({t:"s",v:t[m]},r),g=Hc({t:"s",v:t[m]},r);break;case"number":w=zc({t:"n",v:t[m]},r),g=Hc({t:"n",v:t[m]},r);break;case"boolean":w=zc({t:"b",v:t[m]},r),g=Hc({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(w),u+=w.length,v.push(g),p+=g.length,++l}for(e[2][0].data=Re(l);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return e[6][0].data=In(d),e[3][0].data=In(v),l}function Jk(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=nr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(rt(n)));var s=Cl(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(I){return I.forEach(function(O){typeof O=="string"&&a.push(O)})});var o={},l=[],c=je.read(t.numbers,{type:"base64"});c.FileIndex.map(function(I,O){return[I,c.FullPaths[O]]}).forEach(function(I){var O=I[0],P=I[1];if(O.type==2&&O.name.match(/\.iwa/)){var K=O.content,ue=yr(K),fe=vr(ue);fe.forEach(function(oe){l.push(oe.id),o[oe.id]={deps:[],location:P,type:rs(oe.messages[0].meta[1][0].data)}})}}),l.sort(function(I,O){return I-O});var u=l.filter(function(I){return I>1}).map(function(I){return[I,Re(I)]});c.FileIndex.map(function(I,O){return[I,c.FullPaths[O]]}).forEach(function(I){var O=I[0];if(I[1],!!O.name.match(/\.iwa/)){var P=vr(yr(O.content));P.forEach(function(K){K.messages.forEach(function(ue){u.forEach(function(fe){K.messages.some(function(oe){return rs(oe.meta[1][0].data)!=11006&&Kk(oe.data,fe[1])})&&o[fe[0]].deps.push(K.id)})})})}});for(var d=je.find(c,o[1].location),f=vr(yr(d.content)),p,v=0;v<f.length;++v){var m=f[v];m.id==1&&(p=m)}var w=un(st(p.messages[0].data)[1][0].data);for(d=je.find(c,o[w].location),f=vr(yr(d.content)),v=0;v<f.length;++v)m=f[v],m.id==w&&(p=m);for(w=un(st(p.messages[0].data)[2][0].data),d=je.find(c,o[w].location),f=vr(yr(d.content)),v=0;v<f.length;++v)m=f[v],m.id==w&&(p=m);for(w=un(st(p.messages[0].data)[2][0].data),d=je.find(c,o[w].location),f=vr(yr(d.content)),v=0;v<f.length;++v)m=f[v],m.id==w&&(p=m);var g=st(p.messages[0].data);{g[6][0].data=Re(n.e.r+1),g[7][0].data=Re(n.e.c+1);var x=un(g[46][0].data),y=je.find(c,o[x].location),k=vr(yr(y.content));{for(var D=0;D<k.length&&k[D].id!=x;++D);if(k[D].id!=x)throw"Bad ColumnRowUIDMapArchive";var L=st(k[D].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var C=0;C<=n.e.c;++C){var b=[];b[1]=b[2]=[{type:0,data:Re(C+420690)}],L[1].push({type:2,data:pt(b)}),L[2].push({type:0,data:Re(C)}),L[3].push({type:0,data:Re(C)})}L[4]=[],L[5]=[],L[6]=[];for(var j=0;j<=n.e.r;++j)b=[],b[1]=b[2]=[{type:0,data:Re(j+726270)}],L[4].push({type:2,data:pt(b)}),L[5].push({type:0,data:Re(j)}),L[6].push({type:0,data:Re(j)});k[D].messages[0].data=pt(L)}y.content=ki(Ti(k)),y.size=y.content.length,delete g[46];var z=st(g[4][0].data);{z[7][0].data=Re(n.e.r+1);var X=st(z[1][0].data),R=un(X[2][0].data);y=je.find(c,o[R].location),k=vr(yr(y.content));{if(k[0].id!=R)throw"Bad HeaderStorageBucket";var H=st(k[0].messages[0].data);for(j=0;j<s.length;++j){var ie=st(H[2][0].data);ie[1][0].data=Re(j),ie[4][0].data=Re(s[j].length),H[2][j]={type:H[2][0].type,data:pt(ie)}}k[0].messages[0].data=pt(H)}y.content=ki(Ti(k)),y.size=y.content.length;var re=un(z[2][0].data);y=je.find(c,o[re].location),k=vr(yr(y.content));{if(k[0].id!=re)throw"Bad HeaderStorageBucket";for(H=st(k[0].messages[0].data),C=0;C<=n.e.c;++C)ie=st(H[2][0].data),ie[1][0].data=Re(C),ie[4][0].data=Re(n.e.r+1),H[2][C]={type:H[2][0].type,data:pt(ie)};k[0].messages[0].data=pt(H)}y.content=ki(Ti(k)),y.size=y.content.length;var we=un(z[4][0].data);(function(){for(var I=je.find(c,o[we].location),O=vr(yr(I.content)),P,K=0;K<O.length;++K){var ue=O[K];ue.id==we&&(P=ue)}var fe=st(P.messages[0].data);{fe[3]=[];var oe=[];a.forEach(function(Se,Ot){oe[1]=[{type:0,data:Re(Ot)}],oe[2]=[{type:0,data:Re(1)}],oe[3]=[{type:2,data:Gk(Se)}],fe[3].push({type:2,data:pt(oe)})})}P.messages[0].data=pt(fe);var ae=Ti(O),Le=ki(ae);I.content=Le,I.size=I.content.length})();var Ee=st(z[3][0].data);{var te=Ee[1][0];delete Ee[2];var se=st(te.data);{var pe=un(se[2][0].data);(function(){for(var I=je.find(c,o[pe].location),O=vr(yr(I.content)),P,K=0;K<O.length;++K){var ue=O[K];ue.id==pe&&(P=ue)}var fe=st(P.messages[0].data);{delete fe[6],delete Ee[7];var oe=new Uint8Array(fe[5][0].data);fe[5]=[];for(var ae=0,Le=0;Le<=n.e.r;++Le){var Se=st(oe);ae+=qk(Se,s[Le],a),Se[1][0].data=Re(Le),fe[5].push({data:pt(Se),type:2})}fe[1]=[{type:0,data:Re(n.e.c+1)}],fe[2]=[{type:0,data:Re(n.e.r+1)}],fe[3]=[{type:0,data:Re(ae)}],fe[4]=[{type:0,data:Re(n.e.r+1)}]}P.messages[0].data=pt(fe);var Ot=Ti(O),Ce=ki(Ot);I.content=Ce,I.size=I.content.length})()}te.data=pt(se)}z[3][0].data=pt(Ee)}g[4][0].data=pt(z)}p.messages[0].data=pt(g);var ve=Ti(f),F=ki(ve);return d.content=F,d.size=d.content.length,c}function Qk(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Ef(e){Qk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Zk(e,t){return t.bookType=="ods"?qg(e,t):t.bookType=="numbers"?Jk(e,t):t.bookType=="xlsb"?e3(e,t):t3(e,t)}function e3(e,t){Gi=1024,e&&!e.SSF&&(e.SSF=Xt(Qe)),e&&e.SSF&&(Yl(),Xl(e.SSF),t.revssf=ql(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sa?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Pg.indexOf(t.bookType)>-1,i=og();Ef(t=t||{});var s=af(),a="",o=0;if(t.cellXfs=[],Bn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",xe(s,a,fg(e.Props,t)),i.coreprops.push(a),Pe(t.rels,2,a,ke.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,xe(s,a,dg(e.Props)),i.extprops.push(a),Pe(t.rels,3,a,ke.EXT_PROPS),e.Custprops!==e.Props&&Et(e.Custprops||{}).length>0&&(a="docProps/custom.xml",xe(s,a,pg(e.Custprops)),i.custprops.push(a),Pe(t.rels,4,a,ke.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],f=(d||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,xe(s,a,nk(o-1,a,t,e,u)),i.sheets.push(a),Pe(t.wbrels,-1,"worksheets/sheet"+o+"."+r,ke.WS[0])}if(d){var p=d["!comments"],v=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,xe(s,m,ak(p,m)),i.comments.push(m),Pe(u,-1,"../comments"+o+"."+r,ke.CMNT),v=!0),d["!legacy"]&&v&&xe(s,"xl/drawings/vmlDrawing"+o+".vml",Og(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&xe(s,cg(a),es(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,xe(s,a,sk(t.Strings,a,t)),i.strs.push(a),Pe(t.wbrels,-1,"sharedStrings."+r,ke.SST)),a="xl/workbook."+r,xe(s,a,rk(e,a)),i.workbooks.push(a),Pe(t.rels,1,a,ke.WB),a="xl/theme/theme1.xml",xe(s,a,Cg(e.Themes,t)),i.themes.push(a),Pe(t.wbrels,-1,"theme/theme1.xml",ke.THEME),a="xl/styles."+r,xe(s,a,ik(e,a,t)),i.styles.push(a),Pe(t.wbrels,-1,"styles."+r,ke.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",xe(s,a,e.vbaraw),i.vba.push(a),Pe(t.wbrels,-1,"vbaProject.bin",ke.VBA)),a="xl/metadata."+r,xe(s,a,ok(a)),i.metadata.push(a),Pe(t.wbrels,-1,"metadata."+r,ke.XLMETA),xe(s,"[Content_Types].xml",lg(i,t)),xe(s,"_rels/.rels",es(t.rels)),xe(s,"xl/_rels/workbook."+r+".rels",es(t.wbrels)),delete t.revssf,delete t.ssf,s}function t3(e,t){Gi=1024,e&&!e.SSF&&(e.SSF=Xt(Qe)),e&&e.SSF&&(Yl(),Xl(e.SSF),t.revssf=ql(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sa?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Pg.indexOf(t.bookType)>-1,i=og();Ef(t=t||{});var s=af(),a="",o=0;if(t.cellXfs=[],Bn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",xe(s,a,fg(e.Props,t)),i.coreprops.push(a),Pe(t.rels,2,a,ke.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,xe(s,a,dg(e.Props)),i.extprops.push(a),Pe(t.rels,3,a,ke.EXT_PROPS),e.Custprops!==e.Props&&Et(e.Custprops||{}).length>0&&(a="docProps/custom.xml",xe(s,a,pg(e.Custprops)),i.custprops.push(a),Pe(t.rels,4,a,ke.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,xe(s,a,$g(o-1,t,e,d)),i.sheets.push(a),Pe(t.wbrels,-1,"worksheets/sheet"+o+"."+r,ke.WS[0])}if(f){var v=f["!comments"],m=!1,w="";if(v&&v.length>0){var g=!1;v.forEach(function(x){x[1].forEach(function(y){y.T==!0&&(g=!0)})}),g&&(w="xl/threadedComments/threadedComment"+o+"."+r,xe(s,w,PE(v,u,t)),i.threadedcomments.push(w),Pe(d,-1,"../threadedComments/threadedComment"+o+"."+r,ke.TCMNT)),w="xl/comments"+o+"."+r,xe(s,w,Rg(v)),i.comments.push(w),Pe(d,-1,"../comments"+o+"."+r,ke.CMNT),m=!0}f["!legacy"]&&m&&xe(s,"xl/drawings/vmlDrawing"+o+".vml",Og(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&xe(s,cg(a),es(d))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,xe(s,a,Eg(t.Strings,t)),i.strs.push(a),Pe(t.wbrels,-1,"sharedStrings."+r,ke.SST)),a="xl/workbook."+r,xe(s,a,Hg(e)),i.workbooks.push(a),Pe(t.rels,1,a,ke.WB),a="xl/theme/theme1.xml",xe(s,a,Cg(e.Themes,t)),i.themes.push(a),Pe(t.wbrels,-1,"theme/theme1.xml",ke.THEME),a="xl/styles."+r,xe(s,a,Ag(e,t)),i.styles.push(a),Pe(t.wbrels,-1,"styles."+r,ke.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",xe(s,a,e.vbaraw),i.vba.push(a),Pe(t.wbrels,-1,"vbaProject.bin",ke.VBA)),a="xl/metadata."+r,xe(s,a,Fg()),i.metadata.push(a),Pe(t.wbrels,-1,"metadata."+r,ke.XLMETA),u.length>1&&(a="xl/persons/person.xml",xe(s,a,DE(u)),i.people.push(a),Pe(t.wbrels,-1,"persons/person.xml",ke.PEOPLE)),xe(s,"[Content_Types].xml",lg(i,t)),xe(s,"_rels/.rels",es(t.rels)),xe(s,"xl/_rels/workbook."+r+".rels",es(t.wbrels)),delete t.revssf,delete t.ssf,s}function r3(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=sn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Jg(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return za(t.file,je.write(e,{type:Ne?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return je.write(e,t)}function n3(e,t){var r=Xt(t||{}),n=Zk(e,r);return i3(n,r)}function i3(e,t){var r={},n=Ne?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?je.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Kl(i))}return t.password&&typeof encrypt_agile<"u"?Jg(encrypt_agile(i,t.password),t):t.type==="file"?za(t.file,i):t.type=="string"?ta(i):i}function s3(e,t){var r=t||{},n=wk(e,r);return Jg(n,r)}function br(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Ca(Oa(n));case"binary":return Oa(n);case"string":return e;case"file":return za(t.file,n,"utf8");case"buffer":return Ne?ln(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):br(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function a3(e,t){switch(t.type){case"base64":return Ca(e);case"binary":return e;case"string":return e;case"file":return za(t.file,e,"binary");case"buffer":return Ne?ln(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function To(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Ca(r):t.type=="string"?ta(r):r;case"file":return za(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Qg(e,t){b2(),V4(e);var r=Xt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Qg(e,r);return r.type="array",Kl(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return br(yk(e,r),r);case"slk":case"sylk":return br(Ww.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return br(Kg(e.Sheets[e.SheetNames[i]],r),r);case"txt":return a3(Zg(e.Sheets[e.SheetNames[i]],r),r);case"csv":return br(Sf(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return br(zw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return To($w.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return br(Hw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return br(Jw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return br(wg.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return br(qg(e,r),r);case"wk1":return To(Fd.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return To(Fd.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),To(Gg(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),s3(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return n3(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function o3(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function l3(e,t,r){var n={};return n.type="file",n.file=t,o3(n),Qg(e,n)}function c3(e,t,r,n,i,s,a,o){var l=_t(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!a||e[r])for(var p=t.s.c;p<=t.e.c;++p){var v=a?e[r][p]:e[n[p]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[p]!=null&&(f[s[p]]=c);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[p]!=null){if(m==null)if(v.t=="e"&&m===null)f[s[p]]=null;else if(c!==void 0)f[s[p]]=c;else if(u&&m===null)f[s[p]]=null;else continue;else f[s[p]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:an(v,m,o);m!=null&&(d=!1)}}return{row:f,isempty:d}}function Cl(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=We(u);break;case"number":l=We(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var d=_t(l.s.r),f=[],p=[],v=0,m=0,w=Array.isArray(e),g=l.s.r,x=0,y={};w&&!e[g]&&(e[g]=[]);var k=c.skipHidden&&e["!cols"]||[],D=c.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(k[x]||{}).hidden)switch(f[x]=Nt(x),r=w?e[g][x]:e[f[x]+d],n){case 1:s[x]=x-l.s.c;break;case 2:s[x]=f[x];break;case 3:s[x]=c.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=an(r,null,c),m=y[a]||0,!m)y[a]=1;else{do o=a+"_"+m++;while(y[o]);y[a]=m,y[o]=1}s[x]=o}for(g=l.s.r+i;g<=l.e.r;++g)if(!(D[g]||{}).hidden){var L=c3(e,l,g,f,n,s,w,c);(L.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[v++]=L.row)}return p.length=v,p}var Ld=/"/g;function u3(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",d=_t(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var p=o.dense?(e[r]||[])[f]:e[n[f]+d];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:an(p,null,o));for(var v=0,m=0;v!==u.length;++v)if((m=u.charCodeAt(v))===i||m===s||m===34||o.forceQuotes){u='"'+u.replace(Ld,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(Ld,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function Sf(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=We(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(f[v]||{}).hidden||(d[v]=Nt(v));for(var m=0,w=i.s.r;w<=i.e.r;++w)(p[w]||{}).hidden||(u=u3(e,i,w,d,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function Zg(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Sf(e,t);return r}function f3(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=We(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Nt(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=_t(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function ex(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ft(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var d=We(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),a==-1&&(a=d.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var f=n.header||[],p=0;t.forEach(function(m,w){Et(m).forEach(function(g){(p=f.indexOf(g))==-1&&(f[p=f.length]=g);var x=m[g],y="z",k="",D=Ie({c:o+p,r:a+w+i});c=Da(s,D),x&&typeof x=="object"&&!(x instanceof Date)?s[D]=x:(typeof x=="number"?y="n":typeof x=="boolean"?y="b":typeof x=="string"?y="s":x instanceof Date?(y="d",n.cellDates||(y="n",x=Kt(x)),k=n.dateNF||Qe[14]):x===null&&n.nullError&&(y="e",x=0),c?(c.t=y,c.v=x,delete c.w,delete c.R,k&&(c.z=k)):s[D]=c={t:y,v:x},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,o+f.length-1);var v=_t(a);if(i)for(p=0;p<f.length;++p)s[Nt(p+o)+v]={t:"s",v:f[p]};return s["!ref"]=rt(u),s}function h3(e,t){return ex(null,e,t)}function Da(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ft(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Da(e,Ie(t)):Da(e,Ie({r:t,c:r||0}))}function d3(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function p3(){return{SheetNames:[],Sheets:{}}}function m3(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(zg(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function g3(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=d3(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function x3(e,t){return e.z=t,e}function tx(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function v3(e,t,r){return tx(e,"#"+t,r)}function y3(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function _3(e,t,r,n){for(var i=typeof t!="string"?t:We(t),s=typeof t=="string"?t:rt(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Da(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Hn={encode_col:Nt,encode_row:_t,encode_cell:Ie,encode_range:rt,decode_col:hf,decode_row:ff,split_cell:b_,decode_cell:ft,decode_range:nr,format_cell:an,sheet_add_aoa:tg,sheet_add_json:ex,sheet_add_dom:Xg,aoa_to_sheet:gs,json_to_sheet:h3,table_to_sheet:Yg,table_to_book:zk,sheet_to_csv:Sf,sheet_to_txt:Zg,sheet_to_json:Cl,sheet_to_html:Kg,sheet_to_formulae:f3,sheet_to_row_object_array:Cl,sheet_get_cell:Da,book_new:p3,book_append_sheet:m3,book_set_sheet_visibility:g3,cell_set_number_format:x3,cell_set_hyperlink:tx,cell_set_internal_link:v3,cell_add_comment:y3,sheet_set_array_formula:_3,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const rx=e=>{const t=Hn.book_new(),r=[["GoGo Expense Tracker - Financial Report"],[""],["Report Period:",`${e.startDate} to ${e.endDate}`],["Generated:",new Date().toLocaleDateString()],[""],["FINANCIAL SUMMARY"],["Metric","Value"],["Total Expenses",e.summary.totalExpenses],["Total Amount",e.summary.totalAmount],["Total GST",e.summary.totalGST],["Total Funding",e.summary.totalFunding],["Net Cash Flow",e.summary.netCashFlow],["Average Expense",e.summary.averageExpense],[""],["EXPENSES BY TYPE"],["Type","Amount"]];Object.entries(e.summary.expensesByType).sort(([,s],[,a])=>a-s).forEach(([s,a])=>{r.push([s,a])});const n=Hn.aoa_to_sheet(r);if(n["!cols"]=[{width:20},{width:15}],Hn.book_append_sheet(t,n,"Summary"),e.expenses.length>0){const s=["Date","Name","Type","Amount","GST Applicable","GST Amount","Recurring","Due Date","Status"],a=e.expenses.map(l=>[l.date,l.name,l.type,l.amount,l.gstApplicable?"Yes":"No",l.gstAmount||0,l.isRecurring?"Yes":"No",l.dueDate||"N/A",l.isPaid?"Paid":"Pending"]),o=Hn.aoa_to_sheet([s,...a]);o["!cols"]=[{width:12},{width:25},{width:20},{width:12},{width:12},{width:12},{width:10},{width:12},{width:10}],Hn.book_append_sheet(t,o,"Expenses")}if(e.funding.length>0){const s=["Date Received","Funder Name","Amount","Repayable","Repayment Date","Status","Description"],a=e.funding.map(l=>[l.receivedDate,l.funderName,l.amount,l.isRepayable?"Yes":"No",l.repaymentDate||"N/A",l.isPaid?"Repaid":"Pending",l.description||""]),o=Hn.aoa_to_sheet([s,...a]);o["!cols"]=[{width:15},{width:20},{width:15},{width:10},{width:15},{width:10},{width:30}],Hn.book_append_sheet(t,o,"Funding")}const i=`gogo-financial-report-${e.period}-${new Date().toISOString().split("T")[0]}.xlsx`;l3(t,i)},Md=({expenses:e,funding:t,onNavigate:r,onMarkAsPaid:n,onDismissReminder:i,onMarkFundingAsPaid:s})=>{const a=new Date().getMonth(),o=new Date().getFullYear(),l=e.filter(R=>{const H=new Date(R.date);return H.getMonth()===a&&H.getFullYear()===o}),c=l.reduce((R,H)=>R+H.amount,0),u=l.filter(R=>R.gstApplicable).reduce((R,H)=>R+(H.gstAmount||0),0),d=a===0?11:a-1,f=a===0?o-1:o,p=e.filter(R=>{const H=new Date(R.date);return H.getMonth()===d&&H.getFullYear()===f}),v=p.reduce((R,H)=>R+H.amount,0),m=v>0?(c-v)/v*100:0,w=p.filter(R=>R.gstApplicable).reduce((R,H)=>R+(H.gstAmount||0),0),g=w>0?(u-w)/w*100:0,x=e.filter(R=>R.isRecurring&&R.dueDate&&wm(R.dueDate)&&!R.isPaid),y=t.filter(R=>R.isRepayable&&R.repaymentDate&&!R.isRepaid&&Zs(R.repaymentDate)<=5&&Zs(R.repaymentDate)>=0),k=t.reduce((R,H)=>R+H.amount,0),D=t.filter(R=>R.isRepayable&&!R.isRepaid).reduce((R,H)=>R+H.amount,0),L=[...e].sort((R,H)=>new Date(H.date).getTime()-new Date(R.date).getTime()).slice(0,5),C=[...t].sort((R,H)=>new Date(H.receivedDate).getTime()-new Date(R.receivedDate).getTime()).slice(0,3),b=R=>{const{start:H,end:ie}=Wo(R),re=e.filter(F=>{const I=new Date(F.date);return I>=H&&I<=ie}),we=t.filter(F=>{const I=new Date(F.receivedDate);return I>=H&&I<=ie}),Ee=re.reduce((F,I)=>F+I.amount,0),te=re.filter(F=>F.gstApplicable).reduce((F,I)=>F+(I.gstAmount||0),0),se=we.reduce((F,I)=>F+I.amount,0),pe=re.reduce((F,I)=>(F[I.type]=(F[I.type]||0)+I.amount,F),{}),ve={title:`GoGo Financial Report - ${R.charAt(0).toUpperCase()+R.slice(1)}`,period:R,startDate:H.toISOString().split("T")[0],endDate:ie.toISOString().split("T")[0],summary:{totalExpenses:re.length,totalAmount:Ee,totalGST:te,totalFunding:se,netCashFlow:se-Ee,averageExpense:Ee/(re.length||1),expensesByType:pe},expenses:re,funding:we};rx(ve)},j=R=>{n&&n(R)},z=R=>{s&&s(R)},X=(R,H)=>{H==="expense"&&i?i(R):H==="funding"&&s&&s(R)};return h.jsxs("div",{className:"space-y-6 p-4 lg:p-6",children:[h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 lg:gap-6",children:[h.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6 border-l-4 border-[#FE4066]",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"This Month"}),h.jsx("p",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:Ae(c)}),h.jsxs("div",{className:"flex items-center mt-2",children:[m>=0?h.jsx(Vu,{className:"w-4 h-4 text-red-500 mr-1"}):h.jsx(qh,{className:"w-4 h-4 text-green-500 mr-1"}),h.jsxs("span",{className:`text-sm font-medium ${m>=0?"text-red-500":"text-green-500"}`,children:[Math.abs(m).toFixed(1),"%"]})]})]}),h.jsx("div",{className:"bg-[#FE4066] bg-opacity-10 p-2 lg:p-3 rounded-lg",children:h.jsx("div",{className:"w-5 h-5 lg:w-6 lg:h-6 text-[#FE4066] text-base lg:text-lg font-bold flex items-center justify-center",children:""})})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6 border-l-4 border-green-500",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"GST This Month"}),h.jsx("p",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:Ae(u)}),h.jsxs("div",{className:"flex items-center mt-2",children:[g>=0?h.jsx(Vu,{className:"w-4 h-4 text-red-500 mr-1"}):h.jsx(qh,{className:"w-4 h-4 text-green-500 mr-1"}),h.jsxs("span",{className:`text-sm font-medium ${g>=0?"text-red-500":"text-green-500"}`,children:[Math.abs(g).toFixed(1),"%"]})]})]}),h.jsx("div",{className:"bg-green-100 p-2 lg:p-3 rounded-lg",children:h.jsx("div",{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600 text-xs lg:text-sm font-bold flex items-center justify-center",children:"GST"})})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6 border-l-4 border-orange-500",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Bills"}),h.jsx("p",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:x.length}),h.jsx("p",{className:"text-sm text-orange-600 mt-2",children:"Needs attention"})]}),h.jsx("div",{className:"bg-orange-100 p-2 lg:p-3 rounded-lg",children:h.jsx(Qs,{className:"w-5 h-5 lg:w-6 lg:h-6 text-orange-500"})})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6 border-l-4 border-blue-500",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Funding"}),h.jsx("p",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:Ae(k)}),h.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Received"})]}),h.jsx("div",{className:"bg-blue-100 p-2 lg:p-3 rounded-lg",children:h.jsx(y2,{className:"w-5 h-5 lg:w-6 lg:h-6 text-blue-500"})})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6 border-l-4 border-purple-500",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Repayable"}),h.jsx("p",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:Ae(D)}),h.jsx("p",{className:"text-sm text-purple-600 mt-2",children:"Outstanding"})]}),h.jsx("div",{className:"bg-purple-100 p-2 lg:p-3 rounded-lg",children:h.jsx(Xh,{className:"w-5 h-5 lg:w-6 lg:h-6 text-purple-500"})})]})})]}),(x.length>0||y.length>0)&&h.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6",children:[h.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[h.jsx(Qs,{className:"w-5 h-5 text-orange-500 mr-2"}),"Alerts & Reminders"]}),h.jsxs("div",{className:"space-y-4",children:[x.map(R=>h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between bg-red-50 p-4 rounded-lg border border-red-200 space-y-3 sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[h.jsx("div",{className:"bg-red-100 p-2 rounded-lg",children:h.jsx(Aa,{className:"w-4 h-4 text-red-600"})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-red-800",children:R.name}),h.jsxs("p",{className:"text-xs sm:text-sm text-red-600",children:["Due: ",new Date(R.dueDate).toLocaleDateString(),"  ",Ae(R.amount)]})]})]}),h.jsxs("div",{className:"flex space-x-2 sm:ml-4",children:[h.jsx("button",{onClick:()=>j(R.id),className:"px-3 py-1 bg-green-600 text-white text-xs sm:text-sm rounded-lg hover:bg-green-700 transition-colors",children:"Mark Paid"}),h.jsx("button",{onClick:()=>X(R.id,"expense"),className:"px-3 py-1 bg-gray-600 text-white text-xs sm:text-sm rounded-lg hover:bg-gray-700 transition-colors",children:"Dismiss"})]})]},R.id)),y.map(R=>h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between bg-yellow-50 p-4 rounded-lg border border-yellow-200 space-y-3 sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[h.jsx("div",{className:"bg-yellow-100 p-2 rounded-lg",children:h.jsx(tf,{className:"w-4 h-4 text-yellow-600"})}),h.jsxs("div",{children:[h.jsxs("p",{className:"font-medium text-yellow-800",children:["Repayment Due: ",R.funderName]}),h.jsxs("p",{className:"text-xs sm:text-sm text-yellow-600",children:["Due: ",new Date(R.repaymentDate).toLocaleDateString(),"  ",Ae(R.amount)]})]})]}),h.jsxs("div",{className:"flex space-x-2 sm:ml-4",children:[h.jsx("button",{onClick:()=>z(R.id),className:"px-3 py-1 bg-green-600 text-white text-xs sm:text-sm rounded-lg hover:bg-green-700 transition-colors",children:"Mark Repaid"}),h.jsx("button",{onClick:()=>X(R.id,"funding"),className:"px-3 py-1 bg-gray-600 text-white text-xs sm:text-sm rounded-lg hover:bg-gray-700 transition-colors",children:"Dismiss"})]})]},R.id))]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Quick Downloads"}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Weekly Report",type:"weekly"},{label:"Monthly Report",type:"monthly"},{label:"Yearly Report",type:"yearly"},{label:"Custom Range",type:"custom"}].map(R=>h.jsxs("button",{onClick:()=>b(R.type),className:"flex flex-col sm:flex-row items-center justify-center space-y-1 sm:space-y-0 sm:space-x-2 p-3 border border-gray-200 rounded-lg hover:border-[#FE4066] hover:bg-pink-50 transition-all group",children:[h.jsx(Ua,{className:"w-4 h-4 text-gray-600 group-hover:text-[#FE4066]"}),h.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700 group-hover:text-[#FE4066] text-center",children:R.label})]},R.type))})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Recent Expenses"}),h.jsx("button",{onClick:()=>r("expenses"),className:"text-[#FE4066] hover:text-[#E11D48] text-xs sm:text-sm font-medium transition-colors",children:"View All"})]}),h.jsxs("div",{className:"space-y-3",children:[L.map(R=>h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 bg-gray-50 rounded-lg space-y-2 sm:space-y-0",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-medium text-gray-800",children:R.name}),h.jsx("p",{className:"text-sm text-gray-600",children:R.type}),h.jsx("p",{className:"text-xs text-gray-500",children:new Date(R.date).toLocaleDateString()})]}),h.jsxs("div",{className:"text-left sm:text-right",children:[h.jsx("p",{className:"font-semibold text-gray-900",children:Ae(R.amount)}),R.isRecurring&&h.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 mt-1",children:[h.jsx($o,{className:"w-3 h-3 mr-1"}),"Recurring"]})]})]},R.id)),L.length===0&&h.jsx("p",{className:"text-gray-500 text-center py-4",children:"No expenses yet"})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Recent Funding"}),h.jsx("button",{onClick:()=>r("funding"),className:"text-[#FE4066] hover:text-[#E11D48] text-xs sm:text-sm font-medium transition-colors",children:"View All"})]}),h.jsxs("div",{className:"space-y-3",children:[C.map(R=>h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 bg-gray-50 rounded-lg space-y-2 sm:space-y-0",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-medium text-gray-800",children:R.funderName}),h.jsx("p",{className:"text-sm text-gray-600",children:R.description||"Funding received"}),h.jsx("p",{className:"text-xs text-gray-500",children:new Date(R.receivedDate).toLocaleDateString()})]}),h.jsxs("div",{className:"text-left sm:text-right",children:[h.jsx("p",{className:"font-semibold text-green-600",children:Ae(R.amount)}),R.isRepayable&&h.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800 mt-1",children:[h.jsx(Xh,{className:"w-3 h-3 mr-1"}),"Repayable"]})]})]},R.id)),C.length===0&&h.jsx("p",{className:"text-gray-500 text-center py-4",children:"No funding records yet"})]})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Monthly Trends"}),h.jsx("div",{className:"space-y-4",children:Array.from({length:6},(R,H)=>{const ie=(a-5+H+12)%12,re=a-5+H<0?o-1:o,we=e.filter(I=>{const O=new Date(I.date);return O.getMonth()===ie&&O.getFullYear()===re}),Ee=we.reduce((I,O)=>I+O.amount,0),te=we.filter(I=>I.gstApplicable).reduce((I,O)=>I+(O.gstAmount||0),0),se=Math.max(...Array.from({length:6},(I,O)=>{const P=(a-5+O+12)%12,K=a-5+O<0?o-1:o;return e.filter(fe=>{const oe=new Date(fe.date);return oe.getMonth()===P&&oe.getFullYear()===K}).reduce((fe,oe)=>fe+oe.amount,0)}),1),pe=Math.max(...Array.from({length:6},(I,O)=>{const P=(a-5+O+12)%12,K=a-5+O<0?o-1:o;return e.filter(fe=>{const oe=new Date(fe.date);return oe.getMonth()===P&&oe.getFullYear()===K}).filter(fe=>fe.gstApplicable).reduce((fe,oe)=>fe+(oe.gstAmount||0),0)}),1),ve=Ee/se*100,F=te/pe*100;return h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[h.jsx("div",{className:"w-12 sm:w-16 text-xs sm:text-sm font-medium text-gray-600",children:Jh(ie).slice(0,3)}),h.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-3 relative overflow-hidden",children:h.jsx("div",{className:"bg-gradient-to-r from-[#FE4066] to-pink-500 h-full rounded-full transition-all duration-500",style:{width:`${ve}%`}})}),h.jsx("div",{className:"w-20 sm:w-24 text-xs sm:text-sm font-semibold text-gray-800 text-right",children:Ae(Ee)})]}),h.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[h.jsx("div",{className:"w-12 sm:w-16 text-xs text-gray-500",children:"GST"}),h.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 relative overflow-hidden",children:h.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 h-full rounded-full transition-all duration-500",style:{width:`${F}%`}})}),h.jsx("div",{className:"w-20 sm:w-24 text-xs text-green-600 text-right",children:Ae(te)})]})]},`${ie}-${re}`)})})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 lg:p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"GST Summary"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Total GST (Current Month)"}),h.jsx("p",{className:"text-xl lg:text-2xl font-bold text-green-600",children:Ae(u)})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"GST Applicable Expenses"}),h.jsx("p",{className:"text-xl lg:text-2xl font-bold text-blue-600",children:l.filter(R=>R.gstApplicable).length})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Average GST per Expense"}),h.jsx("p",{className:"text-xl lg:text-2xl font-bold text-purple-600",children:Ae(u/(l.filter(R=>R.gstApplicable).length||1))})]})]}),h.jsxs("div",{className:"mt-6 space-y-3",children:[h.jsx("h4",{className:"text-md font-semibold text-gray-700",children:"Monthly GST Breakdown"}),Array.from({length:6},(R,H)=>{const ie=(a-5+H+12)%12,re=a-5+H<0?o-1:o,we=e.filter(se=>{const pe=new Date(se.date);return pe.getMonth()===ie&&pe.getFullYear()===re}),Ee=we.filter(se=>se.gstApplicable).reduce((se,pe)=>se+(pe.gstAmount||0),0),te=we.filter(se=>se.gstApplicable).length;return h.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[h.jsx("div",{className:"w-12 sm:w-16 text-xs sm:text-sm font-medium text-gray-600",children:Jh(ie).slice(0,3)}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("span",{className:"text-xs sm:text-sm text-gray-600",children:[te," expenses"]}),h.jsx("span",{className:"text-xs sm:text-sm font-semibold text-green-700",children:Ae(Ee)})]})]},`gst-${ie}-${re}`)})]})]})]})},w3=[{id:"1",name:"Rent",icon:"Home"},{id:"2",name:"Operation Expense",icon:"Settings"},{id:"3",name:"Subscriptions & Due",icon:"CreditCard"},{id:"4",name:"Salary",icon:"Users"},{id:"5",name:"Utilities",icon:"Zap"},{id:"6",name:"Transportation",icon:"Car"},{id:"7",name:"Food & Dining",icon:"UtensilsCrossed"},{id:"8",name:"Entertainment",icon:"Film"},{id:"9",name:"Health & Medical",icon:"Heart"},{id:"10",name:"Shopping",icon:"ShoppingBag"},{id:"11",name:"Marketing & Advertising",icon:"Megaphone"},{id:"12",name:"Auditing",icon:"FileCheck"},{id:"13",name:"Employee Training",icon:"GraduationCap"}],E3=[{month:"Jan 2025",totalExpenses:3354,totalCount:5,avgExpense:670.8},{month:"Dec 2024",totalExpenses:17820,totalCount:3,avgExpense:5940},{month:"Nov 2024",totalExpenses:2500,totalCount:1,avgExpense:2500},{month:"Oct 2024",totalExpenses:5200,totalCount:4,avgExpense:1300},{month:"Sep 2024",totalExpenses:3800,totalCount:3,avgExpense:1266.7},{month:"Aug 2024",totalExpenses:4500,totalCount:5,avgExpense:900}],S3=e=>new Promise(t=>{const r=new FileReader;r.onload=()=>{const n={id:Date.now().toString(),name:e.name,size:e.size,type:e.type,url:r.result,uploadedAt:new Date().toISOString()};t(n)},r.readAsDataURL(e)}),nx=e=>{if(e===0)return"0 Bytes";const t=1024,r=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,n)).toFixed(2))+" "+r[n]},ix=e=>e.startsWith("image/")?"":e.includes("pdf")?"":e.includes("word")||e.includes("document")?"":e.includes("excel")||e.includes("spreadsheet")?"":e.includes("zip")||e.includes("rar")?"":"",T3=({expenses:e,onAddExpense:t,editingExpense:r,onCancelEdit:n})=>{const[i,s]=Fe.useState({date:new Date().toISOString().split("T")[0],type:"",name:"",amount:"",gstApplicable:!1,gstAmount:"",isRecurring:!1,dueDate:"",isPaid:!1,attachments:[]}),[a,o]=Fe.useState([]);Fe.useEffect(()=>{var f;r&&(s({date:r.date,type:r.type,name:r.name,amount:r.amount.toString(),gstApplicable:r.gstApplicable||!1,gstAmount:((f=r.gstAmount)==null?void 0:f.toString())||"",isRecurring:r.isRecurring,dueDate:r.dueDate||"",isPaid:r.isPaid||!1,attachments:r.attachments||[]}),o(r.attachments||[]))},[r]);const l=f=>{s(v=>({...v,name:f}));const p=e.find(v=>v.name.toLowerCase()===f.toLowerCase()&&v.isRecurring);p&&!r&&s(v=>{var m;return{...v,isRecurring:!0,dueDate:p.dueDate||"",type:p.type,gstApplicable:p.gstApplicable||!1,gstAmount:((m=p.gstAmount)==null?void 0:m.toString())||""}})},c=async f=>{const p=Array.from(f.target.files||[]);for(const v of p)try{const m=await S3(v);o(w=>[...w,m])}catch(m){console.error("Error uploading file:",m),alert("Error uploading file. Please try again.")}f.target.value=""},u=f=>{o(p=>p.filter(v=>v.id!==f))},d=f=>{if(f.preventDefault(),!i.date||!i.type||!i.name||!i.amount){alert("Please fill in all required fields");return}const p={date:i.date,type:i.type,name:i.name,amount:parseFloat(i.amount),gstApplicable:i.gstApplicable,gstAmount:i.gstApplicable&&parseFloat(i.gstAmount)||0,isRecurring:i.isRecurring,dueDate:i.isRecurring?i.dueDate:void 0,isPaid:!1,attachments:a};t(p),s({date:new Date().toISOString().split("T")[0],type:"",name:"",amount:"",gstApplicable:!1,gstAmount:"",isRecurring:!1,dueDate:"",attachments:[]}),o([]),n&&n()};return h.jsx("div",{className:"p-4 lg:p-6",children:h.jsx("div",{className:"max-w-2xl mx-auto",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-8",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-[#FE4066] to-pink-500 rounded-lg flex items-center justify-center",children:h.jsx(vm,{className:"w-6 h-6 text-white"})}),h.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:r?"Edit Expense":"Create New Expense"})]}),h.jsxs("form",{onSubmit:d,className:"space-y-6",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[h.jsx(Aa,{className:"w-4 h-4 inline mr-1"}),"Date of Expense"]}),h.jsx("input",{type:"date",value:i.date,onChange:f=>s(p=>({...p,date:f.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all",required:!0})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[h.jsx(C2,{className:"w-4 h-4 inline mr-1"}),"Type of Expense"]}),h.jsxs("select",{value:i.type,onChange:f=>s(p=>({...p,type:f.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all",required:!0,children:[h.jsx("option",{value:"",children:"Select expense type..."}),w3.map(f=>h.jsx("option",{value:f.name,children:f.name},f.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expense Name"}),h.jsx("input",{type:"text",value:i.name,onChange:f=>l(f.target.value),placeholder:"Enter expense name...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all",required:!0})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx("span",{className:"inline-block w-4 h-4 mr-1 text-center",children:""}),"Amount"]}),h.jsx("input",{type:"number",step:"0.01",value:i.amount,onChange:f=>s(p=>({...p,amount:f.target.value})),placeholder:"0.00",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all",required:!0})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"flex items-center space-x-3",children:h.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:i.gstApplicable,onChange:f=>s(p=>({...p,gstApplicable:f.target.checked,gstAmount:f.target.checked?p.gstAmount:""})),className:"w-5 h-5 text-pink-600 border-gray-300 rounded focus:ring-pink-500"}),h.jsx("span",{className:"text-sm font-medium text-gray-700",children:"GST Applicable"})]})}),i.gstApplicable&&h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx("span",{className:"inline-block w-4 h-4 mr-1 text-center",children:""}),"GST Amount"]}),h.jsx("input",{type:"number",step:"0.01",value:i.gstAmount,onChange:f=>s(p=>({...p,gstAmount:f.target.value})),placeholder:"0.00",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all"})]})]}),h.jsx("div",{className:"flex items-center space-x-3",children:h.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:i.isRecurring,onChange:f=>s(p=>({...p,isRecurring:f.target.checked})),className:"w-5 h-5 text-pink-600 border-gray-300 rounded focus:ring-pink-500"}),h.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[h.jsx(A2,{className:"w-4 h-4 inline mr-1"}),"Recurring Expense"]})]})}),i.isRecurring&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),h.jsx("input",{type:"date",value:i.dueDate,onChange:f=>s(p=>({...p,dueDate:f.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all"})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[h.jsx(dl,{className:"w-4 h-4 inline mr-1"}),"Attachments"]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"flex items-center justify-center w-full",children:h.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-24 sm:h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-pink-25 hover:border-[#FE4066] transition-all",children:[h.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[h.jsx(dl,{className:"w-6 h-6 sm:w-8 sm:h-8 mb-2 sm:mb-4 text-gray-500"}),h.jsxs("p",{className:"mb-2 text-xs sm:text-sm text-gray-500 text-center px-2",children:[h.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),h.jsx("p",{className:"text-xs text-gray-500",children:"All file formats supported"})]}),h.jsx("input",{type:"file",multiple:!0,onChange:c,className:"hidden",accept:"*/*"})]})}),a.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Uploaded Files:"}),a.map(f=>h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 bg-pink-50 rounded-lg border border-pink-200 space-y-2 sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("span",{className:"text-lg",children:ix(f.type)}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.name}),h.jsx("p",{className:"text-xs text-gray-500",children:nx(f.size)})]})]}),h.jsxs("div",{className:"flex items-center space-x-2 self-end sm:self-auto",children:[h.jsx("button",{type:"button",onClick:()=>{const p=document.createElement("a");p.href=f.url,p.download=f.name,p.click()},className:"p-1 text-gray-400 hover:text-[#FE4066] transition-colors",title:"Download attachment",children:h.jsx(Ua,{className:"w-4 h-4"})}),h.jsx("button",{type:"button",onClick:()=>u(f.id),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",title:"Remove attachment",children:h.jsx(pl,{className:"w-4 h-4"})})]})]},f.id))]})]})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4",children:[h.jsx("button",{type:"submit",className:"w-full sm:flex-1 bg-gradient-to-r from-[#FE4066] to-pink-500 text-white py-3 px-6 rounded-lg font-medium hover:from-[#E5396B] hover:to-pink-600 focus:ring-4 focus:ring-pink-200 transition-all duration-200 shadow-lg hover:shadow-xl",children:r?"Update Expense":"Create Expense"}),r&&n&&h.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})})};function k3({onAddFunding:e,onCancelEdit:t,editingFunding:r}){const[n,i]=Fe.useState({funderName:(r==null?void 0:r.funderName)||"",amount:(r==null?void 0:r.amount)||"",receivedDate:(r==null?void 0:r.receivedDate)||"",isRepayable:(r==null?void 0:r.isRepayable)||!1,repaymentDate:(r==null?void 0:r.repaymentDate)||"",description:(r==null?void 0:r.description)||""}),[s,a]=Fe.useState((r==null?void 0:r.attachments)||[]),[o,l]=Fe.useState(!1),c=Fe.useRef(null),u=g=>{const{name:x,value:y,type:k}=g.target;if(k==="checkbox"){const D=g.target.checked;i(L=>({...L,[x]:D,...x==="isRepayable"&&!D?{repaymentDate:""}:{}}))}else i(D=>({...D,[x]:y}))},d=g=>{const x=Array.from(g).map(y=>({id:Date.now()+Math.random(),name:y.name,size:y.size,type:y.type,url:URL.createObjectURL(y)}));a(y=>[...y,...x])},f=g=>{g.preventDefault(),l(!1),g.dataTransfer.files&&d(g.dataTransfer.files)},p=g=>{g.preventDefault(),l(!0)},v=g=>{g.preventDefault(),l(!1)},m=g=>{a(x=>x.filter(y=>y.id!==g))},w=g=>{if(g.preventDefault(),!n.funderName||!n.amount||!n.receivedDate){alert("Please fill in all required fields");return}if(n.isRepayable&&!n.repaymentDate){alert("Please provide a repayment date for repayable funding");return}const x={id:(r==null?void 0:r.id)||Date.now(),funderName:n.funderName,amount:parseFloat(n.amount),receivedDate:n.receivedDate,isRepayable:n.isRepayable,repaymentDate:n.repaymentDate||void 0,description:n.description,attachments:s,isRepaid:(r==null?void 0:r.isRepaid)||!1};e(x),t()};return h.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-8",children:[h.jsxs("div",{className:"flex items-center justify-between mb-8",children:[h.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:r?"Edit Funding":"Add New Funding"}),h.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 transition-colors",children:h.jsx(pl,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:w,className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx(F2,{className:"w-4 h-4 inline mr-2"}),"Funder Name *"]}),h.jsx("input",{type:"text",name:"funderName",value:n.funderName,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter funder name",required:!0})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx(w2,{className:"w-4 h-4 inline mr-2"}),"Amount () *"]}),h.jsx("input",{type:"number",name:"amount",value:n.amount,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"0.00",step:"0.01",min:"0",required:!0})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx(Aa,{className:"w-4 h-4 inline mr-2"}),"Received Date *"]}),h.jsx("input",{type:"date",name:"receivedDate",value:n.receivedDate,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),h.jsx("div",{className:"flex items-center space-x-4",children:h.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",name:"isRepayable",checked:n.isRepayable,onChange:u,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),h.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Repayable"})]})})]}),n.isRepayable&&h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx(Aa,{className:"w-4 h-4 inline mr-2"}),"Repayment Date *"]}),h.jsx("input",{type:"date",name:"repaymentDate",value:n.repaymentDate,onChange:u,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:n.isRepayable})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx($a,{className:"w-4 h-4 inline mr-2"}),"Description"]}),h.jsx("textarea",{name:"description",value:n.description,onChange:u,rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"Additional details about the funding..."})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx(dl,{className:"w-4 h-4 inline mr-2"}),"Attachments"]}),h.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDrop:f,onDragOver:p,onDragLeave:v,children:[h.jsx(dl,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),h.jsxs("p",{className:"text-gray-600 mb-2",children:["Drag and drop files here, or"," ",h.jsx("button",{type:"button",onClick:()=>{var g;return(g=c.current)==null?void 0:g.click()},className:"text-blue-600 hover:text-blue-700 font-medium",children:"browse"})]}),h.jsx("p",{className:"text-xs text-gray-500",children:"All file formats supported"}),h.jsx("input",{ref:c,type:"file",multiple:!0,onChange:g=>g.target.files&&d(g.target.files),className:"hidden",accept:"*/*"})]}),s.length>0&&h.jsxs("div",{className:"mt-4 space-y-2",children:[h.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Attached Files:"}),s.map(g=>{const x=ix(g.type);return h.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(x,{className:"w-5 h-5 text-gray-500"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-700",children:g.name}),h.jsx("p",{className:"text-xs text-gray-500",children:nx(g.size)})]})]}),h.jsx("button",{type:"button",onClick:()=>m(g.id),className:"text-red-500 hover:text-red-700 transition-colors",children:h.jsx(pl,{className:"w-4 h-4"})})]},g.id)})]})]}),h.jsxs("div",{className:"flex space-x-4 pt-6",children:[h.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:r?"Update Funding":"Add Funding"}),h.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-gray-200 text-gray-800 py-3 px-6 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancel"})]})]})]})}const A3=({expenses:e,onEditExpense:t,onDeleteExpense:r})=>{const[n,i]=Fe.useState(""),[s,a]=Fe.useState(""),[o,l]=Fe.useState("date"),c=e.filter(f=>f.name.toLowerCase().includes(n.toLowerCase())&&(s===""||f.type===s)).sort((f,p)=>{switch(o){case"date":return new Date(p.date).getTime()-new Date(f.date).getTime();case"amount":return p.amount-f.amount;case"name":return f.name.localeCompare(p.name);default:return 0}}),u=Array.from(new Set(e.map(f=>f.type))),d=f=>{window.confirm(`Are you sure you want to delete "${f.name}"? This action cannot be undone.`)&&r(f.id)};return h.jsx("div",{className:"p-4 lg:p-6 space-y-6",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:[h.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-gray-900 mb-6",children:"Expense Management"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[h.jsxs("div",{className:"relative",children:[h.jsx(ym,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),h.jsx("input",{type:"text",placeholder:"Search expenses...",value:n,onChange:f=>i(f.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all"})]}),h.jsxs("div",{className:"relative",children:[h.jsx(mm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),h.jsxs("select",{value:s,onChange:f=>a(f.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all appearance-none",children:[h.jsx("option",{value:"",children:"All Types"}),u.map(f=>h.jsx("option",{value:f,children:f},f))]})]}),h.jsxs("select",{value:o,onChange:f=>l(f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all",children:[h.jsx("option",{value:"date",children:"Sort by Date"}),h.jsx("option",{value:"amount",children:"Sort by Amount"}),h.jsx("option",{value:"name",children:"Sort by Name"})]})]}),h.jsxs("div",{className:"overflow-x-auto -mx-4 lg:mx-0",children:[h.jsxs("table",{className:"w-full min-w-[800px]",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b border-gray-200",children:[h.jsx("th",{className:"text-left py-3 px-2 lg:py-4 lg:px-4 font-semibold text-gray-700 text-sm",children:"Date"}),h.jsx("th",{className:"text-left py-3 px-2 lg:py-4 lg:px-4 font-semibold text-gray-700 text-sm",children:"Name"}),h.jsx("th",{className:"text-left py-3 px-2 lg:py-4 lg:px-4 font-semibold text-gray-700 text-sm",children:"Type"}),h.jsx("th",{className:"text-left py-3 px-2 lg:py-4 lg:px-4 font-semibold text-gray-700 text-sm",children:"Amount"}),h.jsx("th",{className:"text-left py-3 px-2 lg:py-4 lg:px-4 font-semibold text-gray-700 text-sm",children:"Status"}),h.jsx("th",{className:"text-left py-3 px-2 lg:py-4 lg:px-4 font-semibold text-gray-700 text-sm",children:"Documents"}),h.jsx("th",{className:"text-left py-3 px-2 lg:py-4 lg:px-4 font-semibold text-gray-700 text-sm",children:"Actions"})]})}),h.jsx("tbody",{children:c.map(f=>h.jsxs("tr",{className:"border-b border-gray-100 hover:bg-pink-25 transition-colors",children:[h.jsx("td",{className:"py-3 px-2 lg:py-4 lg:px-4 text-gray-900 text-sm",children:_n(f.date)}),h.jsx("td",{className:"py-3 px-2 lg:py-4 lg:px-4",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("span",{className:"font-medium text-gray-900 text-sm",children:f.name}),f.isRecurring&&h.jsx("span",{className:"bg-purple-100 text-purple-800 text-xs font-medium px-2 py-1 rounded-full",children:"Recurring"}),f.gstApplicable&&h.jsx("span",{className:"bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:"GST"})]})}),h.jsx("td",{className:"py-3 px-2 lg:py-4 lg:px-4 text-gray-600 text-sm",children:f.type}),h.jsx("td",{className:"py-3 px-2 lg:py-4 lg:px-4",children:h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-gray-900 text-sm",children:Ae(f.amount)}),f.gstApplicable&&h.jsxs("p",{className:"text-xs text-green-600",children:["GST: ",Ae(f.gstAmount||0)]})]})}),h.jsx("td",{className:"py-3 px-2 lg:py-4 lg:px-4",children:f.isRecurring?h.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f.isPaid?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:f.isPaid?"Paid":"Pending"}):h.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"One-time"})}),h.jsx("td",{className:"py-3 px-2 lg:py-4 lg:px-4",children:f.attachments&&Array.isArray(f.attachments)&&f.attachments.length>0?h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx($a,{className:"w-4 h-4 text-gray-500"}),h.jsxs("span",{className:"text-sm text-gray-600",children:[f.attachments.length," file(s)"]}),h.jsx("div",{className:"flex space-x-1",children:f.attachments.map(p=>h.jsx("button",{onClick:()=>{const v=document.createElement("a");v.href=p.url,v.download=p.name,v.click()},className:"p-1 text-gray-400 hover:text-[#FE4066] transition-colors",title:`Download ${p.name}`,children:h.jsx(Ua,{className:"w-3 h-3"})},p.id))})]}):h.jsx("span",{className:"text-sm text-gray-400",children:"No documents"})}),h.jsx("td",{className:"py-3 px-2 lg:py-4 lg:px-4",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{onClick:()=>t(f),className:"p-2 text-gray-400 hover:text-[#FE4066] hover:bg-pink-50 rounded-lg transition-all",title:"Edit expense",children:h.jsx(xm,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>d(f),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Delete expense",children:h.jsx(_m,{className:"w-4 h-4"})})]})})]},f.id))})]}),c.length===0&&h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(gm,{className:"w-8 h-8 text-gray-400"})}),h.jsx("p",{className:"text-gray-500",children:"No expenses found matching your criteria."})]})]}),h.jsx("div",{className:"mt-6 p-4 bg-pink-50 rounded-lg overflow-x-auto",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Total Expenses"}),h.jsx("p",{className:"text-lg lg:text-xl font-bold text-gray-900",children:c.length})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Total Amount"}),h.jsx("p",{className:"text-lg lg:text-xl font-bold text-gray-900",children:Ae(c.reduce((f,p)=>f+p.amount,0))})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Average"}),h.jsx("p",{className:"text-lg lg:text-xl font-bold text-gray-900",children:Ae(c.reduce((f,p)=>f+p.amount,0)/(c.length||1))})]})]})})]})})},N3=({funding:e,onEditFunding:t,onDeleteFunding:r})=>{const[n,i]=Fe.useState(""),[s,a]=Fe.useState(""),[o,l]=Fe.useState("date"),c=e.filter(f=>f.funderName.toLowerCase().includes(n.toLowerCase())&&(s===""||s==="repayable"&&f.isRepayable||s==="non-repayable"&&!f.isRepayable)).sort((f,p)=>{switch(o){case"date":return new Date(p.receivedDate).getTime()-new Date(f.receivedDate).getTime();case"amount":return p.amount-f.amount;case"funder":return f.funderName.localeCompare(p.funderName);default:return 0}}),u=f=>{window.confirm(`Are you sure you want to delete funding from "${f.funderName}"? This action cannot be undone.`)&&r(f.id)},d=f=>{const p=document.createElement("a");p.href=f.url,p.download=f.name,p.click()};return h.jsx("div",{className:"p-6 space-y-6",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Funding Management"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[h.jsxs("div",{className:"relative",children:[h.jsx(ym,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),h.jsx("input",{type:"text",placeholder:"Search funding...",value:n,onChange:f=>i(f.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all"})]}),h.jsxs("div",{className:"relative",children:[h.jsx(mm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),h.jsxs("select",{value:s,onChange:f=>a(f.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all appearance-none",children:[h.jsx("option",{value:"",children:"All Types"}),h.jsx("option",{value:"repayable",children:"Repayable"}),h.jsx("option",{value:"non-repayable",children:"Non-Repayable"})]})]}),h.jsxs("select",{value:o,onChange:f=>l(f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all",children:[h.jsx("option",{value:"date",children:"Sort by Date"}),h.jsx("option",{value:"amount",children:"Sort by Amount"}),h.jsx("option",{value:"funder",children:"Sort by Funder"})]})]}),h.jsxs("div",{className:"overflow-x-auto",children:[h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b border-gray-200",children:[h.jsx("th",{className:"text-left py-4 px-4 font-semibold text-gray-700",children:"Date"}),h.jsx("th",{className:"text-left py-4 px-4 font-semibold text-gray-700",children:"Funder"}),h.jsx("th",{className:"text-left py-4 px-4 font-semibold text-gray-700",children:"Amount"}),h.jsx("th",{className:"text-left py-4 px-4 font-semibold text-gray-700",children:"Type"}),h.jsx("th",{className:"text-left py-4 px-4 font-semibold text-gray-700",children:"Status"}),h.jsx("th",{className:"text-left py-4 px-4 font-semibold text-gray-700",children:"Documents"}),h.jsx("th",{className:"text-left py-4 px-4 font-semibold text-gray-700",children:"Actions"})]})}),h.jsx("tbody",{children:c.map(f=>h.jsxs("tr",{className:"border-b border-gray-100 hover:bg-pink-25 transition-colors",children:[h.jsx("td",{className:"py-4 px-4 text-gray-900",children:_n(f.receivedDate)}),h.jsx("td",{className:"py-4 px-4",children:h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx("span",{className:"font-medium text-gray-900",children:f.funderName})})}),h.jsx("td",{className:"py-4 px-4 font-semibold text-gray-900",children:Ae(f.amount)}),h.jsx("td",{className:"py-4 px-4",children:h.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f.isRepayable?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"}`,children:f.isRepayable?"Repayable":"Grant"})}),h.jsx("td",{className:"py-4 px-4",children:f.isRepayable?h.jsxs("div",{children:[h.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f.isPaid?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:f.isPaid?"Repaid":"Pending"}),f.repaymentDate&&h.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Due: ",_n(f.repaymentDate)]})]}):h.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"N/A"})}),h.jsx("td",{className:"py-4 px-4",children:f.attachments&&f.attachments.length>0?h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx($a,{className:"w-4 h-4 text-gray-500"}),h.jsxs("span",{className:"text-sm text-gray-600",children:[f.attachments.length," file(s)"]}),h.jsx("div",{className:"flex space-x-1",children:f.attachments.map(p=>h.jsx("button",{onClick:()=>d(p),className:"p-1 text-gray-400 hover:text-[#FE4066] transition-colors",title:`Download ${p.name}`,children:h.jsx(Ua,{className:"w-3 h-3"})},p.id))})]}):h.jsx("span",{className:"text-sm text-gray-400",children:"No documents"})}),h.jsx("td",{className:"py-4 px-4",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{onClick:()=>t(f),className:"p-2 text-gray-400 hover:text-[#FE4066] hover:bg-pink-50 rounded-lg transition-all",title:"Edit funding",children:h.jsx(xm,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>u(f),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Delete funding",children:h.jsx(_m,{className:"w-4 h-4"})})]})})]},f.id))})]}),c.length===0&&h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(gm,{className:"w-8 h-8 text-gray-400"})}),h.jsx("p",{className:"text-gray-500",children:"No funding records found matching your criteria."})]})]}),h.jsx("div",{className:"mt-6 p-4 bg-pink-50 rounded-lg",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Total Funding"}),h.jsx("p",{className:"text-xl font-bold text-gray-900",children:c.length})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Total Amount"}),h.jsx("p",{className:"text-xl font-bold text-gray-900",children:Ae(c.reduce((f,p)=>f+p.amount,0))})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Pending Repayments"}),h.jsx("p",{className:"text-xl font-bold text-gray-900",children:Ae(c.filter(f=>f.isRepayable&&!f.isPaid).reduce((f,p)=>f+p.amount,0))})]})]})})]})})},C3=({expenses:e,funding:t})=>{const[r,n]=Fe.useState({type:"monthly"}),[i,s]=Fe.useState(""),[a,o]=Fe.useState(""),c=(()=>{const{start:g,end:x}=Wo(r.type,i,a);return e.filter(y=>{const k=new Date(y.date);return k>=g&&k<=x})})(),u=c.reduce((g,x)=>g+x.amount,0),d=c.filter(g=>g.gstApplicable).reduce((g,x)=>g+(x.gstAmount||0),0),p=(()=>{const{start:g,end:x}=Wo(r.type,i,a);return t.filter(y=>{const k=new Date(y.receivedDate);return k>=g&&k<=x})})(),v=p.reduce((g,x)=>g+x.amount,0),m=c.reduce((g,x)=>(g[x.type]=(g[x.type]||0)+x.amount,g),{});c.reduce((g,x)=>{const y=new Date(x.date).toLocaleDateString("en-US",{month:"short",year:"numeric"});return g[y]=(g[y]||0)+x.amount,g},{});const w=()=>{const{start:g,end:x}=Wo(r.type,i,a),y=c.reduce((D,L)=>(D[L.type]=(D[L.type]||0)+L.amount,D),{}),k={title:`GoGo Financial Report - ${r.type.charAt(0).toUpperCase()+r.type.slice(1)}`,period:r.type,startDate:g.toISOString().split("T")[0],endDate:x.toISOString().split("T")[0],summary:{totalExpenses:c.length,totalAmount:u,totalGST:d,totalFunding:v,netCashFlow:v-u,averageExpense:u/(c.length||1),expensesByType:y},expenses:c,funding:p};rx(k)};return h.jsxs("div",{className:"p-4 lg:p-6 space-y-6",children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 space-y-4 sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-rose-500 to-pink-500 rounded-lg flex items-center justify-center",children:h.jsx($a,{className:"w-6 h-6 text-white"})}),h.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:"Financial Reports"})]}),h.jsxs("button",{onClick:w,className:"flex items-center justify-center space-x-2 bg-gradient-to-r from-[#FE4066] to-pink-500 text-white px-4 py-2 rounded-lg hover:from-[#E5396B] hover:to-pink-600 transition-all shadow-lg hover:shadow-xl w-full sm:w-auto",children:[h.jsx(Ua,{className:"w-4 h-4"}),h.jsx("span",{children:"Download Report"})]})]}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:["weekly","monthly","yearly","custom"].map(g=>h.jsxs("button",{onClick:()=>n({type:g}),className:`p-3 lg:p-4 rounded-lg border-2 transition-all capitalize ${r.type===g?"border-[#FE4066] bg-pink-50 text-[#FE4066]":"border-gray-200 hover:border-pink-300 hover:bg-pink-25"}`,children:[h.jsx(Aa,{className:"w-4 h-4 lg:w-5 lg:h-5 mx-auto mb-2"}),h.jsx("span",{className:"text-sm lg:text-base font-medium",children:g})]},g))}),r.type==="custom"&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-pink-50 rounded-lg",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),h.jsx("input",{type:"date",value:i,onChange:g=>s(g.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),h.jsx("input",{type:"date",value:a,onChange:g=>o(g.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 lg:gap-6",children:[h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Expenses"}),h.jsx("p",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:c.length})]}),h.jsx(Vu,{className:"w-6 h-6 lg:w-8 lg:h-8 text-rose-500"})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Amount"}),h.jsx("p",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:Ae(u)})]}),h.jsx("div",{className:"w-6 h-6 lg:w-8 lg:h-8 text-pink-500 text-xl lg:text-2xl font-bold flex items-center justify-center",children:""})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total GST"}),h.jsx("p",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:Ae(d)})]}),h.jsx("div",{className:"w-6 h-6 lg:w-8 lg:h-8 text-green-500 text-xs lg:text-sm font-bold flex items-center justify-center",children:"GST"})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Average Expense"}),h.jsx("p",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:Ae(u/(c.length||1))})]}),h.jsx(T2,{className:"w-6 h-6 lg:w-8 lg:h-8 text-purple-500"})]})}),h.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Funding"}),h.jsx("p",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:Ae(v)})]}),h.jsx(tf,{className:"w-6 h-6 lg:w-8 lg:h-8 text-green-500"})]})})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Funding Breakdown"}),h.jsx("div",{className:"space-y-4",children:p.map(g=>{const x=v>0?g.amount/v*100:0;return h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[h.jsx("div",{className:"w-full sm:w-32 text-sm font-medium text-gray-600 truncate",children:g.funderName}),h.jsx("div",{className:"flex-1",children:h.jsx("div",{className:"bg-green-50 rounded-full h-3 overflow-hidden",children:h.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-500 rounded-full transition-all duration-500",style:{width:`${x}%`}})})}),h.jsxs("div",{className:"flex justify-between sm:justify-end sm:space-x-4",children:[h.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ae(g.amount)}),h.jsxs("div",{className:"text-sm text-gray-500",children:[x.toFixed(1),"%"]})]})]},g.id)})})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Expense Breakdown by Type"}),h.jsx("div",{className:"space-y-4",children:Object.entries(m).sort(([,g],[,x])=>x-g).map(([g,x])=>{const y=x/u*100;return h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[h.jsx("div",{className:"w-full sm:w-24 text-sm font-medium text-gray-600 truncate",children:g}),h.jsx("div",{className:"flex-1",children:h.jsx("div",{className:"bg-pink-50 rounded-full h-3 overflow-hidden",children:h.jsx("div",{className:"h-full bg-gradient-to-r from-[#FE4066] to-pink-500 rounded-full transition-all duration-500",style:{width:`${y}%`}})})}),h.jsx("div",{className:"w-24 text-sm font-semibold text-gray-900 text-right",children:Ae(x)}),h.jsxs("div",{className:"w-16 text-sm text-gray-500 text-right",children:[y.toFixed(1),"%"]})]},g)})})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detailed Expense List"}),h.jsx("div",{className:"space-y-3",children:c.map(g=>h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-pink-50 transition-colors space-y-2 sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[h.jsx("div",{className:`w-3 h-3 rounded-full ${g.isRecurring?"bg-purple-500":"bg-gray-400"}`}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900",children:g.name}),h.jsxs("p",{className:"text-sm text-gray-600",children:[g.type,"  ",_n(g.date)]}),g.gstApplicable&&h.jsxs("p",{className:"text-xs text-green-600",children:["GST: ",Ae(g.gstAmount||0)]})]})]}),h.jsxs("div",{className:"text-left sm:text-right",children:[h.jsx("p",{className:"font-semibold text-gray-900",children:Ae(g.amount)}),g.gstApplicable&&h.jsxs("p",{className:"text-xs text-green-600",children:["+GST ",Ae(g.gstAmount||0)]}),g.isRecurring&&g.dueDate&&h.jsxs("p",{className:"text-xs text-gray-500",children:["Due: ",_n(g.dueDate)]})]})]},g.id))})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-4 lg:p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detailed Funding List"}),h.jsx("div",{className:"space-y-3",children:p.map(g=>h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-green-50 transition-colors space-y-2 sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[h.jsx("div",{className:`w-3 h-3 rounded-full ${g.isRepayable?"bg-orange-500":"bg-green-500"}`}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900",children:g.funderName}),h.jsxs("p",{className:"text-sm text-gray-600",children:[g.isRepayable?"Repayable":"Grant","  ",_n(g.receivedDate)]})]})]}),h.jsxs("div",{className:"text-left sm:text-right",children:[h.jsx("p",{className:"font-semibold text-gray-900",children:Ae(g.amount)}),g.isRepayable&&g.repaymentDate&&h.jsxs("p",{className:"text-xs text-gray-500",children:["Due: ",_n(g.repaymentDate)]})]})]},g.id))})]})]})]})},F3=({expenses:e,onMarkAsPaid:t,onDismissReminder:r})=>{const n=e.filter(l=>l.isRecurring&&l.dueDate&&!l.isPaid),i=n.filter(l=>wm(l.dueDate)),s=n.filter(l=>{const c=Zs(l.dueDate);return c>=0&&c<=7}),a=n.filter(l=>Zs(l.dueDate)>7),o=({expense:l,type:c})=>{const u=Zs(l.dueDate),d=()=>{switch(c){case"overdue":return"bg-red-50 border-red-200";case"upcoming":return"bg-yellow-50 border-yellow-200";default:return"bg-gray-50 border-gray-200"}},f=()=>{switch(c){case"overdue":return"text-red-500";case"upcoming":return"text-yellow-500";default:return"text-gray-500"}},v=(()=>{switch(c){case"overdue":return Qs;case"upcoming":return $o;default:return Us}})();return h.jsx("div",{className:`p-4 rounded-lg border ${d()} hover:shadow-md transition-all`,children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(v,{className:`w-5 h-5 ${f()}`}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900",children:l.name}),h.jsxs("p",{className:"text-sm text-gray-600",children:[c==="overdue"?`Overdue by ${Math.abs(u)} days`:c==="upcoming"?`Due in ${u} days`:`Due in ${u} days`,"  ",_n(l.dueDate)]}),h.jsx("p",{className:"text-sm font-semibold text-gray-900",children:Ae(l.amount)})]})]}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsxs("button",{onClick:()=>t(l.id),className:"flex items-center space-x-1 px-3 py-1 text-xs font-medium text-green-700 bg-green-100 rounded-md hover:bg-green-200 transition-colors",children:[h.jsx(Yh,{className:"w-3 h-3"}),h.jsx("span",{children:"Mark Paid"})]}),h.jsxs("button",{onClick:()=>r(l.id),className:"flex items-center space-x-1 px-3 py-1 text-xs font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:[h.jsx(pl,{className:"w-3 h-3"}),h.jsx("span",{children:"Dismiss"})]})]})]})})};return h.jsx("div",{className:"p-6 space-y-6",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-pink-100 p-6",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-[#FE4066] to-pink-500 rounded-lg flex items-center justify-center",children:h.jsx(Us,{className:"w-6 h-6 text-white"})}),h.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Payment Reminders"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[h.jsxs("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Qs,{className:"w-5 h-5 text-red-500"}),h.jsx("span",{className:"font-semibold text-red-700",children:"Overdue"})]}),h.jsx("p",{className:"text-2xl font-bold text-red-900 mt-2",children:i.length})]}),h.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 border border-yellow-200",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx($o,{className:"w-5 h-5 text-yellow-500"}),h.jsx("span",{className:"font-semibold text-yellow-700",children:"Due Soon"})]}),h.jsx("p",{className:"text-2xl font-bold text-yellow-900 mt-2",children:s.length})]}),h.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Us,{className:"w-5 h-5 text-gray-500"}),h.jsx("span",{className:"font-semibold text-gray-700",children:"Later"})]}),h.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:a.length})]})]}),i.length>0&&h.jsxs("div",{className:"mb-6",children:[h.jsxs("h3",{className:"text-lg font-semibold text-red-700 mb-4 flex items-center space-x-2",children:[h.jsx(Qs,{className:"w-5 h-5"}),h.jsx("span",{children:"Overdue Bills"})]}),h.jsx("div",{className:"space-y-3",children:i.map(l=>h.jsx(o,{expense:l,type:"overdue"},l.id))})]}),s.length>0&&h.jsxs("div",{className:"mb-6",children:[h.jsxs("h3",{className:"text-lg font-semibold text-yellow-700 mb-4 flex items-center space-x-2",children:[h.jsx($o,{className:"w-5 h-5"}),h.jsx("span",{children:"Due Soon (Next 7 Days)"})]}),h.jsx("div",{className:"space-y-3",children:s.map(l=>h.jsx(o,{expense:l,type:"upcoming"},l.id))})]}),a.length>0&&h.jsxs("div",{children:[h.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-4 flex items-center space-x-2",children:[h.jsx(Us,{className:"w-5 h-5"}),h.jsx("span",{children:"Upcoming Bills"})]}),h.jsx("div",{className:"space-y-3",children:a.map(l=>h.jsx(o,{expense:l,type:"later"},l.id))})]}),n.length===0&&h.jsxs("div",{className:"text-center py-12",children:[h.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(Yh,{className:"w-8 h-8 text-green-500"})}),h.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"All Caught Up!"}),h.jsx("p",{className:"text-gray-500",children:"No pending payment reminders at this time."})]})]})})},O3="modulepreload",R3=function(e){return"/"+e},Bd={},Xa=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=R3(l),l in Bd)return;Bd[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":O3,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},P3=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Xa(async()=>{const{default:n}=await Promise.resolve().then(()=>ys);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Tf extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class D3 extends Tf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Ud extends Tf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class $d extends Tf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var qu;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(qu||(qu={}));var b3=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class I3{constructor(t,{headers:r={},customFetch:n,region:i=qu.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=P3(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return b3(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const d=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:u}).catch(m=>{throw new D3(m)}),f=d.headers.get("x-relay-error");if(f&&f==="true")throw new Ud(d);if(!d.ok)throw new $d(d);let p=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return p==="application/json"?v=yield d.json():p==="application/octet-stream"?v=yield d.blob():p==="text/event-stream"?v=d:p==="multipart/form-data"?v=yield d.formData():v=yield d.text(),{data:v,error:null,response:d}}catch(i){return{data:null,error:i,response:i instanceof $d||i instanceof Ud?i.context:void 0}}})}}var $t={},kf={},tc={},Ya={},rc={},nc={},j3=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},fs=j3();const L3=fs.fetch,sx=fs.fetch.bind(fs),ax=fs.Headers,M3=fs.Request,B3=fs.Response,ys=Object.freeze(Object.defineProperty({__proto__:null,Headers:ax,Request:M3,Response:B3,default:sx,fetch:L3},Symbol.toStringTag,{value:"Module"})),U3=Hx(ys);var ic={};Object.defineProperty(ic,"__esModule",{value:!0});let $3=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};ic.default=$3;var ox=dr&&dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nc,"__esModule",{value:!0});const W3=ox(U3),z3=ox(ic);let H3=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=W3.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l,c;let u=null,d=null,f=null,p=s.status,v=s.statusText;if(s.ok){if(this.method!=="HEAD"){const x=await s.text();x===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?d=x:d=JSON.parse(x))}const w=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),g=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");w&&g&&g.length>1&&(f=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,p=406,v="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const w=await s.text();try{u=JSON.parse(w),Array.isArray(u)&&s.status===404&&(d=[],u=null,p=200,v="OK")}catch{s.status===404&&w===""?(p=204,v="No Content"):u={message:w}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,p=200,v="OK"),u&&this.shouldThrowOnError)throw new z3.default(u)}return{error:u,data:d,count:f,status:p,statusText:v}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}returns(){return this}overrideTypes(){return this}};nc.default=H3;var V3=dr&&dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rc,"__esModule",{value:!0});const G3=V3(nc);let K3=class extends G3.default{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};rc.default=K3;var X3=dr&&dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ya,"__esModule",{value:!0});const Y3=X3(rc);let q3=class extends Y3.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Ya.default=q3;var J3=dr&&dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tc,"__esModule",{value:!0});const Ds=J3(Ya);let Q3=class{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let s=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),n&&this.headers.append("Prefer",`count=${n}`),new Ds.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var i;const s="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ds.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),i&&this.headers.append("Prefer",`count=${i}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ds.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(t,{count:r}={}){var n;const i="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Ds.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Ds.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};tc.default=Q3;var lx=dr&&dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kf,"__esModule",{value:!0});const Z3=lx(tc),eA=lx(Ya);let tA=class cx{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new Z3.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new cx(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){var a;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{l.searchParams.append(d,f)})):(o="POST",c=r);const u=new Headers(this.headers);return s&&u.set("Prefer",`count=${s}`),new eA.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};kf.default=tA;var _s=dr&&dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($t,"__esModule",{value:!0});$t.PostgrestError=$t.PostgrestBuilder=$t.PostgrestTransformBuilder=$t.PostgrestFilterBuilder=$t.PostgrestQueryBuilder=$t.PostgrestClient=void 0;const ux=_s(kf);$t.PostgrestClient=ux.default;const fx=_s(tc);$t.PostgrestQueryBuilder=fx.default;const hx=_s(Ya);$t.PostgrestFilterBuilder=hx.default;const dx=_s(rc);$t.PostgrestTransformBuilder=dx.default;const px=_s(nc);$t.PostgrestBuilder=px.default;const mx=_s(ic);$t.PostgrestError=mx.default;var rA=$t.default={PostgrestClient:ux.default,PostgrestQueryBuilder:fx.default,PostgrestFilterBuilder:hx.default,PostgrestTransformBuilder:dx.default,PostgrestBuilder:px.default,PostgrestError:mx.default};const{PostgrestClient:nA,PostgrestQueryBuilder:QN,PostgrestFilterBuilder:ZN,PostgrestTransformBuilder:eC,PostgrestBuilder:tC,PostgrestError:rC}=rA;class iA{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const sA="2.15.4",aA=`realtime-js/${sA}`,oA="1.0.0",Ju=1e4,lA=1e3,cA=100;var aa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(aa||(aa={}));var it;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(it||(it={}));var Sr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Sr||(Sr={}));var Qu;(function(e){e.websocket="websocket"})(Qu||(Qu={}));var Qn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Qn||(Qn={}));class uA{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+i));a=a+i;const l=n.decode(t.slice(a,a+s));a=a+s;const c=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class gx{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Me;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Me||(Me={}));const Wd=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,a)=>(s[a]=fA(a,e,t,i),s),{})},fA=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?xx(s,a):Zu(a)},xx=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return mA(t,r)}switch(e){case Me.bool:return hA(t);case Me.float4:case Me.float8:case Me.int2:case Me.int4:case Me.int8:case Me.numeric:case Me.oid:return dA(t);case Me.json:case Me.jsonb:return pA(t);case Me.timestamp:return gA(t);case Me.abstime:case Me.date:case Me.daterange:case Me.int4range:case Me.int8range:case Me.money:case Me.reltime:case Me.text:case Me.time:case Me.timestamptz:case Me.timetz:case Me.tsrange:case Me.tstzrange:return Zu(t);default:return Zu(t)}},Zu=e=>e,hA=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},dA=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},pA=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},mA=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>xx(t,o))}return e},gA=e=>typeof e=="string"?e.replace(" ","T"):e,vx=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Vc{constructor(t,r,n={},i=Ju){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var zd;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(zd||(zd={}));class oa{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=oa.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=oa.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=oa.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const d=s[c];if(d){const f=u.map(w=>w.presence_ref),p=d.map(w=>w.presence_ref),v=u.filter(w=>p.indexOf(w.presence_ref)<0),m=d.filter(w=>f.indexOf(w.presence_ref)<0);v.length>0&&(o[c]=v),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const d=t[o].map(p=>p.presence_ref),f=u.filter(p=>d.indexOf(p.presence_ref)<0);t[o].unshift(...f)}n(o,u,l)}),this.map(a,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),t[o]=c,i(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Hd;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Hd||(Hd={}));var la;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(la||(la={}));var Gr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Gr||(Gr={}));class Af{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=it.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Vc(this,Sr.join,this.params,this.timeout),this.rejoinTimer=new gx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=it.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=it.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=it.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=it.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=it.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Sr.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new oa(this),this.broadcastEndpointURL=vx(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==it.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[la.PRESENCE]&&this.bindings[la.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,d={},f={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(Gr.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Gr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var v;if(this.socket.setAuth(),p===void 0){t==null||t(Gr.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,w=(v=m==null?void 0:m.length)!==null&&v!==void 0?v:0,g=[];for(let x=0;x<w;x++){const y=m[x],{filter:{event:k,schema:D,table:L,filter:C}}=y,b=p&&p[x];if(b&&b.event===k&&b.schema===D&&b.table===L&&b.filter===C)g.push(Object.assign(Object.assign({},y),{id:b.id}));else{this.unsubscribe(),this.state=it.errored,t==null||t(Gr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Gr.SUBSCRIBED);return}}).receive("error",p=>{this.state=it.errored,t==null||t(Gr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Gr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===it.joined&&t===la.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=it.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Sr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Vc(this,Sr.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=it.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Vc(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>cA){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Sr;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let f=this._onMessage(a,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var v,m,w;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((w=(m=p.filter)===null||m===void 0?void 0:m.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===a}).map(p=>p.callback(f,n)):(s=this.bindings[a])===null||s===void 0||s.filter(p=>{var v,m,w,g,x,y;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const k=p.id,D=(v=p.filter)===null||v===void 0?void 0:v.event;return k&&((m=r.ids)===null||m===void 0?void 0:m.includes(k))&&(D==="*"||(D==null?void 0:D.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const k=(x=(g=p==null?void 0:p.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return k==="*"||k===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:m,table:w,commit_timestamp:g,type:x,errors:y}=v;f=Object.assign(Object.assign({},{schema:m,table:w,commit_timestamp:g,eventType:x,new:{},old:{},errors:y}),this._getPayloadRecords(v))}p.callback(f,n)})}_isClosed(){return this.state===it.closed}_isJoined(){return this.state===it.joined}_isJoining(){return this.state===it.joining}_isLeaving(){return this.state===it.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Af.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Sr.close,{},t)}_onError(t){this._on(Sr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=it.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Wd(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Wd(t.columns,t.old_record)),r}}const Gc=()=>{},ko={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xA=[1e3,2e3,5e3,1e4],vA=1e4,yA=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _A{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ju,this.transport=null,this.heartbeatIntervalMs=ko.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Gc,this.ref=0,this.reconnectTimer=null,this.logger=Gc,this.conn=null,this.sendBuffer=[],this.serializer=new uA,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...a)=>Xa(async()=>{const{default:o}=await Promise.resolve().then(()=>ys);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...a)=>s(...a)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Qu.websocket}`,this.httpEndpoint=vx(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=iA.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:oA}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case aa.connecting:return Qn.Connecting;case aa.open:return Qn.Open;case aa.closing:return Qn.Closing;default:return Qn.Closed}}isConnected(){return this.connectionState()===Qn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Af(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(lA,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ko.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:s,ref:a}=r,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Sr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([yA],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:aA};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Sr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new gx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ko.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,a,o,l,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Ju,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:ko.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Gc,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:d=>xA[d-1]||vA,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(d,f)=>f(JSON.stringify(d)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Nf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function at(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class wA extends Nf{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class e0 extends Nf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var EA=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const yx=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Xa(async()=>{const{default:n}=await Promise.resolve().then(()=>ys);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},SA=()=>EA(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Xa(()=>Promise.resolve().then(()=>ys),void 0)).Response:Response}),t0=e=>{if(Array.isArray(e))return e.map(r=>t0(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=t0(n)}),t},TA=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var _i=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Kc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),kA=(e,t,r)=>_i(void 0,void 0,void 0,function*(){const n=yield SA();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{const s=e.status||500,a=(i==null?void 0:i.statusCode)||s+"";t(new wA(Kc(i),s,a))}).catch(i=>{t(new e0(Kc(i),i))}):t(new e0(Kc(e),e))}),AA=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?i:(TA(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r))};function qa(e,t,r,n,i,s){return _i(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,AA(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>kA(l,o,n))})})}function Fl(e,t,r,n){return _i(this,void 0,void 0,function*(){return qa(e,"GET",t,r,n)})}function jr(e,t,r,n,i){return _i(this,void 0,void 0,function*(){return qa(e,"POST",t,n,i,r)})}function r0(e,t,r,n,i){return _i(this,void 0,void 0,function*(){return qa(e,"PUT",t,n,i,r)})}function NA(e,t,r,n){return _i(this,void 0,void 0,function*(){return qa(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function _x(e,t,r,n,i){return _i(this,void 0,void 0,function*(){return qa(e,"DELETE",t,n,i,r)})}var Rt=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const CA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class FA{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=yx(i)}uploadOrUpdate(t,r,n,i){return Rt(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Vd),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),d=yield(t=="PUT"?r0:jr)(this.fetch,`${this.url}/object/${u}`,s,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(at(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Rt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return Rt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Vd.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield r0(this.fetch,o.toString(),l,{headers:u});return{data:{path:s,fullPath:d.Key},error:null}}catch(l){if(at(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Rt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield jr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new Nf("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(at(n))return{data:null,error:n};throw n}})}update(t,r,n){return Rt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Rt(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}copy(t,r,n){return Rt(this,void 0,void 0,function*(){try{return{data:{path:(yield jr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return Rt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield jr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return Rt(this,void 0,void 0,function*(){try{const i=yield jr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}download(t,r){return Rt(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Fl(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(at(o))return{data:null,error:o};throw o}})}info(t){return Rt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Fl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:t0(n),error:null}}catch(n){if(at(n))return{data:null,error:n};throw n}})}exists(t){return Rt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield NA(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(at(n)&&n instanceof e0){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Rt(this,void 0,void 0,function*(){try{return{data:yield _x(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}})}list(t,r,n){return Rt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},CA),r),{prefix:t||""});return{data:yield jr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(at(i))return{data:null,error:i};throw i}})}listV2(t,r){return Rt(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield jr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(at(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const OA="2.11.0",RA={"X-Client-Info":`storage-js/${OA}`};var Ai=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class PA{constructor(t,r={},n,i){const s=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},RA),r),this.fetch=yx(n)}listBuckets(){return Ai(this,void 0,void 0,function*(){try{return{data:yield Fl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(at(t))return{data:null,error:t};throw t}})}getBucket(t){return Ai(this,void 0,void 0,function*(){try{return{data:yield Fl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Ai(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(at(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ai(this,void 0,void 0,function*(){try{return{data:yield r0(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(at(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ai(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ai(this,void 0,void 0,function*(){try{return{data:yield _x(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}})}}class DA extends PA{constructor(t,r={},n,i){super(t,r,n,i)}from(t){return new FA(this.url,this.headers,t,this.fetch)}}const bA="2.57.0";let Ws="";typeof Deno<"u"?Ws="deno":typeof document<"u"?Ws="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ws="react-native":Ws="node";const IA={"X-Client-Info":`supabase-js-${Ws}/${bA}`},jA={headers:IA},LA={schema:"public"},MA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},BA={};var UA=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const $A=e=>{let t;return e?t=e:typeof fetch>"u"?t=sx:t=fetch,(...r)=>t(...r)},WA=()=>typeof Headers>"u"?ax:Headers,zA=(e,t,r)=>{const n=$A(r),i=WA();return(s,a)=>UA(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:c}))})};var HA=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function VA(e){return e.endsWith("/")?e:e+"/"}function GA(e,t){var r,n;const{db:i,auth:s,realtime:a,global:o}=e,{db:l,auth:c,realtime:u,global:d}=t,f={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>HA(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const wx="2.71.1",Pi=30*1e3,n0=3,Xc=n0*Pi,KA="http://localhost:9999",XA="supabase.auth.token",YA={"X-Client-Info":`gotrue-js/${wx}`},i0="X-Supabase-Api-Version",Ex={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},qA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,JA=10*60*1e3;class Cf extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ge(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class QA extends Cf{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function ZA(e){return ge(e)&&e.name==="AuthApiError"}class Sx extends Cf{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Un extends Cf{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class hn extends Un{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function eN(e){return ge(e)&&e.name==="AuthSessionMissingError"}class Ao extends Un{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class No extends Un{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Co extends Un{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function tN(e){return ge(e)&&e.name==="AuthImplicitGrantRedirectError"}class Gd extends Un{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class s0 extends Un{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Yc(e){return ge(e)&&e.name==="AuthRetryableFetchError"}class Kd extends Un{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class a0 extends Un{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ol="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xd=` 	
\r=`.split(""),rN=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Xd.length;t+=1)e[Xd[t].charCodeAt(0)]=-2;for(let t=0;t<Ol.length;t+=1)e[Ol[t].charCodeAt(0)]=t;return e})();function Yd(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ol[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ol[n]),t.queuedBits-=6}}function Tx(e,t,r){const n=rN[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function qd(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{sN(a,n,r)};for(let a=0;a<e.length;a+=1)Tx(e.charCodeAt(a),i,s);return t.join("")}function nN(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function iN(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}nN(n,t)}}function sN(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function aN(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Tx(e.charCodeAt(i),r,n);return new Uint8Array(t)}function oN(e){const t=[];return iN(e,r=>t.push(r)),new Uint8Array(t)}function lN(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Yd(i,r,n)),Yd(null,r,n),t.join("")}function cN(e){return Math.round(Date.now()/1e3)+e}function uN(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const _r=()=>typeof window<"u"&&typeof document<"u",Vn={tested:!1,writable:!1},kx=()=>{if(!_r())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vn.tested)return Vn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vn.tested=!0,Vn.writable=!0}catch{Vn.tested=!0,Vn.writable=!1}return Vn.writable};function fN(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Ax=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Xa(async()=>{const{default:n}=await Promise.resolve().then(()=>ys);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},hN=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Di=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Gn=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},fn=async(e,t)=>{await e.removeItem(t)};class sc{constructor(){this.promise=new sc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}sc.promiseConstructor=Promise;function qc(e){const t=e.split(".");if(t.length!==3)throw new a0("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!qA.test(t[n]))throw new a0("JWT not in base64url format");return{header:JSON.parse(qd(t[0])),payload:JSON.parse(qd(t[1])),signature:aN(t[2]),raw:{header:t[0],payload:t[1]}}}async function dN(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function pN(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function mN(e){return("0"+e.toString(16)).substr(-2)}function gN(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,mN).join("")}async function xN(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function vN(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await xN(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ni(e,t,r=!1){const n=gN();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Di(e,`${t}-code-verifier`,i);const s=await vN(n);return[s,n===s?"plain":"s256"]}const yN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _N(e){const t=e.headers.get(i0);if(!t||!t.match(yN))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function wN(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function EN(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const SN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ci(e){if(!SN.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Jc(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Jd(e){return JSON.parse(JSON.stringify(e))}var TN=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const Yn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),kN=[502,503,504];async function Qd(e){var t;if(!hN(e))throw new s0(Yn(e),0);if(kN.includes(e.status))throw new s0(Yn(e),e.status);let r;try{r=await e.json()}catch(s){throw new Sx(Yn(s),s)}let n;const i=_N(e);if(i&&i.getTime()>=Ex["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Kd(Yn(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new hn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Kd(Yn(r),e.status,r.weak_password.reasons);throw new QA(Yn(r),e.status||500,n)}const AN=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function ye(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[i0]||(s[i0]=Ex["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await NN(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function NN(e,t,r,n,i,s){const a=AN(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new s0(Yn(l),0)}if(o.ok||await Qd(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Qd(l)}}function Hr(e){var t;let r=null;RN(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=cN(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Zd(e){const t=Hr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function xn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function CN(e){return{data:e,error:null}}function FN(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=TN(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function ON(e){return e}function RN(e){return e.access_token&&e.refresh_token&&e.expires_in}const Qc=["global","local","others"];var PN=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class DN{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Ax(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Qc[0]){if(Qc.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Qc.join(", ")}`);try{return await ye(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await ye(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:xn})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=PN(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await ye(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:FN,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ge(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ye(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:xn})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await ye(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:ON});if(u.error)throw u.error;const d=await u.json(),f=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(v=>{const m=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(v.split(";")[1].split("=")[1]);c[`${w}Page`]=m}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ge(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Ci(t);try{return await ye(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:xn})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ci(t);try{return await ye(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:xn})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Ci(t);try{return await ye(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:xn})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Ci(t.userId);try{const{data:r,error:n}=await ye(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ci(t.userId),Ci(t.id);try{return{data:await ye(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}}function ep(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function bN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Fi={debug:!!(globalThis&&kx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Nx extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class IN extends Nx{}async function jN(e,t,r){Fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Fi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Fi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new IN(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Fi.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}bN();const LN={url:KA,storageKey:XA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:YA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function tp(e,t,r){return await r()}const Oi={};class ba{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ba.nextInstanceID,ba.nextInstanceID+=1,this.instanceID>0&&_r()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},LN),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new DN({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Ax(i.fetch),this.lock=i.lock||tp,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:_r()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=jN:this.lock=tp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:kx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ep(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=ep(this.memoryStorage)),_r()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Oi[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Oi[this.storageKey]=Object.assign(Object.assign({},Oi[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Oi[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Oi[this.storageKey]=Object.assign(Object.assign({},Oi[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wx}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=fN(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),_r()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),tN(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ge(r)?{error:r}:{error:new Sx("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Hr}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(ge(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:u,password:d,options:f}=t;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await Ni(this.storage,this.storageKey)),s=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:v},xform:Hr})}else if("phone"in t){const{phone:u,password:d,options:f}=t;s=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Hr})}else throw new No("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(ge(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Zd})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Zd})}else throw new No("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ao}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,i,s,a,o,l,c,u,d,f,p;let v,m;if("message"in t)v=t.message,m=t.signature;else{const{chain:w,wallet:g,statement:x,options:y}=t;let k;if(_r())if(typeof g=="object")k=g;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))k=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const D=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const L=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:D.host,uri:D.href}),x?{statement:x}:null));let C;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")C=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)C=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)v=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${D.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${D.href}`,`Issued At: ${(i=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((d=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...y.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const L=await k.signMessage(new TextEncoder().encode(v),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=L}}try{const{data:w,error:g}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:lN(m)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Hr});if(g)throw g;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new Ao}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:g})}catch(w){if(ge(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(t){const r=await Gn(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Hr});if(await fn(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Ao}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(ge(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Hr}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ao}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ni(this.storage,this.storageKey));const{error:d}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new No("You must provide either an email or phone number.")}catch(o){if(ge(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await ye(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Hr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ge(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var r,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await Ni(this.storage,this.storageKey)),await ye(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:CN})}catch(s){if(ge(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new hn;const{error:i}=await ye(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await ye(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await ye(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new No("You must provide either an email or phone number and a type")}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Gn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Xc:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await Gn(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=Jc()}if(this.storage.isServer&&t.user){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:xn}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new hn}:await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:xn})})}catch(r){if(ge(r))return eN(r)&&(await this._removeSession(),await fn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new hn;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Ni(this.storage,this.storageKey));const{data:c,error:u}=await ye(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:xn});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(ge(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new hn;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=qc(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(ge(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new hn;const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!_r())throw new Co("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Co(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Gd("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Co("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Gd("No code detected.");const{data:x,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!a||!c)throw new Co("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(o);let f=u+d;l&&(f=parseInt(l));const p=f-u;p*1e3<=Pi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const v=f-d;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,u);const{data:m,error:w}=await this._getUser(s);if(w)throw w;const g={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:f,refresh_token:a,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(n){if(ge(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Gn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(ZA(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await fn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=uN(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Ni(this.storage,this.storageKey,!0));try{return await ye(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(ge(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,u;const{data:d,error:f}=s;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ye(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return _r()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(ge(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await ye(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await pN(async i=>(i>0&&await dN(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await ye(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Hr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Yc(s)&&Date.now()+a-n<Pi})}catch(n){if(this._debug(r,"error",n),ge(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),_r()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Gn(this.storage,this.storageKey);if(i&&this.userStorage){let a=await Gn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Di(this.userStorage,this.storageKey+"-user",a)),i.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:Jc()}else if(i&&!i.user&&!i.user){const a=await Gn(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await fn(this.storage,this.storageKey+"-user"),await Di(this.storage,this.storageKey,i)):i.user=Jc()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Xc;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Xc}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),Yc(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new hn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new sc;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new hn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),ge(s)){const a={session:null,error:s};return Yc(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Di(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=Jd(i);await Di(this.storage,this.storageKey,s)}else{const i=Jd(r);await Di(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await fn(this.storage,this.storageKey),await fn(this.storage,this.storageKey+"-code-verifier"),await fn(this.storage,this.storageKey+"-user"),this.userStorage&&await fn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&_r()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Pi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Pi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Pi}ms, refresh threshold is ${n0} ticks`),i<=n0&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Nx)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_r()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await Ni(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await ye(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await ye(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(ge(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:a,error:o}=await ye(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(ge(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await ye(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ge(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:i},error:s}=t;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=qc(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+JA>i)return n;const{data:s,error:a}=await ye(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:v}=await this.getSession();if(v||!p.session)return{data:null,error:v};n=p.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=qc(n);r!=null&&r.allowExpired||wN(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:i,signature:a},error:null}}const u=EN(i.alg),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,a,oN(`${o}.${l}`)))throw new a0("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(ge(n))return{data:null,error:n};throw n}}}ba.nextInstanceID=0;const MN=ba;class BN extends MN{constructor(t){super(t)}}var UN=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class $N{constructor(t,r,n){var i,s,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=VA(t),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:LA,realtime:BA,auth:Object.assign(Object.assign({},MA),{storageKey:c}),global:jA},d=GA(n??{},u);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=zA(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new nA(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new DA(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new I3(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return UN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,storageKey:a,flowType:o,lock:l,debug:c},u,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new BN({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:s,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new _A(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const WN=(e,t,r)=>new $N(e,t,r);function zN(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}zN()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const HN="https://eojuoymapmlxaiusncou.supabase.co",VN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVvanVveW1hcG1seGFpdXNuY291Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1Njc1MTY1OCwiZXhwIjoyMDcyMzI3NjU4fQ.JB4miatwFPdlOJq9QuHSi_DHc1dzsWh_xrVpKYvRqBo",Bt=WN(HN,VN),bs={async getExpenses(){const{data:e,error:t}=await Bt.from("expenses").select(`
        *,
        expense_attachments (
          id,
          file_name,
          file_size,
          file_type,
          file_url,
          uploaded_at
        )
      `).order("created_at",{ascending:!1});if(t)throw t;return e.map(r=>({id:r.id,date:r.date,type:r.type,name:r.name,amount:r.amount,gstApplicable:r.gst_applicable,gstAmount:r.gst_amount,isRecurring:r.is_recurring,dueDate:r.due_date,isPaid:r.is_paid,createdAt:r.created_at,attachments:r.expense_attachments.map(n=>({id:n.id,name:n.file_name,size:n.file_size,type:n.file_type,url:n.file_url,uploadedAt:n.uploaded_at}))}))},async createExpense(e){const{data:t,error:r}=await Bt.from("expenses").insert({date:e.date,type:e.type,name:e.name,amount:e.amount,gst_applicable:e.gstApplicable||!1,gst_amount:e.gstAmount||0,is_recurring:e.isRecurring,due_date:e.dueDate,is_paid:!1}).select().single();if(r)throw r;if(e.attachments&&e.attachments.length>0){const n=e.attachments.map(s=>({expense_id:t.id,file_name:s.name,file_size:s.size,file_type:s.type,file_url:s.url})),{error:i}=await Bt.from("expense_attachments").insert(n);if(i)throw i}return{id:t.id,date:t.date,type:t.type,name:t.name,amount:t.amount,gstApplicable:t.gst_applicable,gstAmount:t.gst_amount,isRecurring:t.is_recurring,dueDate:t.due_date,isPaid:t.is_paid,createdAt:t.created_at,attachments:e.attachments||[]}},async updateExpense(e,t){const{data:r,error:n}=await Bt.from("expenses").update({date:t.date,type:t.type,name:t.name,amount:t.amount,gst_applicable:t.gstApplicable,gst_amount:t.gstAmount,is_recurring:t.isRecurring,due_date:t.dueDate,is_paid:t.isPaid,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return{id:r.id,date:r.date,type:r.type,name:r.name,amount:r.amount,gstApplicable:r.gst_applicable,gstAmount:r.gst_amount,isRecurring:r.is_recurring,dueDate:r.due_date,isPaid:r.is_paid,createdAt:r.created_at}},async deleteExpense(e){await Bt.from("expense_attachments").delete().eq("expense_id",e);const{error:t}=await Bt.from("expenses").delete().eq("id",e);if(t)throw t},async markAsPaid(e){const{error:t}=await Bt.from("expenses").update({is_paid:!0,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t}},Is={async getFunding(){const{data:e,error:t}=await Bt.from("funding").select(`
        *,
        funding_attachments (
          id,
          file_name,
          file_size,
          file_type,
          file_url,
          uploaded_at
        )
      `).order("created_at",{ascending:!1});if(t)throw t;return e.map(r=>({id:r.id,receivedDate:r.received_date,funderName:r.funder_name,amount:r.amount,isRepayable:r.is_repayable,repaymentDate:r.repayment_date,isPaid:r.is_paid,description:r.description,createdAt:r.created_at,attachments:r.funding_attachments.map(n=>({id:n.id,name:n.file_name,size:n.file_size,type:n.file_type,url:n.file_url,uploadedAt:n.uploaded_at}))}))},async createFunding(e){const{data:t,error:r}=await Bt.from("funding").insert({received_date:e.receivedDate,funder_name:e.funderName,amount:e.amount,is_repayable:e.isRepayable,repayment_date:e.repaymentDate,is_paid:!1,description:e.description}).select().single();if(r)throw r;if(e.attachments&&e.attachments.length>0){const n=e.attachments.map(s=>({funding_id:t.id,file_name:s.name,file_size:s.size,file_type:s.type,file_url:s.url})),{error:i}=await Bt.from("funding_attachments").insert(n);if(i)throw i}return{id:t.id,receivedDate:t.received_date,funderName:t.funder_name,amount:t.amount,isRepayable:t.is_repayable,repaymentDate:t.repayment_date,isPaid:t.is_paid,description:t.description,createdAt:t.created_at,attachments:e.attachments||[]}},async updateFunding(e,t){const{data:r,error:n}=await Bt.from("funding").update({received_date:t.receivedDate,funder_name:t.funderName,amount:t.amount,is_repayable:t.isRepayable,repayment_date:t.repaymentDate,is_paid:t.isPaid,description:t.description,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return{id:r.id,receivedDate:r.received_date,funderName:r.funder_name,amount:r.amount,isRepayable:r.is_repayable,repaymentDate:r.repayment_date,isPaid:r.is_paid,description:r.description,createdAt:r.created_at}},async deleteFunding(e){await Bt.from("funding_attachments").delete().eq("funding_id",e);const{error:t}=await Bt.from("funding").delete().eq("id",e);if(t)throw t},async markAsRepaid(e){const{error:t}=await Bt.from("funding").update({is_paid:!0,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t}};function GN(){const[e,t]=Fe.useState("dashboard"),[r,n]=Fe.useState([]),[i,s]=Fe.useState([]),[a,o]=Fe.useState(null),[l,c]=Fe.useState(null),[u,d]=Fe.useState(!0),[f,p]=Fe.useState(!1);Fe.useEffect(()=>{(async()=>{try{const[ie,re]=await Promise.all([bs.getExpenses(),Is.getFunding()]);n(ie),s(re)}catch(ie){console.error("Error loading data:",ie),alert("Error loading data from database")}finally{d(!1)}})()},[]);const v={dashboard:"Dashboard",create:"Add New Expense","create-funding":"Add New Funding",manage:"Manage Expense",funding:"Manage Funding",reports:"Reports & Analytics",reminders:"Payment Reminders"},m=async H=>{try{if(a){const ie=await bs.updateExpense(a.id,H);n(re=>re.map(we=>we.id===a.id?ie:we)),o(null)}else{const ie=await bs.createExpense(H);n(re=>[ie,...re])}t("manage")}catch(ie){console.error("Error saving expense:",ie),alert("Error saving expense to database")}},w=async H=>{try{if(l){const ie=await Is.updateFunding(l.id,H);s(re=>re.map(we=>we.id===l.id?ie:we)),c(null)}else{const ie=await Is.createFunding(H);s(re=>[ie,...re])}t("funding")}catch(ie){console.error("Error saving funding:",ie),alert("Error saving funding to database")}},g=H=>{o(H),t("create")},x=async H=>{try{await bs.deleteExpense(H),n(ie=>ie.filter(re=>re.id!==H))}catch(ie){console.error("Error deleting expense:",ie),alert("Error deleting expense from database")}},y=H=>{c(H),t("create-funding")},k=async H=>{try{await Is.deleteFunding(H),s(ie=>ie.filter(re=>re.id!==H))}catch(ie){console.error("Error deleting funding:",ie),alert("Error deleting funding from database")}},D=async H=>{try{await Is.markAsRepaid(H),s(ie=>ie.map(re=>re.id===H?{...re,isPaid:!0}:re))}catch(ie){console.error("Error marking funding as repaid:",ie),alert("Error updating funding status")}},L=async H=>{try{await bs.markAsPaid(H),n(ie=>ie.map(re=>re.id===H?{...re,isPaid:!0}:re))}catch(ie){console.error("Error marking expense as paid:",ie),alert("Error updating expense status")}},C=H=>{L(H)},b=()=>{o(null),c(null),t("manage")},j=()=>{c(null),t("funding")},z=()=>{p(!f)},X=()=>{p(!1)};if(u)return h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-25 to-rose-50 flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-16 h-16 border-4 border-[#FE4066] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),h.jsx("p",{className:"text-gray-600",children:"Loading your data..."})]})});const R=()=>{switch(e){case"dashboard":return h.jsx(Md,{expenses:r,funding:i,onNavigate:t,onMarkAsPaid:L,onDismissReminder:C,onMarkFundingAsPaid:D});case"create":return h.jsx(T3,{expenses:r,onAddExpense:m,editingExpense:a,onCancelEdit:b});case"create-funding":return h.jsx(k3,{onAddFunding:w,editingFunding:l,onCancelEdit:j});case"manage":return h.jsx(A3,{expenses:r,onEditExpense:g,onDeleteExpense:x});case"funding":return h.jsx(N3,{funding:i,onEditFunding:y,onDeleteFunding:k});case"reports":return h.jsx(C3,{expenses:r,funding:i});case"reminders":return h.jsx(F3,{expenses:r,onMarkAsPaid:L,onDismissReminder:C});default:return h.jsx(Md,{expenses:r,monthlyKPIs:E3,funding:i,onDismissReminder:C,onMarkFundingAsPaid:D})}};return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-25 to-rose-50",children:[h.jsx(O2,{currentSection:v[e],onMenuToggle:z}),h.jsxs("div",{className:"flex",children:[h.jsx(R2,{activeSection:e,onSectionChange:t,isOpen:f,onClose:X}),h.jsx("main",{className:"flex-1 overflow-hidden lg:ml-0",children:R()})]})]})}pm(document.getElementById("root")).render(h.jsx(Fe.StrictMode,{children:h.jsx(GN,{})}));
